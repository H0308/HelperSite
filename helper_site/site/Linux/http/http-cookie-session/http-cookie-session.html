<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/Linux/http/http-cookie-session/http-cookie-session.html><link rel=prev href=../http-header-request-method/http-header-request-method.html><link rel=next href=../http-version/http-version.html><link rel=icon href=../../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>HTTP中的Cookie和Session - 柯懒的知识库</title><link rel=stylesheet href=../../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../../css/timeline.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-9XWRGNRRSY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-9XWRGNRRSY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-9XWRGNRRSY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link rel=stylesheet href=../../../stylesheets/colors.min.css><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)" id=theme2-desktop><link rel=stylesheet href=../../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)" id=theme1-desktop><link rel=stylesheet href=../../../stylesheets/print.min.css><link rel=stylesheet href=../../../stylesheets/font-dongguanti.min.css id=font-dongguanti><link rel=stylesheet href=../../../stylesheets/font-oppoti.min.css id=font-oppoti disabled><link rel=stylesheet href=../../../stylesheets/font-jiangchengti.min.css id=font-jiangchengti disabled><link rel=stylesheet href=../../../stylesheets/font-lxgw.min.css id=font-lxgw disabled><link rel=stylesheet href=../../../stylesheets/code-font-dejavu-sans-mono.min.css id=code-font-dejavu-sans-mono><link rel=stylesheet href=../../../stylesheets/code-font-zsft-hk.min.css id=code-font-zsft-hk disabled><link rel=stylesheet href=../../../stylesheets/code-font-google-sans-code.min.css id=code-font-google-sans-code disabled><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css><link rel=stylesheet href=../../../stylesheets/waline.min.css><script src=../../../javascripts/start.min.js></script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#httpcookiesession class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> HTTP中的Cookie和Session </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <!-- 头像元素 - 直接在HTML中定义 --> <div class=header-avatar> <img src=../../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../../author/contact/contact.html class=avatar-dropdown-item>吵醒柯懒</a> <div class=avatar-dropdown-divider></div> <a href=../../../author/about/about.html class=avatar-dropdown-item>柯懒自传</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>柯懒的零食库</a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <!-- 独立的切换按钮 --> <div class=toolbar-toggle-btn id=toolbarToggleBtn onclick=toggleToolbar()> <div class=toggle-icon> <svg class=toggle-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=16 height=16> <path d="M346.538667 1024L170.666667 853.333333l341.333333-341.333333-341.333333-341.333333 175.872-170.666667L853.333333 512z" fill=currentColor></path> </svg> </div> </div> <!-- 右侧固定功能条 - 独立于内容区 --> <div class=floating-toolbar id=floatingToolbar> <!-- 字体切换功能 --> <div class="toolbar-item font-switcher"> <div class=toolbar-icon> <svg class=font-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M913.408 1024l-66.56 0q-29.696 0-51.2-5.12t-36.864-15.872-26.112-27.136-19.968-37.888q-15.36-38.912-28.16-70.656t-22.016-55.296q-11.264-26.624-20.48-49.152l-254.976 0q-7.168 23.552-17.408 51.2-8.192 23.552-21.504 56.832t-30.72 72.192q-20.48 46.08-47.104 63.488t-60.416 17.408l-70.656 0q-45.056 0-60.928-19.968t2.56-68.096q18.432-46.08 43.008-108.544t52.224-132.608 57.344-143.872 57.344-144.384q65.536-164.864 137.216-343.04 7.168-17.408 18.432-31.744 10.24-11.264 27.136-21.504t42.496-10.24q26.624 0 43.52 10.752t28.16 24.064q12.288 15.36 19.456 33.792 72.704 180.224 138.24 345.088 27.648 70.656 57.344 143.872t56.832 142.336 51.2 129.536 41.472 104.448q14.336 34.816 4.096 62.464t-43.008 27.648zM616.448 634.88l-97.28-347.136-1.024 0-108.544 347.136 206.848 0z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>内容字体</div> <div class=font-dropdown-toolbar> <div class=font-current-toolbar onclick=toggleFontDropdownToolbar()> <span class=current-font-name-toolbar>东观体</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=font-options-toolbar> <div class=font-option-toolbar data-font=dongguanti onclick="selectFontToolbar('dongguanti')">上图东观体 </div> <div class=font-option-toolbar data-font=oppoti onclick="selectFontToolbar('oppoti')">OPPO Sans </div> <div class=font-option-toolbar data-font=jiangchengti onclick="selectFontToolbar('jiangchengti')"> 江城黑体</div> <div class=font-option-toolbar data-font=lxgw onclick="selectFontToolbar('lxgw')">霞鹜臻楷</div> </div> </div> </div> <!-- 代码字体切换功能 --> <div class="toolbar-item code-font-switcher"> <div class=toolbar-icon> <svg t=1753672111433 class="icon code-font-icon" viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=5148 width=20 height=20> <path d="M941.709938 0H82.290062A82.290062 82.290062 0 0 0 0 82.290062v859.419876A82.290062 82.290062 0 0 0 82.290062 1022.53923h859.419876A82.290062 82.290062 0 0 0 1022.53923 941.709938V82.290062A82.290062 82.290062 0 0 0 941.709938 0zM188.439372 553.631954a40.901569 40.901569 0 0 1-29.215406-70.116975L292.154066 351.558726 159.223966 218.628626a40.901569 40.901569 0 0 1 58.430813-57.94389l160.197813 162.145507a40.901569 40.901569 0 0 1 0 57.943889l-160.197813 160.684736a40.901569 40.901569 0 0 1-29.215407 12.173086z m443.587257 0H405.120304a40.901569 40.901569 0 0 1 0-82.290061H633.000476a40.901569 40.901569 0 0 1 0 82.290061z" fill=currentColor p-id=5149></path> </svg> </div> <div class=toolbar-label>代码字体</div> <div class=code-font-dropdown-toolbar> <div class=code-font-current-toolbar onclick=toggleCodeFontDropdownToolbar()> <span class=current-code-font-name-toolbar>DejaVu Sans Mono</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=code-font-options-toolbar> <div class=code-font-option-toolbar data-code-font=dejavu onclick="selectCodeFontToolbar('dejavu')"> DejaVu Sans Mono</div> <div class=code-font-option-toolbar data-code-font=google-sans-code onclick="selectCodeFontToolbar('google-sans-code')"> Google Sans Code</div> <div class=code-font-option-toolbar data-code-font=zsft onclick="selectCodeFontToolbar('zsft')"> JetBrains Mono</div> </div> </div> </div> <!-- 主题切换功能 --> <div class="toolbar-item theme-switcher" onclick=switchTheme()> <div class=toolbar-icon> <svg class=theme-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M876.572788 522.301623c-1.886977 12.375865-9.657964 30.331819-35.880185 45.48903-56.489572 32.697703-150.21828 83.990926-174.010149 96.958262-13.143345 24.431435-66.067718 122.221646-98.141204 178.503487-16.117073 28.124548-36.055171 34.041304-50.030463 34.041304-0.031722 0-0.031722 0-0.031722 0-14.613836 0-29.1806-6.460132-43.234687-19.218714-47.183626-42.643216-125.994576-117.105115-146.013515-136.083351-27.757181-4.732791-138.338718-23.743774-200.584388-35.752272-17.924231-3.533476-32.649608-14.07046-40.372499-29.084409-5.78782-11.256368-10.281157-30.05962 1.471514-55.658647 26.989701-59.047838 74.126254-157.557432 85.957721-182.196599-3.437286-27.117614-16.996093-135.060045-23.760147-198.905142-1.886977-17.460674 3.901867-35.096333 15.829524-48.351218 12.791327-14.278191 30.667463-21.48943 49.854455-19.426445 63.669088 6.332219 173.259042 19.426445 200.584388 22.705118 24.335245-11.879562 121.085776-58.936297 180.133613-86.34146 9.91379-4.573155 19.85828-6.92369 29.596062-6.92369 28.748764 0 52.172243 20.642133 58.328453 51.421136 12.599969 62.997799 30.93864 166.70272 35.639708 193.484689 18.851347 19.682271 91.953272 96.031147 135.060045 143.07151C872.72004 487.125473 879.307062 504.71406 876.572788 522.301623L876.572788 522.301623zM825.375755 499.085876C776.017604 445.314205 687.245791 352.977193 686.365748 352.017332c-2.942005-3.069919-4.956895-6.971785-5.676279-11.208273-0.207731-1.215688-22.193465-127.001509-36.551474-198.936865-0.799202-3.917216-4.285606-16.836457-16.196891-16.836457-3.453658 0-7.30743 1.006933-11.464099 2.942005-67.282383 31.179117-183.955662 88.180342-185.170327 88.771813-3.693112 1.790786-7.850805 2.558265-11.975752 2.01489-1.295506-0.224104-133.63765-16.165168-205.988468-23.424502-0.079818 0-0.207731 0-0.287549 0-7.30743 0-11.128455 2.89391-13.319353 5.40408-3.677762 4.124947-5.644557 9.91379-5.068436 15.110139 7.674796 72.623018 24.255427 202.934922 24.463158 204.325595 0.511653 4.109598-0.159636 8.266267-1.966795 11.960403-0.591471 1.215688-57.657164 120.04712-88.339977 187.201589-3.565199 7.754614-4.41352 14.214746-2.350534 18.131963 1.935072 3.725858 6.588045 5.820566 10.360975 6.53995 70.719668 13.718443 204.644867 36.519752 206.036563 36.727483 4.189416 0.671289 8.058536 2.686179 11.112082 5.580089 1.006933 0.87902 96.414887 91.281983 150.090367 139.889027 8.314363 7.563256 13.143345 8.106632 14.437827 8.106632 3.485381 0 8.314363-4.621251 12.727882-12.391215 36.343743-63.828724 100.011808-181.988868 100.636025-183.155437 1.983167-3.64604 5.004991-6.667863 8.650007-8.650007 1.134847-0.671289 114.418936-62.373583 178.6314-99.516528 8.698103-5.036713 14.278191-10.568706 14.94948-14.854313C834.681702 511.845481 831.49922 505.800811 825.375755 499.085876L825.375755 499.085876zM935.333076 935.670256c-4.157693 4.157693-9.689686 6.299473-15.141862 6.299473-5.548366 0-11.048637-2.142803-15.238053-6.299473l-171.915441-171.915441c-8.362458-8.394181-8.362458-21.98471 0-30.426987 8.394181-8.394181 21.98471-8.394181 30.379914 0l171.915441 171.915441C943.727257 913.684522 943.727257 927.275052 935.333076 935.670256L935.333076 935.670256z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>主题切换</div> </div> <!-- 返回顶部功能 --> <div class="toolbar-item back-to-top" onclick=scrollToTop()> <div class=toolbar-icon> <svg class=back-to-top-icon viewbox="0 0 1024 1024" xmlns=http://www.w3.org/2000/svg> <path d="M882.688 624.128l-336.896-583.68c-15.872-27.136-54.784-27.136-70.656 0L138.24 624.128c-15.872 27.136 4.096 61.44 35.328 61.44H317.44c22.528 0 40.96 18.432 40.96 40.96v239.616c0 22.528 18.432 40.96 40.96 40.96h223.232c22.528 0 40.96-18.432 40.96-40.96v-239.616c0-22.528 18.432-40.96 40.96-40.96h143.872c30.208 0 50.176-34.304 34.304-61.44z"> </path> </svg> </div> <div class=toolbar-label>返回顶部</div> </div> </div> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../../intro/intro.html class=md-tabs__link> 网站介绍 </a> </li> <li class=md-tabs__item> <a href=../../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../../languages/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../../data-structure-algo/index.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../index.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../front-end/index.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../../MySQL/index.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../../JavaEE/index.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../../other/index.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../../tooltips/index.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../../projects/index.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../../intro/intro.html class=md-nav__link> <span class=md-ellipsis> 网站介绍 </span> </a> </li> <li class=md-nav__item> <a href=../../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../languages/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data-structure-algo/index.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> Linux </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../options-commands/options-commands.html class=md-nav__link> <span class=md-ellipsis> Linux常用选项和指令 </span> </a> </li> <li class=md-nav__item> <a href=../../permission/permission.html class=md-nav__link> <span class=md-ellipsis> Linux权限相关 </span> </a> </li> <li class=md-nav__item> <a href=../../software-installation/software-installation.html class=md-nav__link> <span class=md-ellipsis> CentOS软件安装 </span> </a> </li> <li class=md-nav__item> <a href=../../gcc-gdb/gcc-gdb.html class=md-nav__link> <span class=md-ellipsis> Linux下的gcc与gdb </span> </a> </li> <li class=md-nav__item> <a href=../../makefile-progress-bar/makefile-progress-bar.html class=md-nav__link> <span class=md-ellipsis> Linux下的Makefile与进度条程序 </span> </a> </li> <li class=md-nav__item> <a href=../../os-basic/os-basic.html class=md-nav__link> <span class=md-ellipsis> 操作系统基础知识 </span> </a> </li> <li class=md-nav__item> <a href=../../process-basic/process-basic.html class=md-nav__link> <span class=md-ellipsis> Linux进程基础 </span> </a> </li> <li class=md-nav__item> <a href=../../process-state-priority/process-state-priority.html class=md-nav__link> <span class=md-ellipsis> Linux进程状态与进程优先级 </span> </a> </li> <li class=md-nav__item> <a href=../../process-switch-scheduling/process-switch-scheduling.html class=md-nav__link> <span class=md-ellipsis> Linux进程切换以及调度算法 </span> </a> </li> <li class=md-nav__item> <a href=../../command-line-env/command-line-env.html class=md-nav__link> <span class=md-ellipsis> Linux命令行与环境变量 </span> </a> </li> <li class=md-nav__item> <a href=../../process-address-space/process-address-space.html class=md-nav__link> <span class=md-ellipsis> Linux进程地址空间 </span> </a> </li> <li class=md-nav__item> <a href=../../process-control/process-control.html class=md-nav__link> <span class=md-ellipsis> Linux进程控制 </span> </a> </li> <li class=md-nav__item> <a href=../../linux-fileop/linux-fileop.html class=md-nav__link> <span class=md-ellipsis> Linux文件操作基础 </span> </a> </li> <li class=md-nav__item> <a href=../../io-process/io-process.html class=md-nav__link> <span class=md-ellipsis> Linux中输入和输出基本过程 </span> </a> </li> <li class=md-nav__item> <a href=../../file-system/file-system.html class=md-nav__link> <span class=md-ellipsis> Linux文件系统 </span> </a> </li> <li class=md-nav__item> <a href=../../soft-hard-link/soft-hard-link.html class=md-nav__link> <span class=md-ellipsis> Linux软链接和硬链接 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../com-process/com-anonymous-pipe/com-anonymous-pipe.html class=md-nav__link> <span class=md-ellipsis> Linux进程间通信 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../signals-os-principles/signals-os-principles.html class=md-nav__link> <span class=md-ellipsis> Linux信号与操作系统原理 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../linux-thread/thread-concept-op/thread-concept-op.html class=md-nav__link> <span class=md-ellipsis> Linux线程 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../net-basic/net-basic.html class=md-nav__link> <span class=md-ellipsis> 网络基础知识 </span> </a> </li> <li class=md-nav__item> <a href=../../socket-basic/socket-basic.html class=md-nav__link> <span class=md-ellipsis> Socket编程基础 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../udp/udp-basic/udp-basic.html class=md-nav__link> <span class=md-ellipsis> UDP编程 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../../tcp-basic/tcp-basic.html class=md-nav__link> <span class=md-ellipsis> TCP编程接口基本使用 </span> </a> </li> <li class=md-nav__item> <a href=../../serialization-net-cal/serialization-net-cal.html class=md-nav__link> <span class=md-ellipsis> 序列化和反序列化与网络计算器 </span> </a> </li> <li class=md-nav__item> <a href=../../process-relationship-daemon/process-relationship-daemon.html class=md-nav__link> <span class=md-ellipsis> 进程间关系和守护进程 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_27 checked> <label class=md-nav__link for=__nav_6_27 id=__nav_6_27_label tabindex=0> <span class=md-ellipsis> 应用层协议HTTP </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_27_label aria-expanded=true> <label class=md-nav__title for=__nav_6_27> <span class="md-nav__icon md-icon"></span> 应用层协议HTTP </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../http-basic-httpserver/http-basic-httpserver.html class=md-nav__link> <span class=md-ellipsis> 介绍HTTP协议基本结构与基本实现HTTPServer </span> </a> </li> <li class=md-nav__item> <a href=../http-serialization/http-serialization.html class=md-nav__link> <span class=md-ellipsis> 深入HTTP序列化和反序列化 </span> </a> </li> <li class=md-nav__item> <a href=../http-header-request-method/http-header-request-method.html class=md-nav__link> <span class=md-ellipsis> HTTP报头属性和请求方式 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> HTTP中的Cookie和Session </span> <span class="md-nav__icon md-icon"></span> </label> <a href=http-cookie-session.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> HTTP中的Cookie和Session </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 本篇介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 什么是无连接和无状态 </span> </a> </li> <li class=md-nav__item> <a href=#httpcookie class=md-nav__link> <span class=md-ellipsis> HTTP中的Cookie </span> </a> <nav class=md-nav aria-label=HTTP中的Cookie> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 基本介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 工作原理 </span> </a> </li> <li class=md-nav__item> <a href=#cookie class=md-nav__link> <span class=md-ellipsis> Cookie的分类 </span> </a> </li> <li class=md-nav__item> <a href=#httpservercookie class=md-nav__link> <span class=md-ellipsis> 在HttpServer中实现Cookie功能 </span> </a> <nav class=md-nav aria-label=在HttpServer中实现Cookie功能> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 前置知识 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 简单形式 </span> </a> <nav class=md-nav aria-label=简单形式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cookie_1 class=md-nav__link> <span class=md-ellipsis> 写入Cookie </span> </a> </li> <li class=md-nav__item> <a href=#cookie_2 class=md-nav__link> <span class=md-ellipsis> 读取Cookie </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 完整形式 </span> </a> <nav class=md-nav aria-label=完整形式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 介绍 </span> </a> </li> <li class=md-nav__item> <a href=#expires class=md-nav__link> <span class=md-ellipsis> 实现expires </span> </a> </li> <li class=md-nav__item> <a href=#path class=md-nav__link> <span class=md-ellipsis> 实现path </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cookie_3 class=md-nav__link> <span class=md-ellipsis> Cookie的安全性 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#httpsession class=md-nav__link> <span class=md-ellipsis> HTTP中的Session </span> </a> <nav class=md-nav aria-label=HTTP中的Session> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 基本介绍 </span> </a> </li> <li class=md-nav__item> <a href=#httpserversession class=md-nav__link> <span class=md-ellipsis> 在HttpServer中实现Session </span> </a> </li> <li class=md-nav__item> <a href=#session class=md-nav__link> <span class=md-ellipsis> Session的安全性 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../http-version/http-version.html class=md-nav__link> <span class=md-ellipsis> HTTP版本介绍 </span> </a> </li> <li class=md-nav__item> <a href=../https/https.html class=md-nav__link> <span class=md-ellipsis> HTTPS协议介绍与原理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../udp-principles/udp-principles.html class=md-nav__link> <span class=md-ellipsis> UDP协议原理 </span> </a> </li> <li class=md-nav__item> <a href=../../tcp-principles/tcp-principles.html class=md-nav__link> <span class=md-ellipsis> TCP协议原理 </span> </a> </li> <li class=md-nav__item> <a href=../../tcp-connection-backlog/tcp-connection-backlog.html class=md-nav__link> <span class=md-ellipsis> 理解Linux如何看待连接以及TCP全连接队列 </span> </a> </li> <li class=md-nav__item> <a href=../../ip/ip.html class=md-nav__link> <span class=md-ellipsis> 网络层IP协议 </span> </a> </li> <li class=md-nav__item> <a href=../../datalink/datalink.html class=md-nav__link> <span class=md-ellipsis> 数据链路层协议 </span> </a> </li> <li class=md-nav__item> <a href=../../dns-icmp/dns-icmp.html class=md-nav__link> <span class=md-ellipsis> DNS与ICMP </span> </a> </li> <li class=md-nav__item> <a href=../../nat-proxy/nat-proxy.html class=md-nav__link> <span class=md-ellipsis> NAT技术、代理服务器和内网穿透 </span> </a> </li> <li class=md-nav__item> <a href=../../io-model-select-poll/io-model-select-poll.html class=md-nav__link> <span class=md-ellipsis> 五种IO模型与select和poll分别实现多路转接 </span> </a> </li> <li class=md-nav__item> <a href=../../epoll/epoll.html class=md-nav__link> <span class=md-ellipsis> epoll实现多路转接 </span> </a> </li> <li class=md-nav__item> <a href=../../reactor-et/reactor-et.html class=md-nav__link> <span class=md-ellipsis> Reactor模式与完善基于边缘触发模式epoll实现TCP服务器 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../front-end/index.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../MySQL/index.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../JavaEE/index.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../other/index.html class=md-nav__link> <span class=md-ellipsis> 扩展知识 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../tooltips/index.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../projects/index.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 本篇介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 什么是无连接和无状态 </span> </a> </li> <li class=md-nav__item> <a href=#httpcookie class=md-nav__link> <span class=md-ellipsis> HTTP中的Cookie </span> </a> <nav class=md-nav aria-label=HTTP中的Cookie> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 基本介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 工作原理 </span> </a> </li> <li class=md-nav__item> <a href=#cookie class=md-nav__link> <span class=md-ellipsis> Cookie的分类 </span> </a> </li> <li class=md-nav__item> <a href=#httpservercookie class=md-nav__link> <span class=md-ellipsis> 在HttpServer中实现Cookie功能 </span> </a> <nav class=md-nav aria-label=在HttpServer中实现Cookie功能> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 前置知识 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 简单形式 </span> </a> <nav class=md-nav aria-label=简单形式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cookie_1 class=md-nav__link> <span class=md-ellipsis> 写入Cookie </span> </a> </li> <li class=md-nav__item> <a href=#cookie_2 class=md-nav__link> <span class=md-ellipsis> 读取Cookie </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 完整形式 </span> </a> <nav class=md-nav aria-label=完整形式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 介绍 </span> </a> </li> <li class=md-nav__item> <a href=#expires class=md-nav__link> <span class=md-ellipsis> 实现expires </span> </a> </li> <li class=md-nav__item> <a href=#path class=md-nav__link> <span class=md-ellipsis> 实现path </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#cookie_3 class=md-nav__link> <span class=md-ellipsis> Cookie的安全性 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#httpsession class=md-nav__link> <span class=md-ellipsis> HTTP中的Session </span> </a> <nav class=md-nav aria-label=HTTP中的Session> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 基本介绍 </span> </a> </li> <li class=md-nav__item> <a href=#httpserversession class=md-nav__link> <span class=md-ellipsis> 在HttpServer中实现Session </span> </a> </li> <li class=md-nav__item> <a href=#session class=md-nav__link> <span class=md-ellipsis> Session的安全性 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=httpcookiesession>HTTP中的Cookie和Session<a class=headerlink href=#httpcookiesession title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 4200 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 317 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 10 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 18 分钟</p> </div> <h2 id=_1>本篇介绍<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>前面几篇已经基本介绍了HTTP协议的大部分内容，但是前面提到了一点「HTTP是无连接、无状态的协议」，那么到底有什么无连接以及什么是无状态。基于这两个问题，随后解释什么是Cookie和Session，以及二者是如何通过代码实现的</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>本篇的代码部分都是基于上一节的<code>HttpServer</code></p> </div> <h2 id=_2>什么是无连接和无状态<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>HTTP最大的特点就是无连接和无状态</p> <p>所谓的无连接指的是HTTP请求服务器时不需要HTTP协议自己与服务器建立连接，由于HTTP是基于TCP的，所以整个连接工作交给了TCP，这一点在前面实现<code>HttpServer</code>时也有所体现</p> <p>所谓的无状态指的是HTTP本身不会保存任何用户信息，举个例子，如果当前网站需要用户登录以进行后续操作，那么默认情况下，一旦这个用户登录成功后切换到其他页面就依旧会出现需要登录的情况</p> <h2 id=httpcookie>HTTP中的Cookie<a class=headerlink href=#httpcookie title="Permanent link">&para;</a></h2> <h3 id=_3>基本介绍<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>既然HTTP是无状态的，那么正常情况下就会出现下面的情况：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320161039421.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320161039421.png"></a></p> <p>上面图中这种情况的发送就会给用户带来糟糕的交互体验，也会给服务器带来比较大的开销，所以为了解决这个问题，就需要使用Cookie，但是因为HTTP本身是无连接的，所以Cookie本身并不是一种让HTTP从无连接变成有连接的技术，而是利用HTTP请求会携带报头的特点从而让HTTP每次请求时自动携带着Cookie</p> <p>基于上面的情景，Cookie实际上实现的功能常见的就是保持用户的状态、记录用户偏好等</p> <h3 id=_4>工作原理<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <p>Cookie工作方式与正常写入和读取HTTP请求报头属性比较类似：</p> <ol> <li>当用户第一次访问网站时，服务器会在响应的HTTP头中设置<code>Set-Cookie</code>字段，用于发送<code>Cookie</code>到用户的浏览器</li> <li>浏览器在接收到Cookie后，会将其保存在本地（通常是按照域名进行存储）在之后的请求中，浏览器会自动在HTTP请求头中携带Cookie字段，将之前保存的Cookie信息发送给服务器</li> <li>在之后的请求中，浏览器会自动在HTTP请求头中携带Cookie字段，将之前保存的Cookie信息发送给服务器</li> </ol> <h3 id=cookie>Cookie的分类<a class=headerlink href=#cookie title="Permanent link">&para;</a></h3> <p>Cookie一般情况下分为两种：</p> <ol> <li>会话Cookie（Session Cookie）：在浏览器关闭时失效</li> <li>持久Cookie（Persistent Cookie）：带有明确的过期日期或持续时间，可以跨多个浏览器会话存在</li> </ol> <p>如果Cookie是一个持久性的，那么它其实就是浏览器特定目录下的一个文件。但直接查看这些文件可能会看到乱码或无法读取的内容，因为Cookie文件通常以二进制或sqlite格式存储。所以一般想查看Cookie都只能通过浏览器提供的入口进行查看</p> <h3 id=httpservercookie>在<code>HttpServer</code>中实现Cookie功能<a class=headerlink href=#httpservercookie title="Permanent link">&para;</a></h3> <h4 id=_5>前置知识<a class=headerlink href=#_5 title="Permanent link">&para;</a></h4> <p>要想在<code>HttpServer</code>中实现给客户端添加Cookie的功能就需要用到一个响应报头属性：<code>Set-Cookie</code>，其值基本形式如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1>Set-Cookie: Cookie-name=Cookie-value
</span></code></pre></div></td></tr></table></div> <p>其中，<code>Cookie-name</code>代表的就是需要写入的Cookie的名称，<code>Cookie-value</code>对应的就是Cookie的值</p> <p>除了上面的基本形式外，Cookie还有一种完整形式：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1>Set-Cookie: Cookie-name=Cookie-value; expires=Week, Day Month Year Hour:Minutes:Seconds UTC/GMT; path=Request-path; domain=domain-name; secure; Httponly
</span></code></pre></div></td></tr></table></div> <p>在上面的完整形式中，每一个字段的含义如下：</p> <table> <thead> <tr> <th>字段</th> <th>含义</th> </tr> </thead> <tbody> <tr> <td><code>Cookie-name=Cookie-value</code></td> <td>Cookie的名称和对应的值，是<code>Set-Cookie</code>中唯一必需的部分</td> </tr> <tr> <td><code>expires</code></td> <td>指定Cookie的过期时间，格式为标准HTTP日期格式。如果不设置，则为会话Cookie（浏览器关闭即失效），例如<code>expires=Wed, 21 Oct 2025 07:28:00 GMT</code></td> </tr> <tr> <td><code>path</code></td> <td>指定Cookie生效的路径范围。例如：<code>path=/admin/</code>表示Cookie只在访问<code>/admin/</code>及其子路径时有效，默认为当前文档路径</td> </tr> <tr> <td><code>domain</code></td> <td>指定Cookie生效的域名范围。例如：<code>domain=example.com</code>允许Cookie在该域名及其子域名下有效，默认为当前域名（不含子域名）</td> </tr> <tr> <td><code>secure</code></td> <td>标记Cookie只能通过HTTPS安全连接传输，无值，存在即生效</td> </tr> <tr> <td><code>HttpOnly</code></td> <td>禁止JavaScript通过<code>document.cookie</code>访问此Cookie，防止XSS攻击窃取Cookie，无值，存在即生效</td> </tr> </tbody> </table> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意的是，如果需要给客户端发送多个Cookie，则不可以直接在同一个Cookie后方拼接，而是需要另起一个<code>Set-Cookie</code>属性</p> </div> <p>因为Cookie有简单形式和完整形式两种，所以下面先演示简单形式，再扩展到完整形式，但是完整形式中不会演示所有属性，而是针对<code>expires</code>和<code>path</code>这两个属性进行解释</p> <h4 id=_6>简单形式<a class=headerlink href=#_6 title="Permanent link">&para;</a></h4> <h5 id=cookie_1>写入Cookie<a class=headerlink href=#cookie_1 title="Permanent link">&para;</a></h5> <p>根据Cookie的工作原理第一条，首先需要在客户端第一次请求服务端时向客户端写入一条Cookie值，所以需要在响应报头中添加一条<code>Set-Cookie</code>属性，因为在上一节已经实现了一个登录函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-2-2><span class=p>{</span>
</span><span id=__span-2-3><span class=w>    </span><span class=n>LOG</span><span class=p>(</span><span class=n>LogLevel</span><span class=o>::</span><span class=n>INFO</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;进入登录模块&quot;</span><span class=p>;</span>
</span><span id=__span-2-4><span class=w>    </span><span class=n>req</span><span class=p>.</span><span class=n>getParamKv</span><span class=p>();</span>
</span><span id=__span-2-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>所以本次考虑将添加<code>Set-Cookie</code>属性放到当前函数中，方式很简单，只需要调用<code>HttpResponse</code>类中的<code>insertRespHead</code>函数即可：</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>本次为了方便就不处理是否是第一次添加或者之前添加的Cookie是否存在</p> </div> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-3-2><span class=p>{</span><span class=w>   </span>
</span><span id=__span-3-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-3-4>
</span><span id=__span-3-5><span class=w>    </span><span class=c1>// 添加Cookie</span>
</span><span id=__span-3-6><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespHead</span><span class=p>(</span><span class=s>&quot;Set-Cookie&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;testCookie=newCookie&quot;</span><span class=p>);</span>
</span><span id=__span-3-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>添加完Cookie之后就需要向响应报头中写入这一条属性，所谓的写入就是进行序列化，所以接下来需要调用<code>HttpResponse</code>类中的<code>serialize</code>方法以及发送对应的响应报头给客户端，但是这一步实际上已经在处理HTTP请求函数<code>handleHttpRequest</code>做过了，所以就不需要再重复做了</p> <p>完成上面的步骤后，接下来进行测试，需要注意，要让服务器执行<code>login</code>函数就必须请求<code>/login</code>方法，可以考虑直接在浏览器地址栏中请求<code>/login</code>并携带部分参数，此时使用的就是<code>GET</code>请求方式，也可以考虑走完整的步骤，先请求主页，再请求登录页面，通过登录请求<code>/login</code>资源。本次选择前者，但是为了能够看到具体的效果，需要考虑给响应体写入一点内容，确保浏览器可以停止在该页面，所以还需要调用一个设置响应行和响应体的方法，这里在<code>HttpResponse</code>中提供一个<code>setRespLine</code>和<code>setRespBody</code>方法：</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>设置响应行</label><label for=__tabbed_1_2>设置响应体</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=c1>// 设置响应行</span>
</span><span id=__span-4-2><span class=kt>void</span><span class=w> </span><span class=nf>setRespLine</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>line</span><span class=p>)</span>
</span><span id=__span-4-3><span class=p>{</span>
</span><span id=__span-4-4><span class=w>    </span><span class=n>_resp_line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>line</span><span class=p>;</span>
</span><span id=__span-4-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=kt>void</span><span class=w> </span><span class=nf>setRespBody</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>body</span><span class=p>)</span>
</span><span id=__span-5-2><span class=p>{</span>
</span><span id=__span-5-3><span class=w>    </span><span class=n>_resp_body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>body</span><span class=p>;</span>
</span><span id=__span-5-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>接着，再在<code>login</code>函数中通过<code>resp</code>调用该方法设置响应行和响应体：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-6-2><span class=p>{</span>
</span><span id=__span-6-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-6-4>
</span><span id=__span-6-5><span class=w>    </span><span class=c1>// 设置响应行</span>
</span><span id=__span-6-6><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>line</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>default_http_ver</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>to_string</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>resp</span><span class=p>.</span><span class=n>setStatusCodeDesc</span><span class=p>(</span><span class=mi>200</span><span class=p>);</span>
</span><span id=__span-6-7><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>setRespLine</span><span class=p>(</span><span class=n>line</span><span class=p>);</span>
</span><span id=__span-6-8>
</span><span id=__span-6-9><span class=w>    </span><span class=c1>// 设置响应体</span>
</span><span id=__span-6-10><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>body</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;&lt;h1&gt;Hello Linux&lt;/h1&gt;&quot;</span><span class=p>;</span>
</span><span id=__span-6-11><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>setRespBody</span><span class=p>(</span><span class=n>body</span><span class=p>);</span>
</span><span id=__span-6-12><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>测试结果如下：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320170045662.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320170045662.png"></a></p> <p>但是，上面的方法只能实现发送一个Cookie给客户端，因为对于哈希表来说，<code>key</code>相同，新值会覆盖旧值，当前插入的<code>key</code>都是<code>Set-Cookie</code>，所以会出现新的Cookie键值对覆盖旧的Cookie键值对，为了解决这个问题，可以考虑使用一个vector单独保存每一条设置Cookie的字符串</p> <p>所以，首先需要一个vector成员用于存储设置Cookie的字符串，接着在设置Cookie时，应该以一个完整的字符串存储到vector中，所以实际上需要下面的方法：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><span class=kt>void</span><span class=w> </span><span class=nf>insertRespCookies</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>cookie_str</span><span class=p>)</span>
</span><span id=__span-7-2><span class=p>{</span>
</span><span id=__span-7-3><span class=w>    </span><span class=n>_cookies</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>cookie_str</span><span class=p>);</span>
</span><span id=__span-7-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着，在序列化时直接对每一个设置Cookie的字符串添加换行符：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><span class=c1>// 序列化</span>
</span><span id=__span-8-2><span class=kt>bool</span><span class=w> </span><span class=nf>serialize</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>out_str</span><span class=p>)</span>
</span><span id=__span-8-3><span class=p>{</span>
</span><span id=__span-8-4><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-8-5>
</span><span id=__span-8-6><span class=w>    </span><span class=c1>// 单独为Cookie添加\r\n</span>
</span><span id=__span-8-7><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>for_each</span><span class=p>(</span><span class=n>_cookies</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>_cookies</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>s</span><span class=p>){</span>
</span><span id=__span-8-8><span class=w>        </span><span class=n>s</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>default_sep</span><span class=p>;</span>
</span><span id=__span-8-9><span class=w>        </span><span class=n>out_str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>s</span><span class=p>;</span>
</span><span id=__span-8-10><span class=w>    </span><span class=p>});</span>
</span><span id=__span-8-11>
</span><span id=__span-8-12><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-8-13>
</span><span id=__span-8-14><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-8-15><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>最后，修改设置Cookie的<code>login</code>函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-9-2><span class=p>{</span>
</span><span id=__span-9-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-9-4>
</span><span id=__span-9-5><span class=w>    </span><span class=c1>// 添加Cookie</span>
</span><span id=__span-9-6><span class=w>    </span><span class=c1>// resp.insertRespHead(&quot;Set-Cookie&quot;, &quot;testCookie=newCookie&quot;);</span>
</span><span id=__span-9-7><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: testCookie=newCookie&quot;</span><span class=p>);</span>
</span><span id=__span-9-8><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: testCookie1=newCookie1&quot;</span><span class=p>);</span>
</span><span id=__span-9-9><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: testCookie2=newCookie2&quot;</span><span class=p>);</span>
</span><span id=__span-9-10>
</span><span id=__span-9-11><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-9-12><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>编译运行上面的代码即可看到多条Cookie：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320193243902.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320193243902.png"></a></p> <h5 id=cookie_2>读取Cookie<a class=headerlink href=#cookie_2 title="Permanent link">&para;</a></h5> <p>当前，服务端已经可以向客户端写入Cookie信息，但是光写入还并不够，服务端还需要读取到对应的Cookie并对Cookie进行解析，因为客户端发送的Cookie形式为：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1>Cookie: testCookie=newCookie
</span></code></pre></div></td></tr></table></div> <p>所以需要根据这个字段格式进行解析</p> <p>在前面实现<code>HttpRequest</code>中已经实现了读取请求报头中的数据函数<code>getPairFromReqHead</code>，所以在该类中存在一个成员<code>key</code>为<code>Cookie</code>，<code>value</code>为<code>testCookie=newCookie</code>的键值对</p> <p>首先根据<code>key</code>找到对应的<code>value</code>，再将<code>value</code>根据拆分出每一个Cookie</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意，尽管服务端是分开设置多个Cookie，但是在客户端给服务端发送Cookie时是合并在一个Cookie中，每一个Cookie以<code>;&lt;space&gt;</code>进行分隔，例如：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1>Cookie: testCookie=newCookie; testCookie1=newCookie1
</span></code></pre></div></td></tr></table></div> </div> <p>接下来的问题就是如何拆分Cookie，拆分Cookie的思路和拆分请求体参数的方式非常类似，而因为要存储每一个Cookie键值对，所以还需要一个哈希表，所以基本结构如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><span class=c1>// 键值对分隔符</span>
</span><span id=__span-12-2><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>default_kv_sep</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;=&quot;</span><span class=p>;</span>
</span><span id=__span-12-3><span class=c1>// Cookie分隔符</span>
</span><span id=__span-12-4><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>default_cookie_sep</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;; &quot;</span><span class=p>;</span>
</span><span id=__span-12-5>
</span><span id=__span-12-6><span class=c1>// HTTP请求</span>
</span><span id=__span-12-7><span class=k>class</span><span class=w> </span><span class=nc>HttpRequest</span>
</span><span id=__span-12-8><span class=p>{</span>
</span><span id=__span-12-9><span class=k>public</span><span class=o>:</span>
</span><span id=__span-12-10><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-12-11>
</span><span id=__span-12-12><span class=w>    </span><span class=c1>// 获取Cookie键值对</span>
</span><span id=__span-12-13><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>getCookiePairFromReqHead</span><span class=p>()</span>
</span><span id=__span-12-14><span class=w>    </span><span class=p>{</span>
</span><span id=__span-12-15>
</span><span id=__span-12-16><span class=w>    </span><span class=p>}</span>
</span><span id=__span-12-17><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-12-18>
</span><span id=__span-12-19><span class=k>private</span><span class=o>:</span>
</span><span id=__span-12-20><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-12-21>
</span><span id=__span-12-22><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>_cookie_kv</span><span class=p>;</span><span class=w> </span><span class=c1>// Cookie键值对</span>
</span><span id=__span-12-23>
</span><span id=__span-12-24><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-12-25><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>接着，根据前面实现从请求体中获取参数键值对的思路实现获取Cookie键值对：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><span class=c1>// 获取Cookie键值对</span>
</span><span id=__span-13-2><span class=kt>bool</span><span class=w> </span><span class=nf>getCookiePairFromReqHead</span><span class=p>()</span>
</span><span id=__span-13-3><span class=p>{</span>
</span><span id=__span-13-4><span class=w>    </span><span class=c1>// 先提取到Cookie</span>
</span><span id=__span-13-5><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>keyPos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_kv</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=s>&quot;Cookie&quot;</span><span class=p>);</span>
</span><span id=__span-13-6><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>keyPos</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>_kv</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
</span><span id=__span-13-7><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-13-8>
</span><span id=__span-13-9><span class=w>    </span><span class=c1>// 在对应的value中找到Cookie值</span>
</span><span id=__span-13-10><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>cookie_value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_kv</span><span class=p>[</span><span class=s>&quot;Cookie&quot;</span><span class=p>];</span>
</span><span id=__span-13-11>
</span><span id=__span-13-12><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>size_t</span><span class=p>(</span><span class=mi>-1</span><span class=p>);</span>
</span><span id=__span-13-13>
</span><span id=__span-13-14><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=nb>true</span><span class=p>)</span>
</span><span id=__span-13-15><span class=w>    </span><span class=p>{</span>
</span><span id=__span-13-16><span class=w>        </span><span class=c1>// 找到;</span>
</span><span id=__span-13-17><span class=w>        </span><span class=k>auto</span><span class=w> </span><span class=n>pos1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>default_cookie_sep</span><span class=p>,</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-18><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>pos1</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>npos</span><span class=p>)</span>
</span><span id=__span-13-19><span class=w>        </span><span class=p>{</span>
</span><span id=__span-13-20><span class=w>            </span><span class=c1>// 最后一个参数键值对</span>
</span><span id=__span-13-21><span class=w>            </span><span class=k>auto</span><span class=w> </span><span class=n>pos_t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>default_kv_sep</span><span class=p>,</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-22><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>pos_t</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>npos</span><span class=p>)</span>
</span><span id=__span-13-23><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-13-24>
</span><span id=__span-13-25><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>substr</span><span class=p>(</span><span class=n>pos</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>pos_t</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-26><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>substr</span><span class=p>(</span><span class=n>pos_t</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-27>
</span><span id=__span-13-28><span class=w>            </span><span class=n>_cookie_kv</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>});</span>
</span><span id=__span-13-29><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-13-30><span class=w>        </span><span class=p>}</span>
</span><span id=__span-13-31>
</span><span id=__span-13-32><span class=w>        </span><span class=c1>// 找到=</span>
</span><span id=__span-13-33><span class=w>        </span><span class=k>auto</span><span class=w> </span><span class=n>pos2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>default_kv_sep</span><span class=p>,</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-34><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>pos2</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>::</span><span class=n>npos</span><span class=p>)</span>
</span><span id=__span-13-35><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-13-36>
</span><span id=__span-13-37><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>key</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>substr</span><span class=p>(</span><span class=n>pos</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>pos2</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-38><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cookie_value</span><span class=p>.</span><span class=n>substr</span><span class=p>(</span><span class=n>pos2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>pos1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>pos2</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-13-39>
</span><span id=__span-13-40><span class=w>        </span><span class=n>_cookie_kv</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=n>key</span><span class=p>,</span><span class=w> </span><span class=n>value</span><span class=p>});</span>
</span><span id=__span-13-41>
</span><span id=__span-13-42><span class=w>        </span><span class=c1>// 修改起始位置</span>
</span><span id=__span-13-43><span class=w>        </span><span class=n>pos</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-13-44><span class=w>    </span><span class=p>}</span>
</span><span id=__span-13-45>
</span><span id=__span-13-46><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-13-47><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>在上面的代码中，除了函数开始的逻辑与前面获取<code>POST</code>请求参数的逻辑不一样以外，还有更新<code>pos</code>的逻辑，因为不同的Cookie之间的分隔符是两个字符，而不是一个字符</p> </div> <p>接下来，为了可以看到拆分后的结果，提供一个打印函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=kt>void</span><span class=w> </span><span class=nf>getCookieKv</span><span class=p>()</span>
</span><span id=__span-14-2><span class=p>{</span>
</span><span id=__span-14-3><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>for_each</span><span class=p>(</span><span class=n>_cookie_kv</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>_cookie_kv</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=n>std</span><span class=o>::</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>kv</span><span class=p>)</span>
</span><span id=__span-14-4><span class=w>                </span><span class=p>{</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>kv</span><span class=p>.</span><span class=n>first</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;:&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>kv</span><span class=p>.</span><span class=n>second</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-14-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>有了上面的函数后，接下来就是在指定位置调用该函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=c1>// 反序列化</span>
</span><span id=__span-15-2><span class=kt>bool</span><span class=w> </span><span class=nf>deserialize</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>in_str</span><span class=p>)</span>
</span><span id=__span-15-3><span class=p>{</span>
</span><span id=__span-15-4><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-15-5><span class=w>    </span><span class=c1>// 获取Cookie</span>
</span><span id=__span-15-6><span class=w>    </span><span class=n>getCookiePairFromReqHead</span><span class=p>();</span>
</span><span id=__span-15-7><span class=w>    </span><span class=c1>// 打印获取到的Cookie</span>
</span><span id=__span-15-8><span class=w>    </span><span class=n>getCookieKv</span><span class=p>();</span>
</span><span id=__span-15-9>
</span><span id=__span-15-10><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-15-11>
</span><span id=__span-15-12><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-15-13><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>编译运行上面的代码，观察结果：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320194007537.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320194007537.png"></a></p> <p>从上面的结果可以看到，所有设置到客户端的Cookie都可以正常获取</p> <h4 id=_7>完整形式<a class=headerlink href=#_7 title="Permanent link">&para;</a></h4> <h5 id=_8>介绍<a class=headerlink href=#_8 title="Permanent link">&para;</a></h5> <p>上面已经基本实现了简单形式下Cookie的写入和读取，但是有时简单的Cookie并不能满足实际的需求，所以除了完成简单形式以外，还需要实现完整形式的Cookie</p> <p>虽然是完整形式，但是客户端最后拿到的Cookie会被浏览器进行分析，并将相关的属性填充到浏览器的相关属性中，而客户端第二次以及后面请求服务器时，携带的Cookie也只是上面简单形式的Cookie</p> <p>基于上面的原因，在完整形式部分只需要实现形成某些字段的函数即可</p> <p>本次只是实现完整形式中的<code>expires</code>和<code>path</code>，其他字段不考虑</p> <h5 id=expires>实现<code>expires</code><a class=headerlink href=#expires title="Permanent link">&para;</a></h5> <p>在实现<code>expires</code>字段之前，先了解其格式：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1>expires=Week, Day Month Year Hour:Minutes:Seconds UTC/GMT;
</span></code></pre></div></td></tr></table></div> <p>第一个值为星期，第二个值为年月日，第三个值为时分秒，最后一个代表时区，UTC代表协调世界时，GMT代表格林威治平均时间，对于前面的三个字段来说都可以通过系统调用进行获取，唯独最后一个字段需要手动指定，那么选择UTC还是GMT？<strong>推荐UTC</strong>，其次再是GMT，原因如下：</p> <div class="admonition info"> <p class=admonition-title>关于UTC和GMT</p> <p>UTC全称为Coordinated Universal Time (协调世界时)，是现代国际社会使用的主要时间标准：基于高精度的原子钟，不受地球自转不规则性的影响，是国际标准化组织ISO推荐的官方时间标准。是现在全球互联网通信和大多数计算机系统的时间基准，格式精确统一，适合跨系统通信</p> <p>GMT全称为Greenwich Mean Time (格林威治平均时间)：历史上的时间标准，基于英国伦敦格林威治天文台的太阳时，其标准基于地球自转，存在微小的不规则性，在科学和技术领域已逐渐被UTC替代，但在日常交流中仍被广泛使用</p> </div> <p>在Cookie的<code>expires</code>字段中：<strong>推荐使用UTC</strong>：更精确，是现代网络协议的标准做法。GMT仍然被广泛支持，大多数浏览器能正确处理。实际上两者时间差异极小(不到1秒)，但从标准化和兼容性考虑，优先选择UTC</p> <p>有了知识基础，接下来就是实现获取时间函数，在前面<a href=https://www.help-doc.top/Linux/com-process/com-named-pipe-shm/com-named-pipe-shm.html#_8>命名管道与共享内存</a>和<a href=https://www.help-doc.top/Linux/linux-thread/log/log.html#_8>日志系统</a>已经实现或者使用了一个获取时间的函数，本次实现的思路和该函数基本一致，但是当时使用的是<code>localtime</code>或者<code>localtime_r</code>函数，这两个函数都会自动包含时区，而实际上在设置<code>expires</code>时不需要设置时区，当客户端获取到时间后会自动根据当前浏览器所处的地区设置时区，所以这里推荐使用另外一个系统调用<code>gmtime</code>或者其可重入版本<code>gmtime_r</code>。下面以<code>gmtime</code>为例，函数原型如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1><span class=k>struct</span><span class=w> </span><span class=nc>tm</span><span class=w> </span><span class=o>*</span><span class=n>gmtime</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=kt>time_t</span><span class=w> </span><span class=o>*</span><span class=n>timep</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>使用方式与<code>localtime</code>一样，此处不再介绍。根据格式<code>Wed, 21 Oct 2025 07:28:00 GMT</code>，首先需要两个额外的函数，根据月份数字获取月份字符串和根据星期数字获取星期字符串，接着再使用这两个函数获取一个完整的<code>expires</code>时间：</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><input id=__tabbed_2_3 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1>根据星期数字获取星期字符串</label><label for=__tabbed_2_2>根据月份数字获取月份字符串</label><label for=__tabbed_2_3>获取<code>expires</code>函数</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>getWeekStrFromNumber</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>w</span><span class=p>)</span>
</span><span id=__span-18-2><span class=p>{</span>
</span><span id=__span-18-3><span class=w>    </span><span class=c1>// 第一个元素最好是星期天，因为gmtime以星期天为第一天</span>
</span><span id=__span-18-4><span class=w>    </span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>weekdays</span><span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=s>&quot;Sun&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Mon&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Tue&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Wed&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Thu&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Fri&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Sat&quot;</span><span class=p>};</span>
</span><span id=__span-18-5>
</span><span id=__span-18-6><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>w</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>w</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-18-7><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>();</span>
</span><span id=__span-18-8>
</span><span id=__span-18-9><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>weekdays</span><span class=p>[</span><span class=n>w</span><span class=p>];</span>
</span><span id=__span-18-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-19-1><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>getMonthStrFromNumber</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>m</span><span class=p>)</span>
</span><span id=__span-19-2><span class=p>{</span>
</span><span id=__span-19-3><span class=w>    </span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>months</span><span class=p>[</span><span class=mi>12</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=s>&quot;Jan&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Feb&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Mar&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Apr&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;May&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Jun&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Jul&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Aug&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Sep&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Oct&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Nov&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Dec&quot;</span><span class=p>};</span>
</span><span id=__span-19-4>
</span><span id=__span-19-5><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>m</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>12</span><span class=p>)</span>
</span><span id=__span-19-6><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>();</span>
</span><span id=__span-19-7>
</span><span id=__span-19-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>months</span><span class=p>[</span><span class=n>m</span><span class=p>];</span>
</span><span id=__span-19-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-20-1><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>getCookieExpiresTime</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>last</span><span class=p>)</span>
</span><span id=__span-20-2><span class=p>{</span>
</span><span id=__span-20-3><span class=w>    </span><span class=c1>// 获取指定的时间之后的时间戳</span>
</span><span id=__span-20-4><span class=w>    </span><span class=kt>time_t</span><span class=w> </span><span class=n>t</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span><span class=p>(</span><span class=nb>NULL</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>last</span><span class=p>;</span>
</span><span id=__span-20-5><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>tm</span><span class=w> </span><span class=o>*</span><span class=n>timer</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>gmtime</span><span class=p>(</span><span class=o>&amp;</span><span class=n>t</span><span class=p>);</span>
</span><span id=__span-20-6>
</span><span id=__span-20-7><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>1024</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span><span id=__span-20-8><span class=w>    </span><span class=c1>// Wed, 21 Oct 2025 07:28:00 GMT</span>
</span><span id=__span-20-9><span class=w>    </span><span class=c1>// 注意，涉及到数字的都需要两位，确保一位数可以有前导0</span>
</span><span id=__span-20-10><span class=w>    </span><span class=n>snprintf</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>buffer</span><span class=p>),</span><span class=w> </span><span class=s>&quot;%s, %02d %s %d %02d:%02d:%02d UTC&quot;</span><span class=p>,</span><span class=w> </span>
</span><span id=__span-20-11><span class=w>                </span><span class=n>getWeekStrFromNumber</span><span class=p>(</span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_wday</span><span class=p>).</span><span class=n>c_str</span><span class=p>(),</span>
</span><span id=__span-20-12><span class=w>                </span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_mday</span><span class=p>,</span>
</span><span id=__span-20-13><span class=w>                </span><span class=n>getMonthStrFromNumber</span><span class=p>(</span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_year</span><span class=p>).</span><span class=n>c_str</span><span class=p>(),</span>
</span><span id=__span-20-14><span class=w>                </span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_year</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1900</span><span class=p>,</span>
</span><span id=__span-20-15><span class=w>                </span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_hour</span><span class=p>,</span>
</span><span id=__span-20-16><span class=w>                </span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_min</span><span class=p>,</span>
</span><span id=__span-20-17><span class=w>                </span><span class=n>timer</span><span class=o>-&gt;</span><span class=n>tm_sec</span><span class=p>);</span>
</span><span id=__span-20-18>
</span><span id=__span-20-19><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>buffer</span><span class=p>;</span>
</span><span id=__span-20-20><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>接着，在<code>login</code>函数中创建一个带有<code>expires</code>的Cookie，过期时间设置为1分钟：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-21-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-21-2><span class=p>{</span>
</span><span id=__span-21-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-21-4>
</span><span id=__span-21-5><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>cookie_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;testCookie=newCookie; expires=&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>resp</span><span class=p>.</span><span class=n>getCookieExpiresTime</span><span class=p>(</span><span class=mi>60</span><span class=p>);</span>
</span><span id=__span-21-6><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>cookie_val</span><span class=p>);</span>
</span><span id=__span-21-7>
</span><span id=__span-21-8><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-21-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>编译运行上面的代码，观察结果：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320203328596.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320203328596.png"></a></p> <p>在控制台打印出实际获取到的时间如下：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320203408035.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320203408035.png"></a></p> <p>可以看到，这个时间虽然没有时区，但是在浏览器显示时已经会转换成当地时区</p> <h5 id=path>实现<code>path</code><a class=headerlink href=#path title="Permanent link">&para;</a></h5> <p><code>path</code>的实现很简单，只需要在<code>login</code>中设置Cookie时传递<code>path</code>即可：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-22-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-22-2><span class=p>{</span>
</span><span id=__span-22-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-22-4>
</span><span id=__span-22-5><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: testCookie=newCookie; path=/login.html&quot;</span><span class=p>);</span>
</span><span id=__span-22-6>
</span><span id=__span-22-7><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-22-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>先设置Cookie：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320203935374.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320203935374.png"></a></p> <p>此时，<code>testCookie=newCookie</code>一旦被设置，下一层就只会在客户端访问<code>login.html</code>时才会携带该Cookie：</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1>访问主页</label><label for=__tabbed_3_2>访问<code>login.html</code></label></div> <div class=tabbed-content> <div class=tabbed-block> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320204031827.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320204031827.png"></a></p> </div> <div class=tabbed-block> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320204123052.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320204123052.png"></a></p> </div> </div> </div> <h3 id=cookie_3>Cookie的安全性<a class=headerlink href=#cookie_3 title="Permanent link">&para;</a></h3> <p>在上面的测试中可以发现，不论Cookie是从服务端到客户端，还是客户端到服务端，都是可以在客户端以明文的方式看到的，如果用户输入的是账户名和密码或者其他隐私信息，那么一旦这个Cookie被劫持，就会出现用户信息泄露的问题，这对用户来说是较大的损失，所以Cookie本身是不安全的</p> <h2 id=httpsession>HTTP中的Session<a class=headerlink href=#httpsession title="Permanent link">&para;</a></h2> <h3 id=_9>基本介绍<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>上面提到Cookie是不安全的，为了尽可能保证安全这个问题，在现代HTTP中除了使用Cookie外还会使用Session</p> <p>Session与Cookie不同，Session是存储在服务器端的，当用户第一次请求服务端时，服务端会将用户的信息存储到一个特定的位置，再向客户端写入一个值为sessionID的Cookie，当用户第二次请求服务器时就会携带这个值sessionID的Cookie访问服务器，服务器会根据这个SessionID查找用户的信息，从而实现用户状态的保持</p> <h3 id=httpserversession>在<code>HttpServer</code>中实现Session<a class=headerlink href=#httpserversession title="Permanent link">&para;</a></h3> <p>要在<code>HttpServer</code>中实现Session，首先可以考虑创建一个<code>Session</code>类，这个类用于存储一个用户的相关信息，相当于之前包含用户信息的Cookie：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-23-1><span class=k>class</span><span class=w> </span><span class=nc>Session</span>
</span><span id=__span-23-2><span class=p>{</span>
</span><span id=__span-23-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-23-4><span class=w>    </span><span class=n>Session</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>status</span><span class=p>)</span>
</span><span id=__span-23-5><span class=w>    </span><span class=o>:</span><span class=n>_username</span><span class=p>(</span><span class=n>username</span><span class=p>),</span><span class=w> </span><span class=n>_status</span><span class=p>(</span><span class=n>status</span><span class=p>)</span>
</span><span id=__span-23-6><span class=w>    </span><span class=p>{</span>
</span><span id=__span-23-7><span class=w>        </span><span class=n>_create_time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>time</span><span class=p>(</span><span class=k>nullptr</span><span class=p>);</span><span class=w> </span><span class=c1>// 获取时间戳就行了，后面实际需要，就转化就转换一下</span>
</span><span id=__span-23-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-23-9><span class=w>    </span><span class=o>~</span><span class=n>Session</span><span class=p>()</span>
</span><span id=__span-23-10><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-23-11><span class=k>public</span><span class=o>:</span>
</span><span id=__span-23-12><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>_username</span><span class=p>;</span>
</span><span id=__span-23-13><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>_status</span><span class=p>;</span>
</span><span id=__span-23-14><span class=w>    </span><span class=kt>uint64_t</span><span class=w> </span><span class=n>_create_time</span><span class=p>;</span>
</span><span id=__span-23-15><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>因为服务器获取到的肯定不止一个Session，所以还需要一个类对<code>Session</code>类对象进行管理，此处可以考虑创建一个<code>SessionManager</code>类，因为sessionID是一个随机数，并且一般不能出冲突情况，所以这里考虑使用boost库中获取UUID的函数<code>generator</code>：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-24-1><span class=k>using</span><span class=w> </span><span class=n>session_ptr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>Session</span><span class=o>&gt;</span><span class=p>;</span>
</span><span id=__span-24-2>
</span><span id=__span-24-3><span class=k>class</span><span class=w> </span><span class=nc>SessionManager</span>
</span><span id=__span-24-4><span class=p>{</span>
</span><span id=__span-24-5><span class=k>public</span><span class=o>:</span>
</span><span id=__span-24-6><span class=w>    </span><span class=n>SessionManager</span><span class=p>()</span>
</span><span id=__span-24-7><span class=w>    </span><span class=p>{</span>
</span><span id=__span-24-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-24-9><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>addSession</span><span class=p>(</span><span class=n>session_ptr</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-24-10><span class=w>    </span><span class=p>{</span>
</span><span id=__span-24-11><span class=w>        </span><span class=c1>// 使用boost库生成uuid</span>
</span><span id=__span-24-12><span class=w>        </span><span class=c1>// 创建一个随机数生成器</span>
</span><span id=__span-24-13><span class=w>        </span><span class=n>boost</span><span class=o>::</span><span class=n>uuids</span><span class=o>::</span><span class=n>random_generator</span><span class=w> </span><span class=n>generator</span><span class=p>;</span>
</span><span id=__span-24-14>
</span><span id=__span-24-15><span class=w>        </span><span class=c1>// 生成一个随机 UUID</span>
</span><span id=__span-24-16><span class=w>        </span><span class=n>boost</span><span class=o>::</span><span class=n>uuids</span><span class=o>::</span><span class=n>uuid</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>generator</span><span class=p>();</span>
</span><span id=__span-24-17><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>sessionid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>boost</span><span class=o>::</span><span class=n>uuids</span><span class=o>::</span><span class=n>to_string</span><span class=p>(</span><span class=n>id</span><span class=p>);</span>
</span><span id=__span-24-18><span class=w>        </span><span class=n>_sessions</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>make_pair</span><span class=p>(</span><span class=n>sessionid</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>));</span>
</span><span id=__span-24-19><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>sessionid</span><span class=p>;</span>
</span><span id=__span-24-20><span class=w>    </span><span class=p>}</span>
</span><span id=__span-24-21><span class=w>    </span><span class=n>session_ptr</span><span class=w> </span><span class=n>getSession</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>sessionid</span><span class=p>)</span>
</span><span id=__span-24-22><span class=w>    </span><span class=p>{</span>
</span><span id=__span-24-23><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_sessions</span><span class=p>.</span><span class=n>find</span><span class=p>(</span><span class=n>sessionid</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>_sessions</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
</span><span id=__span-24-24><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=k>nullptr</span><span class=p>;</span>
</span><span id=__span-24-25><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>_sessions</span><span class=p>[</span><span class=n>sessionid</span><span class=p>];</span>
</span><span id=__span-24-26><span class=w>    </span><span class=p>}</span>
</span><span id=__span-24-27><span class=w>    </span><span class=o>~</span><span class=n>SessionManager</span><span class=p>()</span>
</span><span id=__span-24-28><span class=w>    </span><span class=p>{</span>
</span><span id=__span-24-29><span class=w>    </span><span class=p>}</span>
</span><span id=__span-24-30>
</span><span id=__span-24-31><span class=k>private</span><span class=o>:</span>
</span><span id=__span-24-32><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>,</span><span class=w> </span><span class=n>session_ptr</span><span class=o>&gt;</span><span class=w> </span><span class=n>_sessions</span><span class=p>;</span>
</span><span id=__span-24-33><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>首先考虑在<code>HttpRequest</code>中创建一个<code>SessionManager</code>类对象指针，并使用<code>SessionManager</code>类对象进行初始化。接着在反序列化时查找出Cookie中是否有<code>sessionid</code>，如果有就根据这个<code>sessionid</code>查找是否已经存在于<code>SessionManager</code>中，如果不存在就创建一个<code>Session</code>对象并插入到<code>SessionManager</code>中</p> <p>但是，在上面创建<code>Session</code>对象时需要使用用户名创建，而这个用户名来自请求参数，如果没有请求参数就不需要创建<code>Session</code>对象，所以需要对前面获取参数的函数进行修改，使其有返回值：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-25-1><span class=kt>bool</span><span class=w> </span><span class=nf>getReqParams</span><span class=p>()</span>
</span><span id=__span-25-2><span class=p>{</span>
</span><span id=__span-25-3><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_req_method</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&quot;GET&quot;</span><span class=p>)</span>
</span><span id=__span-25-4><span class=w>    </span><span class=p>{</span>
</span><span id=__span-25-5><span class=w>        </span><span class=c1>// 处理GET请求中的参数</span>
</span><span id=__span-25-6><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>getReqParamsFromReqLine</span><span class=p>())</span>
</span><span id=__span-25-7><span class=w>        </span><span class=p>{</span>
</span><span id=__span-25-8><span class=w>            </span><span class=n>_hasArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-25-9><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-25-10><span class=w>        </span><span class=p>}</span>
</span><span id=__span-25-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-25-12><span class=w>    </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_req_method</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=s>&quot;POST&quot;</span><span class=p>)</span>
</span><span id=__span-25-13><span class=w>    </span><span class=p>{</span>
</span><span id=__span-25-14><span class=w>        </span><span class=c1>// 处理POST请求中的参数</span>
</span><span id=__span-25-15><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>getReqParamsFromBody</span><span class=p>())</span>
</span><span id=__span-25-16><span class=w>        </span><span class=p>{</span>
</span><span id=__span-25-17><span class=w>            </span><span class=n>_hasArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-25-18><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-25-19><span class=w>        </span><span class=p>}</span>
</span><span id=__span-25-20><span class=w>    </span><span class=p>}</span>
</span><span id=__span-25-21>
</span><span id=__span-25-22><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-25-23><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着，在<code>HttpRequest</code>类中添加一个成员<code>_sessionid</code>，并在<code>deserialize</code>函数中补充逻辑：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-26-1><span class=kt>bool</span><span class=w> </span><span class=nf>deserialize</span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=o>&amp;</span><span class=n>in_str</span><span class=p>)</span>
</span><span id=__span-26-2><span class=p>{</span>
</span><span id=__span-26-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-26-4>
</span><span id=__span-26-5><span class=w>    </span><span class=c1>// 获取参数内容</span>
</span><span id=__span-26-6><span class=w>    </span><span class=k>if</span><span class=p>(</span><span class=n>getReqParams</span><span class=p>())</span><span class=w> </span>
</span><span id=__span-26-7><span class=w>    </span><span class=p>{</span>
</span><span id=__span-26-8><span class=w>        </span><span class=c1>// 判断制定的sessionid是否存在，不存在则创建</span>
</span><span id=__span-26-9><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>_sm</span><span class=o>-&gt;</span><span class=n>getSession</span><span class=p>(</span><span class=n>getSessionIdFromCookiePair</span><span class=p>()))</span>
</span><span id=__span-26-10><span class=w>        </span><span class=p>{</span>
</span><span id=__span-26-11><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_param_kv</span><span class=p>[</span><span class=s>&quot;username&quot;</span><span class=p>];</span>
</span><span id=__span-26-12><span class=w>            </span><span class=c1>// 根据参数的username创建Session对象，并处于活跃状态</span>
</span><span id=__span-26-13><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>shared_ptr</span><span class=o>&lt;</span><span class=n>Session</span><span class=o>&gt;</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>Session</span><span class=o>&gt;</span><span class=p>(</span><span class=n>username</span><span class=p>,</span><span class=w> </span><span class=s>&quot;active&quot;</span><span class=p>);</span>
</span><span id=__span-26-14><span class=w>            </span><span class=c1>// 插入到SessionManager中</span>
</span><span id=__span-26-15><span class=w>            </span><span class=n>_sessionid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_sm</span><span class=o>-&gt;</span><span class=n>addSession</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span><span id=__span-26-16><span class=w>        </span><span class=p>}</span>
</span><span id=__span-26-17><span class=w>    </span><span class=p>}</span>
</span><span id=__span-26-18>
</span><span id=__span-26-19><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-26-20><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着，在用户请求<code>/login</code>时，创建一个Cookie，这个Cookie的值即为<code>sessionid</code>，所以此处还需要在<code>HttpRequest</code>中提供一个获取<code>_sessiondid</code>的函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-27-1><span class=c1>// 获取_sessionid</span>
</span><span id=__span-27-2><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>getSessionId</span><span class=p>()</span>
</span><span id=__span-27-3><span class=p>{</span>
</span><span id=__span-27-4><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>_sessionid</span><span class=p>;</span>
</span><span id=__span-27-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>修改<code>login</code>函数如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-28-1><span class=kt>void</span><span class=w> </span><span class=nf>login</span><span class=p>(</span><span class=n>HttpRequest</span><span class=w> </span><span class=o>&amp;</span><span class=n>req</span><span class=p>,</span><span class=w> </span><span class=n>HttpResponse</span><span class=w> </span><span class=o>&amp;</span><span class=n>resp</span><span class=p>)</span>
</span><span id=__span-28-2><span class=p>{</span>
</span><span id=__span-28-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-28-4>
</span><span id=__span-28-5><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>sessionid</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>req</span><span class=p>.</span><span class=n>getSessionId</span><span class=p>();</span>
</span><span id=__span-28-6><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>cookie_val</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;sessionid=&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>sessionid</span><span class=p>;</span>
</span><span id=__span-28-7><span class=w>    </span><span class=n>resp</span><span class=p>.</span><span class=n>insertRespCookies</span><span class=p>(</span><span class=s>&quot;Set-Cookie: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>cookie_val</span><span class=p>);</span>
</span><span id=__span-28-8>
</span><span id=__span-28-9><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-28-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>编译上面的代码，观察结果：</p> <p><a class=glightbox href="4. HTTP中的Cookie和Session.assets/image-20250320214309011.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="4. HTTP中的Cookie和Session.assets/image-20250320214309011.png"></a></p> <h3 id=session>Session的安全性<a class=headerlink href=#session title="Permanent link">&para;</a></h3> <p>Session相比Cookie具有明显的安全优势。由于Session将用户敏感数据存储在服务器端，而不是客户端，只通过SessionID标识用户，大大降低了信息泄露风险。客户端仅存储一个不包含实际用户数据的SessionID，即使这个ID被截获，攻击者也无法直接获取用户的实际信息，如密码和个人资料</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年3月20日</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> 页面有帮助吗？ </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title=页面对我有帮助 data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title=页面没有帮助到我 data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> 谢谢你的反馈！ </div> <div data-md-value=0 hidden> 谢谢你的反馈！联系<a href=https://www.help-doc.top/author/contact/contact.html>作者</a>提供更详细的信息 </div> </div> </div> </fieldset> </form> <!-- Waline 评论系统 --> <div id=waline></div> <!-- 阅读进度条 - 直接在HTML中定义 --> <div class=reading-progress></div> <!-- 滚动指示器 - 直接在HTML中定义 --> <div class=scroll-indicator></div> <!-- 评论系统 --> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Footer --> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../../javascripts/katex.min.js></script> <script src=../../../javascripts/other.min.js></script> <script src=../../../javascripts/copyright.min.js></script> <script src=../../../javascripts/waline.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script src=../../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>