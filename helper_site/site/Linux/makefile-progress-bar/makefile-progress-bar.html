<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/Linux/makefile-progress-bar/makefile-progress-bar.html><link rel=prev href=../gcc-gdb/gcc-gdb.html><link rel=next href=../os-basic/os-basic.html><link rel=icon href=../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>Linux下的Makefile与进度条程序 - 柯懒的知识库</title><link rel=stylesheet href=../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../css/timeline.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-9XWRGNRRSY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-9XWRGNRRSY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-9XWRGNRRSY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link rel=stylesheet href=../../stylesheets/colors.min.css><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)" id=theme2-desktop><link rel=stylesheet href=../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)" id=theme1-desktop><link rel=stylesheet href=../../stylesheets/print.min.css><link rel=stylesheet href=../../stylesheets/font-dongguanti.min.css id=font-dongguanti><link rel=stylesheet href=../../stylesheets/font-oppoti.min.css id=font-oppoti disabled><link rel=stylesheet href=../../stylesheets/font-jiangchengti.min.css id=font-jiangchengti disabled><link rel=stylesheet href=../../stylesheets/font-lxgw.min.css id=font-lxgw disabled><link rel=stylesheet href=../../stylesheets/code-font-dejavu-sans-mono.min.css id=code-font-dejavu-sans-mono><link rel=stylesheet href=../../stylesheets/code-font-zsft-hk.min.css id=code-font-zsft-hk disabled><link rel=stylesheet href=../../stylesheets/code-font-google-sans-code.min.css id=code-font-google-sans-code disabled><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css><link rel=stylesheet href=../../stylesheets/waline.min.css><script src=../../javascripts/start.min.js></script><link rel=preload href=../../stylesheets/colors.min.css as=style><link rel=preload href=../../stylesheets/theme2.min.css as=style><link rel=preload href=../../javascripts/start.min.js as=script><link rel=preload href=../../assets/logo.png as=image><link rel=preload href=../../images/favicon.png as=image><link rel=preload href=../../author/作者.assets/20250206-200653.jpg as=image><link rel=dns-prefetch href=//unpkg.com><link rel=dns-prefetch href=//cloud.umami.is><script defer src=https://cloud.umami.is/script.js data-website-id=02f9b8b7-93d4-4026-bdd8-221f2fcea2cf></script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#linuxmakefile class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Linux下的Makefile与进度条程序 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <div class=header-avatar> <img src=../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../author/contact/contact.html class=avatar-dropdown-item>联系作者</a> <div class=avatar-dropdown-divider></div> <a href=../../author/about/about.html class=avatar-dropdown-item>关于作者</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>Github仓库</a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=toolbar-toggle-btn id=toolbarToggleBtn onclick=toggleToolbar()> <div class=toggle-icon> <svg class=toggle-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=16 height=16> <path d="M346.538667 1024L170.666667 853.333333l341.333333-341.333333-341.333333-341.333333 175.872-170.666667L853.333333 512z" fill=currentColor></path> </svg> </div> </div> <div class=floating-toolbar id=floatingToolbar> <div class="toolbar-item font-switcher"> <div class=toolbar-icon> <svg class=font-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M913.408 1024l-66.56 0q-29.696 0-51.2-5.12t-36.864-15.872-26.112-27.136-19.968-37.888q-15.36-38.912-28.16-70.656t-22.016-55.296q-11.264-26.624-20.48-49.152l-254.976 0q-7.168 23.552-17.408 51.2-8.192 23.552-21.504 56.832t-30.72 72.192q-20.48 46.08-47.104 63.488t-60.416 17.408l-70.656 0q-45.056 0-60.928-19.968t2.56-68.096q18.432-46.08 43.008-108.544t52.224-132.608 57.344-143.872 57.344-144.384q65.536-164.864 137.216-343.04 7.168-17.408 18.432-31.744 10.24-11.264 27.136-21.504t42.496-10.24q26.624 0 43.52 10.752t28.16 24.064q12.288 15.36 19.456 33.792 72.704 180.224 138.24 345.088 27.648 70.656 57.344 143.872t56.832 142.336 51.2 129.536 41.472 104.448q14.336 34.816 4.096 62.464t-43.008 27.648zM616.448 634.88l-97.28-347.136-1.024 0-108.544 347.136 206.848 0z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>内容字体</div> <div class=font-dropdown-toolbar> <div class=font-current-toolbar onclick=toggleFontDropdownToolbar()> <span class=current-font-name-toolbar>东观体</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=font-options-toolbar> <div class=font-option-toolbar data-font=dongguanti onclick="selectFontToolbar('dongguanti')">上图东观体 </div> <div class=font-option-toolbar data-font=oppoti onclick="selectFontToolbar('oppoti')">OPPO Sans </div> <div class=font-option-toolbar data-font=jiangchengti onclick="selectFontToolbar('jiangchengti')"> 江城黑体</div> <div class=font-option-toolbar data-font=lxgw onclick="selectFontToolbar('lxgw')">霞鹜臻楷</div> </div> </div> </div> <div class="toolbar-item code-font-switcher"> <div class=toolbar-icon> <svg t=1753672111433 class="icon code-font-icon" viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=5148 width=20 height=20> <path d="M941.709938 0H82.290062A82.290062 82.290062 0 0 0 0 82.290062v859.419876A82.290062 82.290062 0 0 0 82.290062 1022.53923h859.419876A82.290062 82.290062 0 0 0 1022.53923 941.709938V82.290062A82.290062 82.290062 0 0 0 941.709938 0zM188.439372 553.631954a40.901569 40.901569 0 0 1-29.215406-70.116975L292.154066 351.558726 159.223966 218.628626a40.901569 40.901569 0 0 1 58.430813-57.94389l160.197813 162.145507a40.901569 40.901569 0 0 1 0 57.943889l-160.197813 160.684736a40.901569 40.901569 0 0 1-29.215407 12.173086z m443.587257 0H405.120304a40.901569 40.901569 0 0 1 0-82.290061H633.000476a40.901569 40.901569 0 0 1 0 82.290061z" fill=currentColor p-id=5149></path> </svg> </div> <div class=toolbar-label>代码字体</div> <div class=code-font-dropdown-toolbar> <div class=code-font-current-toolbar onclick=toggleCodeFontDropdownToolbar()> <span class=current-code-font-name-toolbar>DejaVu Sans Mono</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=code-font-options-toolbar> <div class=code-font-option-toolbar data-code-font=dejavu onclick="selectCodeFontToolbar('dejavu')"> DejaVu Sans Mono</div> <div class=code-font-option-toolbar data-code-font=google-sans-code onclick="selectCodeFontToolbar('google-sans-code')"> Google Sans Code</div> <div class=code-font-option-toolbar data-code-font=zsft onclick="selectCodeFontToolbar('zsft')"> JetBrains Mono</div> </div> </div> </div> <div class="toolbar-item theme-switcher" onclick=switchTheme()> <div class=toolbar-icon> <svg class=theme-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M876.572788 522.301623c-1.886977 12.375865-9.657964 30.331819-35.880185 45.48903-56.489572 32.697703-150.21828 83.990926-174.010149 96.958262-13.143345 24.431435-66.067718 122.221646-98.141204 178.503487-16.117073 28.124548-36.055171 34.041304-50.030463 34.041304-0.031722 0-0.031722 0-0.031722 0-14.613836 0-29.1806-6.460132-43.234687-19.218714-47.183626-42.643216-125.994576-117.105115-146.013515-136.083351-27.757181-4.732791-138.338718-23.743774-200.584388-35.752272-17.924231-3.533476-32.649608-14.07046-40.372499-29.084409-5.78782-11.256368-10.281157-30.05962 1.471514-55.658647 26.989701-59.047838 74.126254-157.557432 85.957721-182.196599-3.437286-27.117614-16.996093-135.060045-23.760147-198.905142-1.886977-17.460674 3.901867-35.096333 15.829524-48.351218 12.791327-14.278191 30.667463-21.48943 49.854455-19.426445 63.669088 6.332219 173.259042 19.426445 200.584388 22.705118 24.335245-11.879562 121.085776-58.936297 180.133613-86.34146 9.91379-4.573155 19.85828-6.92369 29.596062-6.92369 28.748764 0 52.172243 20.642133 58.328453 51.421136 12.599969 62.997799 30.93864 166.70272 35.639708 193.484689 18.851347 19.682271 91.953272 96.031147 135.060045 143.07151C872.72004 487.125473 879.307062 504.71406 876.572788 522.301623L876.572788 522.301623zM825.375755 499.085876C776.017604 445.314205 687.245791 352.977193 686.365748 352.017332c-2.942005-3.069919-4.956895-6.971785-5.676279-11.208273-0.207731-1.215688-22.193465-127.001509-36.551474-198.936865-0.799202-3.917216-4.285606-16.836457-16.196891-16.836457-3.453658 0-7.30743 1.006933-11.464099 2.942005-67.282383 31.179117-183.955662 88.180342-185.170327 88.771813-3.693112 1.790786-7.850805 2.558265-11.975752 2.01489-1.295506-0.224104-133.63765-16.165168-205.988468-23.424502-0.079818 0-0.207731 0-0.287549 0-7.30743 0-11.128455 2.89391-13.319353 5.40408-3.677762 4.124947-5.644557 9.91379-5.068436 15.110139 7.674796 72.623018 24.255427 202.934922 24.463158 204.325595 0.511653 4.109598-0.159636 8.266267-1.966795 11.960403-0.591471 1.215688-57.657164 120.04712-88.339977 187.201589-3.565199 7.754614-4.41352 14.214746-2.350534 18.131963 1.935072 3.725858 6.588045 5.820566 10.360975 6.53995 70.719668 13.718443 204.644867 36.519752 206.036563 36.727483 4.189416 0.671289 8.058536 2.686179 11.112082 5.580089 1.006933 0.87902 96.414887 91.281983 150.090367 139.889027 8.314363 7.563256 13.143345 8.106632 14.437827 8.106632 3.485381 0 8.314363-4.621251 12.727882-12.391215 36.343743-63.828724 100.011808-181.988868 100.636025-183.155437 1.983167-3.64604 5.004991-6.667863 8.650007-8.650007 1.134847-0.671289 114.418936-62.373583 178.6314-99.516528 8.698103-5.036713 14.278191-10.568706 14.94948-14.854313C834.681702 511.845481 831.49922 505.800811 825.375755 499.085876L825.375755 499.085876zM935.333076 935.670256c-4.157693 4.157693-9.689686 6.299473-15.141862 6.299473-5.548366 0-11.048637-2.142803-15.238053-6.299473l-171.915441-171.915441c-8.362458-8.394181-8.362458-21.98471 0-30.426987 8.394181-8.394181 21.98471-8.394181 30.379914 0l171.915441 171.915441C943.727257 913.684522 943.727257 927.275052 935.333076 935.670256L935.333076 935.670256z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>主题切换</div> </div> <div class="toolbar-item back-to-top" onclick=scrollToTop()> <div class=toolbar-icon> <svg class=back-to-top-icon viewbox="0 0 1024 1024" xmlns=http://www.w3.org/2000/svg> <path d="M882.688 624.128l-336.896-583.68c-15.872-27.136-54.784-27.136-70.656 0L138.24 624.128c-15.872 27.136 4.096 61.44 35.328 61.44H317.44c22.528 0 40.96 18.432 40.96 40.96v239.616c0 22.528 18.432 40.96 40.96 40.96h223.232c22.528 0 40.96-18.432 40.96-40.96v-239.616c0-22.528 18.432-40.96 40.96-40.96h143.872c30.208 0 50.176-34.304 34.304-61.44z"> </path> </svg> </div> <div class=toolbar-label>返回顶部</div> </div> </div> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../languages/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../data-structure-algo/index.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../index.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../front-end/index.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../MySQL/index.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../JavaEE/index.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../software-test/index.html class=md-tabs__link> 软件测试 </a> </li> <li class=md-tabs__item> <a href=../../other/index.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../tooltips/index.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../projects/index.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../languages/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../data-structure-algo/index.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> Linux </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../options-commands/options-commands.html class=md-nav__link> <span class=md-ellipsis> Linux常用选项和指令 </span> </a> </li> <li class=md-nav__item> <a href=../permission/permission.html class=md-nav__link> <span class=md-ellipsis> Linux权限相关 </span> </a> </li> <li class=md-nav__item> <a href=../software-installation/software-installation.html class=md-nav__link> <span class=md-ellipsis> CentOS软件安装 </span> </a> </li> <li class=md-nav__item> <a href=../gcc-gdb/gcc-gdb.html class=md-nav__link> <span class=md-ellipsis> Linux下的gcc与gdb </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Linux下的Makefile与进度条程序 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=makefile-progress-bar.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Linux下的Makefile与进度条程序 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#makefilemake class=md-nav__link> <span class=md-ellipsis> Makefile与make </span> </a> <nav class=md-nav aria-label=Makefile与make> <ul class=md-nav__list> <li class=md-nav__item> <a href=#makefilemake_1 class=md-nav__link> <span class=md-ellipsis> Makefile与make介绍 </span> </a> </li> <li class=md-nav__item> <a href=#makefilemake_2 class=md-nav__link> <span class=md-ellipsis> 创建第一个Makefile并使用make </span> </a> </li> <li class=md-nav__item> <a href=#makefile class=md-nav__link> <span class=md-ellipsis> Makefile文件基本格式介绍 </span> </a> </li> <li class=md-nav__item> <a href=#makefile_1 class=md-nav__link> <span class=md-ellipsis> Makefile依赖方法执行过程 </span> </a> </li> <li class=md-nav__item> <a href=#makefile_2 class=md-nav__link> <span class=md-ellipsis> Makefile通用写法 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 进度条程序 </span> </a> <nav class=md-nav aria-label=进度条程序> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 实现效果 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 前置知识 </span> </a> <nav class=md-nav aria-label=前置知识> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rn class=md-nav__link> <span class=md-ellipsis> 回车(\r)与换行(\n) </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 输出缓冲区 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 实现进度条 </span> </a> <nav class=md-nav aria-label=实现进度条> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 基础版本 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 改进版本 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 最终版本 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../os-basic/os-basic.html class=md-nav__link> <span class=md-ellipsis> 操作系统基础知识 </span> </a> </li> <li class=md-nav__item> <a href=../process-basic/process-basic.html class=md-nav__link> <span class=md-ellipsis> Linux进程基础 </span> </a> </li> <li class=md-nav__item> <a href=../process-state-priority/process-state-priority.html class=md-nav__link> <span class=md-ellipsis> Linux进程状态与进程优先级 </span> </a> </li> <li class=md-nav__item> <a href=../process-switch-scheduling/process-switch-scheduling.html class=md-nav__link> <span class=md-ellipsis> Linux进程切换以及调度算法 </span> </a> </li> <li class=md-nav__item> <a href=../command-line-env/command-line-env.html class=md-nav__link> <span class=md-ellipsis> Linux命令行与环境变量 </span> </a> </li> <li class=md-nav__item> <a href=../process-address-space/process-address-space.html class=md-nav__link> <span class=md-ellipsis> Linux进程地址空间 </span> </a> </li> <li class=md-nav__item> <a href=../process-control/process-control.html class=md-nav__link> <span class=md-ellipsis> Linux进程控制 </span> </a> </li> <li class=md-nav__item> <a href=../linux-fileop/linux-fileop.html class=md-nav__link> <span class=md-ellipsis> Linux文件操作基础 </span> </a> </li> <li class=md-nav__item> <a href=../io-process/io-process.html class=md-nav__link> <span class=md-ellipsis> Linux中输入和输出基本过程 </span> </a> </li> <li class=md-nav__item> <a href=../file-system/file-system.html class=md-nav__link> <span class=md-ellipsis> Linux文件系统 </span> </a> </li> <li class=md-nav__item> <a href=../soft-hard-link/soft-hard-link.html class=md-nav__link> <span class=md-ellipsis> Linux软链接和硬链接 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../com-process/com-anonymous-pipe/com-anonymous-pipe.html class=md-nav__link> <span class=md-ellipsis> Linux进程间通信 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../signals-os-principles/signals-os-principles.html class=md-nav__link> <span class=md-ellipsis> Linux信号与操作系统原理 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../linux-thread/thread-concept-op/thread-concept-op.html class=md-nav__link> <span class=md-ellipsis> Linux线程 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../net-basic/net-basic.html class=md-nav__link> <span class=md-ellipsis> 网络基础知识 </span> </a> </li> <li class=md-nav__item> <a href=../socket-basic/socket-basic.html class=md-nav__link> <span class=md-ellipsis> Socket编程基础 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../udp/udp-basic/udp-basic.html class=md-nav__link> <span class=md-ellipsis> UDP编程 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../tcp-basic/tcp-basic.html class=md-nav__link> <span class=md-ellipsis> TCP编程接口基本使用 </span> </a> </li> <li class=md-nav__item> <a href=../serialization-net-cal/serialization-net-cal.html class=md-nav__link> <span class=md-ellipsis> 序列化和反序列化与网络计算器 </span> </a> </li> <li class=md-nav__item> <a href=../process-relationship-daemon/process-relationship-daemon.html class=md-nav__link> <span class=md-ellipsis> 进程间关系和守护进程 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../http/http-basic-httpserver/http-basic-httpserver.html class=md-nav__link> <span class=md-ellipsis> 应用层协议HTTP </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class=md-nav__item> <a href=../udp-principles/udp-principles.html class=md-nav__link> <span class=md-ellipsis> UDP协议原理 </span> </a> </li> <li class=md-nav__item> <a href=../tcp-principles/tcp-principles.html class=md-nav__link> <span class=md-ellipsis> TCP协议原理 </span> </a> </li> <li class=md-nav__item> <a href=../tcp-connection-backlog/tcp-connection-backlog.html class=md-nav__link> <span class=md-ellipsis> 理解Linux如何看待连接以及TCP全连接队列 </span> </a> </li> <li class=md-nav__item> <a href=../ip/ip.html class=md-nav__link> <span class=md-ellipsis> 网络层IP协议 </span> </a> </li> <li class=md-nav__item> <a href=../datalink/datalink.html class=md-nav__link> <span class=md-ellipsis> 数据链路层协议 </span> </a> </li> <li class=md-nav__item> <a href=../dns-icmp/dns-icmp.html class=md-nav__link> <span class=md-ellipsis> DNS与ICMP </span> </a> </li> <li class=md-nav__item> <a href=../nat-proxy/nat-proxy.html class=md-nav__link> <span class=md-ellipsis> NAT技术、代理服务器和内网穿透 </span> </a> </li> <li class=md-nav__item> <a href=../io-model-select-poll/io-model-select-poll.html class=md-nav__link> <span class=md-ellipsis> 五种IO模型与select和poll分别实现多路转接 </span> </a> </li> <li class=md-nav__item> <a href=../epoll/epoll.html class=md-nav__link> <span class=md-ellipsis> epoll实现多路转接 </span> </a> </li> <li class=md-nav__item> <a href=../reactor-et/reactor-et.html class=md-nav__link> <span class=md-ellipsis> Reactor模式与完善基于边缘触发模式epoll实现TCP服务器 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../front-end/index.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../MySQL/index.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../JavaEE/index.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../software-test/index.html class=md-nav__link> <span class=md-ellipsis> 软件测试 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../other/index.html class=md-nav__link> <span class=md-ellipsis> 扩展知识 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tooltips/index.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../projects/index.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#makefilemake class=md-nav__link> <span class=md-ellipsis> Makefile与make </span> </a> <nav class=md-nav aria-label=Makefile与make> <ul class=md-nav__list> <li class=md-nav__item> <a href=#makefilemake_1 class=md-nav__link> <span class=md-ellipsis> Makefile与make介绍 </span> </a> </li> <li class=md-nav__item> <a href=#makefilemake_2 class=md-nav__link> <span class=md-ellipsis> 创建第一个Makefile并使用make </span> </a> </li> <li class=md-nav__item> <a href=#makefile class=md-nav__link> <span class=md-ellipsis> Makefile文件基本格式介绍 </span> </a> </li> <li class=md-nav__item> <a href=#makefile_1 class=md-nav__link> <span class=md-ellipsis> Makefile依赖方法执行过程 </span> </a> </li> <li class=md-nav__item> <a href=#makefile_2 class=md-nav__link> <span class=md-ellipsis> Makefile通用写法 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 进度条程序 </span> </a> <nav class=md-nav aria-label=进度条程序> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 实现效果 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 前置知识 </span> </a> <nav class=md-nav aria-label=前置知识> <ul class=md-nav__list> <li class=md-nav__item> <a href=#rn class=md-nav__link> <span class=md-ellipsis> 回车(\r)与换行(\n) </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 输出缓冲区 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 实现进度条 </span> </a> <nav class=md-nav aria-label=实现进度条> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 基础版本 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 改进版本 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 最终版本 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=linuxmakefile>Linux下的Makefile与进度条程序<a class=headerlink href=#linuxmakefile title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 3882 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 273 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 18 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 16 分钟</p> </div> <h2 id=makefilemake><code>Makefile</code>与<code>make</code><a class=headerlink href=#makefilemake title="Permanent link">&para;</a></h2> <h3 id=makefilemake_1><code>Makefile</code>与<code>make</code>介绍<a class=headerlink href=#makefilemake_1 title="Permanent link">&para;</a></h3> <p>在Linux中，<code>Makefile</code>是一个文件，<code>make</code>是一个指令，当使用<code>make</code>指令时，该指令会在当前目录下找<code>Makefile</code>文件从而执行内部的内容</p> <h3 id=makefilemake_2>创建第一个<code>Makefile</code>并使用<code>make</code><a class=headerlink href=#makefilemake_2 title="Permanent link">&para;</a></h3> <p>首先，在当前目录下创建一个<code>Makefile</code>文件（也可以写成<code>makefile</code>），例如：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image.png"></a></p> <p>接下来在同级目录下创建一个<code>code.c</code>文件</p> <p>使用vim编辑器输入下面的内容：</p> <div class="language-C highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-0-2>
</span><span id=__span-0-3><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-0-4><span class=p>{</span>
</span><span id=__span-0-5><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;hello linux</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-0-6><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-0-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>保存<code>code.c</code>文件后退出当前vim，使用vim打开<code>Makefile</code>文件，输入下面的内容：</p> <div class="language-makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-1-2><span class=w>    </span>gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.c
</span><span id=__span-1-3><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-1-4><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-1-5><span class=w>    </span>rm<span class=w> </span>-rf<span class=w> </span>code
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意，<code>gcc -o code code.c</code>和<code>rm -rf code</code>前方是一个Tab键的大小，而不是4个或者8个空格</p> </div> <p>保存<code>Makefile</code>文件后退出当前vim，在当前目录下输入<code>make</code>指令即可在当前目录下创建<code>code.c</code>对应的可执行文件（具有可执行权限并且文件本身可执行）<code>code</code>，例如下图：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image1.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image1.png"></a></p> <p>通过常规方式运行该可执行文件<code>./code</code>即可看到打印输出的内容：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image2.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image2.png"></a></p> <p>接着使用<code>make clean</code>指令清理刚才生成的可执行文件<code>code</code>：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image3.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image3.png"></a></p> <h3 id=makefile><code>Makefile</code>文件基本格式介绍<a class=headerlink href=#makefile title="Permanent link">&para;</a></h3> <p>以前面例子中的<code>Makefile</code>为例：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-2-2><span class=w>    </span>gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.c
</span><span id=__span-2-3><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-2-4><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-2-5><span class=w>    </span>rm<span class=w> </span>-rf<span class=w> </span>code
</span></code></pre></div></td></tr></table></div> <ul> <li>第一行中的<code>code:code.c</code>代表依赖关系，<code>code</code>表示目标文件，<code>code.c</code>表示依赖文件列表中的文件，第二行的<code>gcc -o code code.c</code>代表依赖方法（指令）</li> <li>第三行中的<code>.PHONY</code>表示生成一个伪目标，<code>clean</code>表示伪目标的名字（可以类比变量名）</li> <li>第四行及第五行与第一行及第二行含义一致，表示依赖关系和依赖方法，而因为<code>clean</code>没有需要依赖的文件，所以<code>clean:</code>后没有任何依赖文件列表文件</li> </ul> <div style="border-bottom:2px solid #cdcdcd;"></div> <p>依赖关系：表示两个文件之间构成的一定关系，比如父子关系</p> <p>依赖方法：通过依赖方法可以执行的对应的指令</p> <p>依赖文件列表：<code>code.c</code>所处的位置即为依赖文件列表，为了生成目标文件<code>code</code>而需要的文件称为依赖文件，依赖文件列表可以含有不止一个文件</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>注意：理论上来说，依赖文件列表中的<code>code.c</code>在当前情况下可以不写，但是如果不写，在第一次执行<code>make</code>指令后，不论之后<code>code.c</code>是否修改，再执行<code>make</code>指令都无法执行对应的依赖方法，因为<code>code</code>文件已经存在，所以为了保证可以修改，需要加上<code>code.c</code></p> </div> <p>从上面的运行结果可以看出，每一次执行make时都会在控制台回显出对应的依赖方法，如果将编译指令改为<code>echo "测试"</code>，则效果如下：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image4.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image4.png"></a></p> <p>可以看到先回显了对应的依赖方法，再执行依赖方法，如果不希望出现这种情况，可以在执行的指令前加上<code>@</code>使指令不再回显，所以上面的<code>Makefile</code>可以修改为：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-3-2><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;测试&quot;</span>
</span></code></pre></div></td></tr></table></div> <p>运行结果如下：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image5.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image5.png"></a></p> <p>所以原始的<code>Makefile</code>可以修改为：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-4-2><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;Start Compiling...&quot;</span>
</span><span id=__span-4-3><span class=w>    </span>@gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.c
</span><span id=__span-4-4><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;End Compiling...&quot;</span>
</span><span id=__span-4-5><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-4-6><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-4-7><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;Cleaning code...&quot;</span>
</span><span id=__span-4-8><span class=w>    </span>@rm<span class=w> </span>-rf<span class=w> </span>code
</span><span id=__span-4-9><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;End Cleaning...&quot;</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>一个依赖集中可以有多个依赖方法</p> </div> <p>此时正常运行结果如下：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image6.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image6.png"></a></p> <p>如果代码出现错误，则<code>gcc</code>会中断编译，所以此时运行结果如下：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image7.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image7.png"></a></p> <div style="border-bottom:2px solid #cdcdcd;"></div> <p>使用<code>.PHONY</code>可以生成一个指定名字的伪目标，伪目标的作用是：清除依赖方法执行时进行的文件时间对比，下面是具体介绍：</p> <p>首先，在Linux中可以使用<code>stat+文件名</code>查看文件当前的属性，对于<code>code.c</code>有：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image8.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image8.png"></a></p> <p>执行结果中，主要关注三个部分：<code>Access</code>、<code>Modify</code>和<code>Change</code>，这三个部分分别表示文件最近一次的访问时间、文件内容被修改的时间和文件属性被修改的时间</p> <ul> <li><code>Access</code>时间：一般不是特别精确，因为如果一个文件访问一次就需要更新一次访问时间，那么对于多个文件来说，这种操作的消耗对于CPU来说是很大的</li> <li><code>Modify</code>时间：<code>Modify</code>时间只表示文件内容被修改的时间，如果文件属性时间修改，则不影响<code>Modify</code>时间，但是需要注意，<code>Modify</code>时间一旦改变一般伴随着<code>Change</code>时间改变，因为修改文件内容有时会影响到文件的相关属性（例如文件大小等）</li> <li><code>Change</code>时间：<code>Change</code>时间只表示文件属性被修改的时间，修改文件属性时间不会影响<code>Modify</code>时间</li> </ul> <p>接着，观察对于没有添加伪目标的<code>Makefile</code>第一部分依赖集，如果<code>code</code>文件已经存在，再一次进行<code>make</code>的效果：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-5-2><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;Start Compiling...&quot;</span>
</span><span id=__span-5-3><span class=w>    </span>@gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.c
</span><span id=__span-5-4><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;End Compiling...&quot;</span>
</span></code></pre></div></td></tr></table></div> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image9.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image9.png"></a></p> <p>如果此时对<code>code.c</code>文件进行修改，那么执行结果会有所不同：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image10.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image10.png"></a></p> <p>那么指令是如何知道文件是否被修改呢？就是通过前面提到的<code>Modify</code>时间和<code>Change</code>时间，过程如下图所示：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image11.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image11.png"></a></p> <p>因为<code>code.c</code>创建的时间早于<code>code.c</code>编译的时间，所以开始时不存在<code>code</code>文件，所以第一次执行<code>make</code>指令时正常执行。</p> <p>当<code>code.c</code>文件未修改时，第二次执行<code>make</code>指令会发现<code>code.c</code>的<code>Modify</code>时间和<code>Change</code>时间依旧在<code>make</code>之前，因为第一次已经满足了<code>code.c</code>的两个时间在<code>code</code>文件的两个时间之前，所以<code>gcc</code>就不会再进行一次编译。</p> <p>当修改<code>code.c</code>文件后，<code>code.c</code>的<code>Modify</code>时间和<code>Change</code>时间改变，导致<code>code.c</code>的两个时间在<code>code</code>文件的两个时间之后，此时<code>gcc</code>就可以正常执行，从而<code>make</code>指令不受影响</p> <p>而如果再<code>Makefile</code>中为这一部分添加一个伪目标，则可以清除指令中文件时间的对比过程：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=nf>.PHONY</span><span class=o>:</span><span class=n>code</span>
</span><span id=__span-6-2><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-6-3><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;Start Compiling...&quot;</span>
</span><span id=__span-6-4><span class=w>    </span>@gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.c
</span><span id=__span-6-5><span class=w>    </span>@echo<span class=w> </span><span class=s2>&quot;End Compiling...&quot;</span>
</span></code></pre></div></td></tr></table></div> <p>此时无论执行多少次<code>make</code>指令，都不会出现<code>make</code>指令中<code>gcc</code>因为文件时间对比而导致执行结果不同：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image12.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image12.png"></a></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>make</code>指令虽然结果完全相同，但是不代表依赖方法没有执行，即文件确实每一次都重新编译</p> </div> <div style="border-bottom:2px solid #cdcdcd;"></div> <p>执行完编译部分的<code>make</code>指令，想要执行删除<code>code</code>文件对应的<code>make</code>指令需要在<code>make</code>后加上<code>clean</code>，这个<code>clean</code>代表伪目标名，之所以前面直接使用<code>make</code>就可以执行编译指令，是因为<code>make</code>指令在读取<code>Makefile</code>文件时是从上至下顺序查找，而直接使用<code>make</code>，就会执行第一个依赖集对应的依赖方法，执行完毕后就不会再继续往下读；而对于删除<code>code</code>文件的指令来说，其所在位置时<code>Makefile</code>中的第二个依赖集，所以需要告诉<code>make</code>指令找哪一部分</p> <p>所以，此处可以看出<code>.PHONY</code>的第二个作用就是声明一个伪目标，通过该伪目标帮助<code>make</code>指令快速定位需要执行的依赖集</p> <p>如果细心可以发现，对于<code>clean</code>依赖集来说，不论是否有<code>.PHONY</code>都可以无限制执行<code>rm -rf</code>依赖方法，所以可以推断出<code>rm -rf</code>指令本身不会考虑文件的时间属性，但是为什么此处还需要加<code>.PHONY</code>？一方面是为了声明伪目标，另一方面是为了当前依赖集中的其他指令会有时间对比</p> <h3 id=makefile_1><code>Makefile</code>依赖方法执行过程<a class=headerlink href=#makefile_1 title="Permanent link">&para;</a></h3> <p>前面学习到，当执行gcc -o code code.c实际上是分成了四步，即：</p> <ol> <li><code>code.c</code>文件编译生成<code>code.i</code>文件</li> <li><code>code.i</code>文件编译生成<code>code.s</code>文件</li> <li><code>code.s</code>文件编译生成<code>code.o</code>文件</li> <li><code>code.o</code>文件编译生成<code>code</code>可执行文件</li> </ol> <p>将对应的指令写入<code>Makefile</code>中，代码如下：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>o</span>
</span><span id=__span-7-2><span class=w>    </span>gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.o
</span><span id=__span-7-3><span class=nf>code.o</span><span class=o>:</span><span class=n>code</span>.<span class=n>s</span>
</span><span id=__span-7-4><span class=w>    </span>gcc<span class=w> </span>-c<span class=w> </span>code.s<span class=w> </span>-o<span class=w> </span>code.o
</span><span id=__span-7-5><span class=nf>code.s</span><span class=o>:</span><span class=n>code</span>.<span class=n>i</span>
</span><span id=__span-7-6><span class=w>    </span>gcc<span class=w> </span>-S<span class=w> </span>code.i<span class=w> </span>-o<span class=w> </span>code.s
</span><span id=__span-7-7><span class=nf>code.i</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-7-8><span class=w>    </span>gcc<span class=w> </span>-E<span class=w> </span>code.c<span class=w> </span>-o<span class=w> </span>code.i
</span><span id=__span-7-9>
</span><span id=__span-7-10><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-7-11><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-7-12><span class=w>    </span>@rm<span class=w> </span>-rf<span class=w> </span>code
</span></code></pre></div></td></tr></table></div> <p>根据<code>make</code>从上至下的运行顺序，首先执行<code>gcc -o code code.o</code>，但是，因为code.o不存在，并且<code>code.o</code>文件依赖于<code>code.s</code>文件，所以继续执行<code>code.o:code.s</code>对应的依赖方法，以此类推直到最后一条依赖方法<code>gcc -E code.c -o code.i</code>执行向上返回执行前面未执行的依赖方法。整个过程可以理解为在一个栈中操作：</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>假设此处执行的依赖方法同样进栈</p> </div> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image13.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image13.png"></a></p> <p>所以执行的结果如下图所示：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image14.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image14.png"></a></p> <p>实际上，在真正开发中，只需要用到两个部分，如下：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><span class=nf>code</span><span class=o>:</span><span class=n>code</span>.<span class=n>o</span>
</span><span id=__span-8-2><span class=w>    </span>gcc<span class=w> </span>-o<span class=w> </span>code<span class=w> </span>code.o
</span><span id=__span-8-3><span class=nf>code.o</span><span class=o>:</span><span class=n>code</span>.<span class=n>c</span>
</span><span id=__span-8-4><span class=w>    </span>gcc<span class=w> </span>-c<span class=w> </span>code.c<span class=w> </span>-o<span class=w> </span>code.o
</span></code></pre></div></td></tr></table></div> <p>此时运行结果如下：</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image15.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image15.png"></a></p> <h3 id=makefile_2><code>Makefile</code>通用写法<a class=headerlink href=#makefile_2 title="Permanent link">&para;</a></h3> <p>在前面的Makefile中，每一个依赖方法都需要在前面的依赖关系部分的文件重新写一遍，为了简化过程，可以使用下面的写法：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=nv>TARGET</span><span class=o>=</span>code
</span><span id=__span-9-2><span class=nv>SRC</span><span class=o>=</span>code.o
</span><span id=__span-9-3>
</span><span id=__span-9-4><span class=nf>$(TARGET)</span><span class=o>:</span><span class=k>$(</span><span class=nv>SRC</span><span class=k>)</span>
</span><span id=__span-9-5><span class=w>    </span><span class=k>$(</span>CC<span class=k>)</span><span class=w> </span>-o<span class=w> </span><span class=nv>$@</span><span class=w> </span>$&lt;
</span><span id=__span-9-6><span class=nf>%.o</span><span class=o>:</span>%.<span class=n>c</span>
</span><span id=__span-9-7><span class=w>    </span><span class=k>$(</span>CC<span class=k>)</span><span class=w> </span>-c<span class=w> </span>$&lt;<span class=w> </span>-o<span class=w> </span><span class=nv>$@</span>
</span><span id=__span-9-8>
</span><span id=__span-9-9><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-9-10><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-9-11><span class=w>    </span>@rm<span class=w> </span>-rf<span class=w> </span><span class=k>$(</span>TARGET<span class=k>)</span><span class=w> </span><span class=k>$(</span>SRC<span class=k>)</span>
</span></code></pre></div></td></tr></table></div> <p>上面的代码中，首先创建了两个变量分别代表生成的目标文件<code>code</code>以及第一个依赖集中的依赖文件列表中的文件，在依赖方法中使用了两个自动变量（一般建议大写），分别是<code>$@</code>和<code>$&lt;</code></p> <p>在<code>Makefile</code>中，<code>$@</code>表示生成的目标文件，<code>$&lt;</code>表示从依赖文件列表中取出一个文件，对应的还有<code>$^</code>表示依赖文件列表中的所有文件。如果想表示当前目录下的所有相同后缀的文件，可以使用<code>%</code>通配符，例如上面的<code>Makefile</code>中使用<code>%.c</code>代表匹配当前目录下所有后缀为<code>.c</code>的文件</p> <p>而对于<code>gcc</code>来说，在<code>Makefile</code>中可以使用内置变量<code>CC</code>（表示C编译器的名字）代替</p> <p>如果涉及到多个文件编译，则在<code>SRC</code>和<code>%.c</code>处使用空格分隔每一个文件</p> <p>但是，上面的Makefile并没有完全实现通用性，主要的问题还是「每一次创建新的文件就要修改<code>Makefile</code>文件」，如果文件比较多一个一个写也不利于添加，所以考虑结合变量以及指令让<code>Makefile</code>批量添加文件</p> <p>在Makefile中，可以使用shell命令，例如可以使用<code>ls *.c</code>表示展示当前目录下的<code>.c</code>后缀文件，如果结合变量，就是<code>SRC=$(shell ls *.c)</code>，这个做法也可以使用Makefile的内置函数<code>wildcard</code>实现，所以也可以写成<code>SRC=$(wildcard *.c)</code>。在这两个变量创建语法中，<code>$()</code>表示调用，也可以写成<code>${}</code>，二者没有区别</p> <p>所以上面的<code>Makefile</code>可以修改为：</p> <div class="language-makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><span class=nv>TARGET</span><span class=o>=</span>code
</span><span id=__span-10-2><span class=nv>SRC</span><span class=o>=</span><span class=k>$(</span>wildcard<span class=w> </span>*.o<span class=k>)</span>
</span><span id=__span-10-3>
</span><span id=__span-10-4><span class=nf>$(TARGET)</span><span class=o>:</span><span class=k>$(</span><span class=nv>SRC</span><span class=k>)</span>
</span><span id=__span-10-5><span class=w>    </span><span class=k>$(</span>CC<span class=k>)</span><span class=w> </span>-o<span class=w> </span><span class=nv>$@</span><span class=w> </span>$&lt;
</span><span id=__span-10-6><span class=nf>%.o</span><span class=o>:</span>%.<span class=n>c</span>
</span><span id=__span-10-7><span class=w>    </span><span class=k>$(</span>CC<span class=k>)</span><span class=w> </span>-c<span class=w> </span>$&lt;<span class=w> </span>-o<span class=w> </span><span class=nv>$@</span>
</span><span id=__span-10-8>
</span><span id=__span-10-9><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-10-10><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-10-11><span class=w>    </span>@rm<span class=w> </span>-rf<span class=w> </span><span class=k>$(</span>TARGET<span class=k>)</span><span class=w> </span><span class=k>$(</span>SRC<span class=k>)</span>
</span></code></pre></div></td></tr></table></div> <p>如果想对文件名中的指定内容进行简单的替换，也可以结合变量和<code>$()</code>，语法为：<code>变量名=$(原始内容=替换内容)</code>，例如将当前目录下所有的<code>.c</code>文件替换为<code>.o</code>文件，就可以写成：</p> <div class="language-Makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1><span class=nv>SRC</span><span class=o>=</span><span class=k>$(</span>wildcard<span class=w> </span>*.c<span class=k>)</span>
</span><span id=__span-11-2><span class=c># 替换</span>
</span><span id=__span-11-3><span class=nv>OBJ</span><span class=o>=</span><span class=k>$(</span>SRC:.c<span class=o>=</span>.o<span class=k>)</span>
</span></code></pre></div></td></tr></table></div> <p>此处用到的<code>$(SRC:.c=.o)</code>表示引用或计算变量<code>SRC</code>的值，并将结果中的<code>.c</code>替换为<code>.o</code></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>上面的替换规则不会改变原始文件中的内容，也就是说，在上面的例子中，<code>.c</code>文件的内容不会真正被替换为使用编译器生成的<code>.o</code>的文件内容</p> </div> <div style="border-bottom:2px solid #cdcdcd;"></div> <p>至此，一个基本的<code>Makefile</code>文件编写语法就这么多，如果需要更详细了解<code>Makefile</code>文件，请移步至此-&gt;<a href=https://liaoxuefeng.com/books/makefile/introduction/index.html>Makefile教程</a></p> <h2 id=_1>进度条程序<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <h3 id=_2>实现效果<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image.gif" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image.gif"></a></p> <h3 id=_3>前置知识<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <h4 id=rn>回车(<code>\r</code>)与换行(<code>\n</code>)<a class=headerlink href=#rn title="Permanent link">&para;</a></h4> <p>在C语言或者其他高级语言中，换行(<code>\n</code>)表示回到下一行的开始处，实际上换行的效果并不如此</p> <p>回车（<code>\r</code>）：回到当前光标所在行的开始</p> <p>换行（<code>\n</code>）：前往光标所在行的下一行，但是光标是平行向下移动</p> <p><a class=glightbox href="5. Linux下的Makefile与进度条程序.assets\image16.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="5. Linux下的Makefile与进度条程序.assets\image16.png"></a></p> <h4 id=_4>输出缓冲区<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <p>观察下面程序运行的结果：</p> <div class="language-C highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-12-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span>
</span><span id=__span-12-3>
</span><span id=__span-12-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-12-5><span class=p>{</span>
</span><span id=__span-12-6><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;hello linux</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-12-7><span class=w>    </span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-12-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-12-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>如果在Linux终端运行该程序，可以看到程序先打印了<code>hello linux</code>，然后等待了2秒才显示<code>prompt</code>提示</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>这里的<code>sleep</code>函数不是Windows下的<code>Sleep</code>函数，但是效果基本一致</p> </div> <p>将上面的程序修改为下面的程序，再观察效果：</p> <div class="language-C highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-13-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span>
</span><span id=__span-13-3>
</span><span id=__span-13-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-13-5><span class=p>{</span>
</span><span id=__span-13-6><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;hello linux&quot;</span><span class=p>);</span>
</span><span id=__span-13-7><span class=w>    </span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-13-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-13-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>可以看到程序先等待了2秒，然后才打印<code>hello linux</code></p> <p>C语言程序默认从上往下顺序执行代码，所以不可能是先执行了<code>sleep(2)</code>才执行<code>printf("hello linux");</code>，出现这种现象的原因就是因为缓冲区的存在，程序在输出时并不会直接将内容输出到显示器上，而是先输出到输出缓冲区，再通过刷新/结束缓冲区将内容打印到屏幕上，而之所以在有<code>\n</code>时会显示再等待就是因为<code>\n</code>刷新了缓冲区，导致内容打印到了屏幕上</p> <p>如果使用将<code>\n</code>替换为<code>\r</code>则同样会先等待再打印，因为<code>\r</code>也不具备刷新缓冲区的效果，如果在当前情况下想刷新缓冲区但又不想使用<code>\n</code>，则可以使用<code>fflush()</code>函数，传递参数为标准输出<code>stdout</code>，代码如下：</p> <div class="language-C highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-14-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span>
</span><span id=__span-14-3>
</span><span id=__span-14-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-14-5><span class=p>{</span>
</span><span id=__span-14-6><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;hello linux&quot;</span><span class=p>);</span>
</span><span id=__span-14-7><span class=w>    </span><span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span><span id=__span-14-8><span class=w>    </span><span class=n>sleep</span><span class=p>(</span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-14-9><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-14-10><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_5>实现进度条<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <h4 id=_6>基础版本<a class=headerlink href=#_6 title="Permanent link">&para;</a></h4> <p>思路：首先创建3个文件，分别是测试文件<code>main.c</code>、头文件<code>process.h</code>和实现文件<code>process.c</code>。对于进度条，实际上就是先打印原数组内容，再填充数组然后刷新缓冲区，对于百分比，只需要使用循环变量控制即可，对于最右侧闪烁的符号，实际上就是四个动画帧符号，每一次循环加载一个动画帧即可，但是为了循环加载，需要使下标在指定范围内循环，可以考虑循环队列（数组版）下标轮回的思路，所以基本代码如下：</p> <div class="language-c highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=c1>// 实现文件</span>
</span><span id=__span-15-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;process.h&quot;</span>
</span><span id=__span-15-3>
</span><span id=__span-15-4><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>()</span>
</span><span id=__span-15-5><span class=p>{</span>
</span><span id=__span-15-6><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>bar</span><span class=p>[</span><span class=n>NUM</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span><span class=c1>// 进度条数组</span>
</span><span id=__span-15-7><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-15-8><span class=w>    </span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>label</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;|/-</span><span class=se>\\</span><span class=s>&quot;</span><span class=p>;</span><span class=c1>//控制进度条最右侧的闪烁符号（| 顺时针旋转）</span>
</span><span id=__span-15-9><span class=w>    </span><span class=kt>size_t</span><span class=w> </span><span class=n>len</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>strlen</span><span class=p>(</span><span class=n>label</span><span class=p>);</span>
</span><span id=__span-15-10><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=n>count</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-15-11><span class=w>    </span><span class=p>{</span>
</span><span id=__span-15-12><span class=w>        </span><span class=c1>// [%-100s]预留100个字符的位置，每一次打印数组bar中的字符，因为初始化为0，所以数组中全是&#39;\0&#39;，当遇到第一个&#39;\0&#39;就停止，加上-表示从右往左（默认从左往右）打印</span>
</span><span id=__span-15-13><span class=w>        </span><span class=c1>// 使用count控制进度条百分比，百分号%需要额外转义</span>
</span><span id=__span-15-14><span class=w>        </span><span class=c1>// label闪烁符号，使用count%4使下标循环在0-3，思路可以联想循环队列数组版控制下标轮回的方式</span>
</span><span id=__span-15-15><span class=w>        </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;[%-100s][%d%%][%c]</span><span class=se>\r</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>bar</span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>,</span><span class=w> </span><span class=n>label</span><span class=p>[</span><span class=n>count</span><span class=o>%</span><span class=n>len</span><span class=p>]);</span>
</span><span id=__span-15-16><span class=w>        </span><span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span><span class=w> </span><span class=c1>// 先刷新缓冲区，打印出停留在缓冲区的内容</span>
</span><span id=__span-15-17><span class=w>        </span><span class=n>bar</span><span class=p>[</span><span class=n>count</span><span class=o>++</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>STYLE</span><span class=p>;</span><span class=w> </span><span class=c1>// 向数组中添加字符</span>
</span><span id=__span-15-18><span class=w>        </span><span class=n>usleep</span><span class=p>(</span><span class=mi>20000</span><span class=p>);</span><span class=c1>// 睡眠时间单位为微秒，1秒 = 6000毫秒=60000000微秒</span>
</span><span id=__span-15-19><span class=w>    </span><span class=p>}</span>
</span><span id=__span-15-20><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-15-21><span class=p>}</span>
</span><span id=__span-15-22>
</span><span id=__span-15-23><span class=c1>// 头文件</span>
</span><span id=__span-15-24><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span>
</span><span id=__span-15-25><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span>
</span><span id=__span-15-26><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;string.h&gt;</span>
</span><span id=__span-15-27>
</span><span id=__span-15-28><span class=cp>#define NUM 101 </span><span class=c1>// 定义进度条字符的个数</span>
</span><span id=__span-15-29><span class=cp>#define STYLE &#39;#&#39; </span><span class=c1>// 定义进度条的样式</span>
</span><span id=__span-15-30>
</span><span id=__span-15-31><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>();</span>
</span><span id=__span-15-32>
</span><span id=__span-15-33><span class=c1>// 测试文件</span>
</span><span id=__span-15-34><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;process.h&quot;</span>
</span><span id=__span-15-35>
</span><span id=__span-15-36><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-15-37><span class=p>{</span>
</span><span id=__span-15-38><span class=w>    </span><span class=n>process</span><span class=p>();</span>
</span><span id=__span-15-39><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-15-40><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>对应的<code>Makefile</code>如下：</p> <div class="language-makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1><span class=nv>TARGET</span><span class=o>=</span>process
</span><span id=__span-16-2><span class=nv>SRC</span><span class=o>=</span>process.c<span class=w> </span>main.c
</span><span id=__span-16-3>
</span><span id=__span-16-4><span class=nf>$(TARGET)</span><span class=o>:</span><span class=k>$(</span><span class=nv>SRC</span><span class=k>)</span>
</span><span id=__span-16-5><span class=w>    </span><span class=k>$(</span>CC<span class=k>)</span><span class=w> </span>$^<span class=w> </span>-o<span class=w> </span><span class=nv>$@</span>
</span><span id=__span-16-6>
</span><span id=__span-16-7><span class=nf>.PHONY</span><span class=o>:</span><span class=n>clean</span>
</span><span id=__span-16-8><span class=nf>clean</span><span class=o>:</span>
</span><span id=__span-16-9><span class=w>    </span>rm<span class=w> </span>-rf<span class=w> </span><span class=k>$(</span>TARGET<span class=k>)</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_7>改进版本<a class=headerlink href=#_7 title="Permanent link">&para;</a></h4> <p>前面的进度条只是根据100进行依次填充，并没有达到进度条的实用性「根据下载进度更新进度条」，所以可以通过下面的思路对上面的代码进行优化：</p> <p>首先，定义一个函数<code>download</code>，该函数用于定义下载任务</p> <p>假设需要下载的文件<code>FILE</code>大小为2048MB，定义一个带宽<code>BASE</code>为1MB，为了模拟出网络波动，可以使用<code>(rand()%BASE+1)/10</code>计算出增量，用增量乘以<code>BASE</code>计算出下载速度<code>speed</code>，但是需要注意，因为<code>rand()%BASE+1</code>计算出的值为整数，整数除以10依旧为整数，所以此时值只会为0，为了解决这个问题可以将<code>rand()%BASE+1</code>强转为<code>double</code>再除法运算</p> <p>定义两个变量分别为<code>current</code>和<code>total</code>，分别代表当前下载量和总下载量，因为需要根据百分比显示更新进度条，所以这两个变量需要使用<code>double</code>类型定义，百分比计算公式：<code>current / total * 100</code></p> <p>模拟下载效果可以使用一个循环，循环体内使<code>current</code>不断根据速<code>speed</code>进行更新，但是这里可能最后计算出的<code>current</code>不一定刚好等于<code>double</code>，为了防止出现进度条计算出的百分比大于1，可以使用一个矫正「当<code>current</code>大于等于<code>total</code>时，就将<code>total</code>赋值给<code>current</code>」，当<code>current</code>大于或等于<code>total</code>时结束循环</p> <p>前面的进度条只是单纯根据100进行填充，所以需要使用循环。但是此处更新进度条不可以再使用循环，否则会出现「更新一次<code>current</code>，进度条就跑满一次的问题」，正确的思路是「更新一次<code>current</code>，进度条更新一次」</p> <p>进度条的设计分成两部分：</p> <ol> <li>进度条填充图案及动画</li> <li>进度条加载图案及动画（这个不是必须的，但是如果出现进度条卡住等问题，该图案可以用于辨别是系统卡住还是下载卡住）</li> </ol> <p>对于「进度条填充图案及动画」来说，主要思路是根据下载百分比更新进度条，所以可以使用变量<code>rate</code>存储百分比，根据该百分比进行数组图案循环填充，但是需要注意，因为百分比为<code>double</code>类型，存在精度损失问题，所以在作为循环结束条件比较运算符的右操作数时需要强转为<code>int</code>，同样的思路打印进度条填充图案及显示动画即可</p> <p>对于「进度条加载图案及动画」来说，这里使用<code>.</code>作为加载图案，重点考虑如何实现依次打印「.」「..」「...」「....」「.....」「......」并循环往复。每一次调用进度条可以考虑更新一次符号，和填充图案类似，但是需要每一次更新指定数量的<code>.</code>，可以定义一个静态变量，每一次调用更新一次，但是必须确保不超过设计的数量，这里假设数量<code>PNUM</code>为6，即一共6个<code>.</code>，在循环中根据<code>PNUM</code>进行循环，如果i小于<code>num</code>，就打印<code>.</code>（通过<code>num</code>控制<code>.</code>的个数），否则打印空格进行占位，使用打印进度条的思路打印加载动画即可</p> <p>最后，可以考虑使用一个<code>count</code>变量降低加载动画的速度</p> <p>示例代码：</p> <div class="language-c highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1><span class=c1>// 头文件</span>
</span><span id=__span-17-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;unistd.h&gt;</span>
</span><span id=__span-17-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;string.h&gt;</span>
</span><span id=__span-17-4><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;time.h&gt;</span>
</span><span id=__span-17-5><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdlib.h&gt;</span>
</span><span id=__span-17-6>
</span><span id=__span-17-7><span class=cp>#define NUM 101 </span><span class=c1>// 定义进度条字符的个数</span>
</span><span id=__span-17-8><span class=cp>#define STYLE &#39;#&#39; </span><span class=c1>// 定义进度条的样式</span>
</span><span id=__span-17-9>
</span><span id=__span-17-10><span class=cp>#define FILE 2048.0</span>
</span><span id=__span-17-11><span class=cp>#define BASE 1</span>
</span><span id=__span-17-12><span class=cp>#define LOAD &#39;.&#39;</span>
</span><span id=__span-17-13><span class=cp>#define PNUM 6</span>
</span><span id=__span-17-14>
</span><span id=__span-17-15><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</span><span id=__span-17-16><span class=kt>void</span><span class=w> </span><span class=nf>download</span><span class=p>(</span><span class=n>pro</span><span class=w> </span><span class=n>proc</span><span class=p>);</span>
</span><span id=__span-17-17>
</span><span id=__span-17-18><span class=c1>// 实现文件</span>
</span><span id=__span-17-19><span class=w> </span><span class=n>download</span><span class=p>()</span>
</span><span id=__span-17-20><span class=p>{</span>
</span><span id=__span-17-21><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>speed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BASE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(((</span><span class=kt>double</span><span class=p>)(</span><span class=n>rand</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>BASE</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>10</span><span class=p>);</span>
</span><span id=__span-17-22><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-17-23><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>FILE</span><span class=p>;</span>
</span><span id=__span-17-24><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-17-25><span class=w>    </span><span class=p>{</span>
</span><span id=__span-17-26><span class=w>        </span><span class=n>current</span><span class=o>+=</span><span class=n>speed</span><span class=p>;</span>
</span><span id=__span-17-27><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-28><span class=w>            </span><span class=n>current</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>total</span><span class=p>;</span>
</span><span id=__span-17-29><span class=w>        </span><span class=p>}</span>
</span><span id=__span-17-30><span class=w>        </span><span class=n>process</span><span class=p>(</span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</span><span id=__span-17-31><span class=w>        </span><span class=n>usleep</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span><span id=__span-17-32><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-33><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-17-34><span class=p>}</span>
</span><span id=__span-17-35>
</span><span id=__span-17-36><span class=c1>// Version 2：根据下载百分比更新进度条</span>
</span><span id=__span-17-37><span class=kt>void</span><span class=w> </span><span class=n>process</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=p>)</span>
</span><span id=__span-17-38><span class=p>{</span>
</span><span id=__span-17-39><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>bar</span><span class=p>[</span><span class=n>NUM</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span><span id=__span-17-40><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
</span><span id=__span-17-41><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=n>rate</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-42><span class=w>        </span><span class=n>bar</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>STYLE</span><span class=p>;</span>
</span><span id=__span-17-43><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-44>
</span><span id=__span-17-45><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>points</span><span class=p>[</span><span class=n>PNUM</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span><span id=__span-17-46><span class=w>    </span><span class=k>static</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-17-47><span class=w>    </span><span class=n>count</span><span class=o>++</span><span class=p>;</span>
</span><span id=__span-17-48><span class=w>    </span><span class=k>if</span><span class=p>(</span><span class=n>count</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-49><span class=w>        </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-17-50><span class=w>        </span><span class=k>static</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-17-51><span class=w>        </span><span class=n>num</span><span class=o>++</span><span class=p>;</span>
</span><span id=__span-17-52><span class=w>        </span><span class=n>num</span><span class=w> </span><span class=o>%=</span><span class=w> </span><span class=n>PNUM</span><span class=p>;</span>
</span><span id=__span-17-53><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>PNUM</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-54><span class=w>            </span><span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-55><span class=w>                </span><span class=n>points</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LOAD</span><span class=p>;</span><span class=w> </span><span class=c1>// 根据num填充符号</span>
</span><span id=__span-17-56><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-57><span class=w>                </span><span class=n>points</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39; &#39;</span><span class=p>;</span><span class=w> </span><span class=c1>// 剩余按照空格填充</span>
</span><span id=__span-17-58><span class=w>            </span><span class=p>}</span>
</span><span id=__span-17-59><span class=w>        </span><span class=p>}</span><span class=w>    </span>
</span><span id=__span-17-60><span class=w>    </span><span class=p>}</span>
</span><span id=__span-17-61><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;[%-100s][%.1lf%%]%s</span><span class=se>\r</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>bar</span><span class=p>,</span><span class=w> </span><span class=n>rate</span><span class=p>,</span><span class=w> </span><span class=n>points</span><span class=p>);</span>
</span><span id=__span-17-62><span class=w>    </span><span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span><span id=__span-17-63><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_8>最终版本<a class=headerlink href=#_8 title="Permanent link">&para;</a></h4> <p>为了使下载函数更加具有通用性，可以使用函数指针，将进度条的函数声明使用<code>typedef</code>声明为<code>pro</code>，使用该函数指针在下载函数形参位置声明一个变量，在下载函数内部使用形参调用对应形参指向的进度条函数，之后如果有多个进度条代码，只要进度条代码的函数声明于形参函数指针执行的函数类型相同，就可以更换为其他的进度条代码执行</p> <div class="language-c highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1><span class=c1>//头文件</span>
</span><span id=__span-18-2><span class=c1>// ...</span>
</span><span id=__span-18-3><span class=k>typedef</span><span class=w> </span><span class=kt>void</span><span class=p>(</span><span class=o>*</span><span class=n>pro</span><span class=p>)(</span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</span><span id=__span-18-4><span class=c1>// ...</span>
</span><span id=__span-18-5>
</span><span id=__span-18-6><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</span><span id=__span-18-7><span class=kt>void</span><span class=w> </span><span class=nf>download</span><span class=p>(</span><span class=n>pro</span><span class=w> </span><span class=n>proc</span><span class=p>);</span>
</span><span id=__span-18-8>
</span><span id=__span-18-9><span class=c1>// 实现文件</span>
</span><span id=__span-18-10><span class=kt>void</span><span class=w> </span><span class=nf>download</span><span class=p>(</span><span class=n>pro</span><span class=w> </span><span class=n>proc</span><span class=p>)</span>
</span><span id=__span-18-11><span class=p>{</span>
</span><span id=__span-18-12><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>speed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>BASE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=p>(((</span><span class=kt>double</span><span class=p>)(</span><span class=n>rand</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=n>BASE</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>))</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>10</span><span class=p>);</span>
</span><span id=__span-18-13><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.0</span><span class=p>;</span>
</span><span id=__span-18-14><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>FILE</span><span class=p>;</span>
</span><span id=__span-18-15><span class=w>    </span><span class=k>while</span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-18-16><span class=w>    </span><span class=p>{</span>
</span><span id=__span-18-17>
</span><span id=__span-18-18><span class=w>        </span><span class=n>current</span><span class=o>+=</span><span class=n>speed</span><span class=p>;</span>
</span><span id=__span-18-19><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-20><span class=w>            </span><span class=n>current</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>total</span><span class=p>;</span>
</span><span id=__span-18-21><span class=w>        </span><span class=p>}</span>
</span><span id=__span-18-22><span class=w>        </span><span class=n>proc</span><span class=p>(</span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=n>total</span><span class=p>);</span>
</span><span id=__span-18-23><span class=w>        </span><span class=n>usleep</span><span class=p>(</span><span class=mi>1000</span><span class=p>);</span>
</span><span id=__span-18-24><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-25><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-18-26><span class=p>}</span>
</span><span id=__span-18-27>
</span><span id=__span-18-28><span class=c1>// Version 2：根据下载百分比更新进度条</span>
</span><span id=__span-18-29><span class=kt>void</span><span class=w> </span><span class=nf>process</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>current</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=p>)</span>
</span><span id=__span-18-30><span class=p>{</span>
</span><span id=__span-18-31><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>bar</span><span class=p>[</span><span class=n>NUM</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span><span id=__span-18-32><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>current</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>total</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span><span class=p>;</span>
</span><span id=__span-18-33><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=n>rate</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-34><span class=w>        </span><span class=n>bar</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>STYLE</span><span class=p>;</span>
</span><span id=__span-18-35><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-36>
</span><span id=__span-18-37><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>points</span><span class=p>[</span><span class=n>PNUM</span><span class=o>+</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=mi>0</span><span class=p>};</span>
</span><span id=__span-18-38><span class=w>    </span><span class=k>static</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-18-39><span class=w>    </span><span class=n>count</span><span class=o>++</span><span class=p>;</span>
</span><span id=__span-18-40><span class=w>    </span><span class=k>if</span><span class=p>(</span><span class=n>count</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-41><span class=w>        </span><span class=n>count</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-18-42><span class=w>        </span><span class=k>static</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-18-43><span class=w>        </span><span class=n>num</span><span class=o>++</span><span class=p>;</span>
</span><span id=__span-18-44><span class=w>        </span><span class=n>num</span><span class=w> </span><span class=o>%=</span><span class=w> </span><span class=n>PNUM</span><span class=p>;</span>
</span><span id=__span-18-45><span class=w>        </span><span class=k>for</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>PNUM</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-46><span class=w>            </span><span class=k>if</span><span class=p>(</span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-47><span class=w>                </span><span class=n>points</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LOAD</span><span class=p>;</span><span class=w> </span><span class=c1>// 根据num填充符号</span>
</span><span id=__span-18-48><span class=w>            </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-18-49><span class=w>                </span><span class=n>points</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39; &#39;</span><span class=p>;</span><span class=w> </span><span class=c1>// 剩余按照空格填充</span>
</span><span id=__span-18-50><span class=w>            </span><span class=p>}</span>
</span><span id=__span-18-51><span class=w>        </span><span class=p>}</span><span class=w>    </span>
</span><span id=__span-18-52><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-53><span class=w>    </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;[%-100s][%.1lf%%]%s</span><span class=se>\r</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>bar</span><span class=p>,</span><span class=w> </span><span class=n>rate</span><span class=p>,</span><span class=w> </span><span class=n>points</span><span class=p>);</span>
</span><span id=__span-18-54><span class=w>    </span><span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>);</span>
</span><span id=__span-18-55><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年2月8日</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> 页面有帮助吗？ </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title=页面对我有帮助 data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title=页面没有帮助到我 data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> 谢谢你的反馈！ </div> <div data-md-value=0 hidden> 谢谢你的反馈！联系<a href=https://www.help-doc.top/author/contact/contact.html>作者</a>提供更详细的信息 </div> </div> </div> </fieldset> </form> <!-- Waline 评论系统 --> <div id=waline></div> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../javascripts/katex.min.js></script> <script src=../../javascripts/other.min.js></script> <script src=../../javascripts/copyright.min.js></script> <script src=../../javascripts/waline.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script src=../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>