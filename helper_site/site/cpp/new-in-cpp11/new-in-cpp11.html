<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/cpp/new-in-cpp11/new-in-cpp11.html><link rel=prev href=../initializer-list/initializer-list.html><link rel=next href=../exception/exception.html><link rel=icon href=../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>C++ 11相关新特性 - 柯懒的知识库</title><link rel=stylesheet href=../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../css/timeline.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-9XWRGNRRSY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-9XWRGNRRSY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-9XWRGNRRSY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link rel=stylesheet href=../../stylesheets/colors.min.css><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)" id=theme2-desktop><link rel=stylesheet href=../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)" id=theme1-desktop><link rel=stylesheet href=../../stylesheets/print.min.css><link rel=stylesheet href=../../stylesheets/font-dongguanti.min.css id=font-dongguanti><link rel=stylesheet href=../../stylesheets/font-oppoti.min.css id=font-oppoti disabled><link rel=stylesheet href=../../stylesheets/font-jiangchengti.min.css id=font-jiangchengti disabled><link rel=stylesheet href=../../stylesheets/font-lxgw.min.css id=font-lxgw disabled><link rel=stylesheet href=../../stylesheets/code-font-dejavu-sans-mono.min.css id=code-font-dejavu-sans-mono><link rel=stylesheet href=../../stylesheets/code-font-zsft-hk.min.css id=code-font-zsft-hk disabled><link rel=stylesheet href=../../stylesheets/code-font-google-sans-code.min.css id=code-font-google-sans-code disabled><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css><link rel=stylesheet href=../../stylesheets/waline.min.css><script src=../../javascripts/start.min.js></script><link rel=preload href=../../stylesheets/colors.min.css as=style><link rel=preload href=../../stylesheets/theme2.min.css as=style><link rel=preload href=../../javascripts/start.min.js as=script><link rel=preload href=../../assets/logo.png as=image><link rel=preload href=../../images/favicon.png as=image><link rel=preload href=../../author/作者.assets/20250206-200653.jpg as=image><link rel=dns-prefetch href=//unpkg.com><link rel=dns-prefetch href=//cloud.umami.is><script defer src=https://cloud.umami.is/script.js data-website-id=02f9b8b7-93d4-4026-bdd8-221f2fcea2cf></script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#c-11 class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> C++ 11相关新特性 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <div class=header-avatar> <img src=../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../author/contact/contact.html class=avatar-dropdown-item>联系作者</a> <div class=avatar-dropdown-divider></div> <a href=../../author/about/about.html class=avatar-dropdown-item>关于作者</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>Github仓库</a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=toolbar-toggle-btn id=toolbarToggleBtn onclick=toggleToolbar()> <div class=toggle-icon> <svg class=toggle-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=16 height=16> <path d="M346.538667 1024L170.666667 853.333333l341.333333-341.333333-341.333333-341.333333 175.872-170.666667L853.333333 512z" fill=currentColor></path> </svg> </div> </div> <div class=floating-toolbar id=floatingToolbar> <div class="toolbar-item font-switcher"> <div class=toolbar-icon> <svg class=font-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M913.408 1024l-66.56 0q-29.696 0-51.2-5.12t-36.864-15.872-26.112-27.136-19.968-37.888q-15.36-38.912-28.16-70.656t-22.016-55.296q-11.264-26.624-20.48-49.152l-254.976 0q-7.168 23.552-17.408 51.2-8.192 23.552-21.504 56.832t-30.72 72.192q-20.48 46.08-47.104 63.488t-60.416 17.408l-70.656 0q-45.056 0-60.928-19.968t2.56-68.096q18.432-46.08 43.008-108.544t52.224-132.608 57.344-143.872 57.344-144.384q65.536-164.864 137.216-343.04 7.168-17.408 18.432-31.744 10.24-11.264 27.136-21.504t42.496-10.24q26.624 0 43.52 10.752t28.16 24.064q12.288 15.36 19.456 33.792 72.704 180.224 138.24 345.088 27.648 70.656 57.344 143.872t56.832 142.336 51.2 129.536 41.472 104.448q14.336 34.816 4.096 62.464t-43.008 27.648zM616.448 634.88l-97.28-347.136-1.024 0-108.544 347.136 206.848 0z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>内容字体</div> <div class=font-dropdown-toolbar> <div class=font-current-toolbar onclick=toggleFontDropdownToolbar()> <span class=current-font-name-toolbar>东观体</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=font-options-toolbar> <div class=font-option-toolbar data-font=dongguanti onclick="selectFontToolbar('dongguanti')">上图东观体 </div> <div class=font-option-toolbar data-font=oppoti onclick="selectFontToolbar('oppoti')">OPPO Sans </div> <div class=font-option-toolbar data-font=jiangchengti onclick="selectFontToolbar('jiangchengti')"> 江城黑体</div> <div class=font-option-toolbar data-font=lxgw onclick="selectFontToolbar('lxgw')">霞鹜臻楷</div> </div> </div> </div> <div class="toolbar-item code-font-switcher"> <div class=toolbar-icon> <svg t=1753672111433 class="icon code-font-icon" viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=5148 width=20 height=20> <path d="M941.709938 0H82.290062A82.290062 82.290062 0 0 0 0 82.290062v859.419876A82.290062 82.290062 0 0 0 82.290062 1022.53923h859.419876A82.290062 82.290062 0 0 0 1022.53923 941.709938V82.290062A82.290062 82.290062 0 0 0 941.709938 0zM188.439372 553.631954a40.901569 40.901569 0 0 1-29.215406-70.116975L292.154066 351.558726 159.223966 218.628626a40.901569 40.901569 0 0 1 58.430813-57.94389l160.197813 162.145507a40.901569 40.901569 0 0 1 0 57.943889l-160.197813 160.684736a40.901569 40.901569 0 0 1-29.215407 12.173086z m443.587257 0H405.120304a40.901569 40.901569 0 0 1 0-82.290061H633.000476a40.901569 40.901569 0 0 1 0 82.290061z" fill=currentColor p-id=5149></path> </svg> </div> <div class=toolbar-label>代码字体</div> <div class=code-font-dropdown-toolbar> <div class=code-font-current-toolbar onclick=toggleCodeFontDropdownToolbar()> <span class=current-code-font-name-toolbar>DejaVu Sans Mono</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=code-font-options-toolbar> <div class=code-font-option-toolbar data-code-font=dejavu onclick="selectCodeFontToolbar('dejavu')"> DejaVu Sans Mono</div> <div class=code-font-option-toolbar data-code-font=google-sans-code onclick="selectCodeFontToolbar('google-sans-code')"> Google Sans Code</div> <div class=code-font-option-toolbar data-code-font=zsft onclick="selectCodeFontToolbar('zsft')"> JetBrains Mono</div> </div> </div> </div> <div class="toolbar-item theme-switcher" onclick=switchTheme()> <div class=toolbar-icon> <svg class=theme-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M876.572788 522.301623c-1.886977 12.375865-9.657964 30.331819-35.880185 45.48903-56.489572 32.697703-150.21828 83.990926-174.010149 96.958262-13.143345 24.431435-66.067718 122.221646-98.141204 178.503487-16.117073 28.124548-36.055171 34.041304-50.030463 34.041304-0.031722 0-0.031722 0-0.031722 0-14.613836 0-29.1806-6.460132-43.234687-19.218714-47.183626-42.643216-125.994576-117.105115-146.013515-136.083351-27.757181-4.732791-138.338718-23.743774-200.584388-35.752272-17.924231-3.533476-32.649608-14.07046-40.372499-29.084409-5.78782-11.256368-10.281157-30.05962 1.471514-55.658647 26.989701-59.047838 74.126254-157.557432 85.957721-182.196599-3.437286-27.117614-16.996093-135.060045-23.760147-198.905142-1.886977-17.460674 3.901867-35.096333 15.829524-48.351218 12.791327-14.278191 30.667463-21.48943 49.854455-19.426445 63.669088 6.332219 173.259042 19.426445 200.584388 22.705118 24.335245-11.879562 121.085776-58.936297 180.133613-86.34146 9.91379-4.573155 19.85828-6.92369 29.596062-6.92369 28.748764 0 52.172243 20.642133 58.328453 51.421136 12.599969 62.997799 30.93864 166.70272 35.639708 193.484689 18.851347 19.682271 91.953272 96.031147 135.060045 143.07151C872.72004 487.125473 879.307062 504.71406 876.572788 522.301623L876.572788 522.301623zM825.375755 499.085876C776.017604 445.314205 687.245791 352.977193 686.365748 352.017332c-2.942005-3.069919-4.956895-6.971785-5.676279-11.208273-0.207731-1.215688-22.193465-127.001509-36.551474-198.936865-0.799202-3.917216-4.285606-16.836457-16.196891-16.836457-3.453658 0-7.30743 1.006933-11.464099 2.942005-67.282383 31.179117-183.955662 88.180342-185.170327 88.771813-3.693112 1.790786-7.850805 2.558265-11.975752 2.01489-1.295506-0.224104-133.63765-16.165168-205.988468-23.424502-0.079818 0-0.207731 0-0.287549 0-7.30743 0-11.128455 2.89391-13.319353 5.40408-3.677762 4.124947-5.644557 9.91379-5.068436 15.110139 7.674796 72.623018 24.255427 202.934922 24.463158 204.325595 0.511653 4.109598-0.159636 8.266267-1.966795 11.960403-0.591471 1.215688-57.657164 120.04712-88.339977 187.201589-3.565199 7.754614-4.41352 14.214746-2.350534 18.131963 1.935072 3.725858 6.588045 5.820566 10.360975 6.53995 70.719668 13.718443 204.644867 36.519752 206.036563 36.727483 4.189416 0.671289 8.058536 2.686179 11.112082 5.580089 1.006933 0.87902 96.414887 91.281983 150.090367 139.889027 8.314363 7.563256 13.143345 8.106632 14.437827 8.106632 3.485381 0 8.314363-4.621251 12.727882-12.391215 36.343743-63.828724 100.011808-181.988868 100.636025-183.155437 1.983167-3.64604 5.004991-6.667863 8.650007-8.650007 1.134847-0.671289 114.418936-62.373583 178.6314-99.516528 8.698103-5.036713 14.278191-10.568706 14.94948-14.854313C834.681702 511.845481 831.49922 505.800811 825.375755 499.085876L825.375755 499.085876zM935.333076 935.670256c-4.157693 4.157693-9.689686 6.299473-15.141862 6.299473-5.548366 0-11.048637-2.142803-15.238053-6.299473l-171.915441-171.915441c-8.362458-8.394181-8.362458-21.98471 0-30.426987 8.394181-8.394181 21.98471-8.394181 30.379914 0l171.915441 171.915441C943.727257 913.684522 943.727257 927.275052 935.333076 935.670256L935.333076 935.670256z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>主题切换</div> </div> <div class="toolbar-item back-to-top" onclick=scrollToTop()> <div class=toolbar-icon> <svg class=back-to-top-icon viewbox="0 0 1024 1024" xmlns=http://www.w3.org/2000/svg> <path d="M882.688 624.128l-336.896-583.68c-15.872-27.136-54.784-27.136-70.656 0L138.24 624.128c-15.872 27.136 4.096 61.44 35.328 61.44H317.44c22.528 0 40.96 18.432 40.96 40.96v239.616c0 22.528 18.432 40.96 40.96 40.96h223.232c22.528 0 40.96-18.432 40.96-40.96v-239.616c0-22.528 18.432-40.96 40.96-40.96h143.872c30.208 0 50.176-34.304 34.304-61.44z"> </path> </svg> </div> <div class=toolbar-label>返回顶部</div> </div> </div> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../languages/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../data-structure-algo/index.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class=md-tabs__item> <a href=../../Linux/index.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../front-end/index.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../MySQL/index.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../JavaEE/index.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../software-test/index.html class=md-tabs__link> 软件测试 </a> </li> <li class=md-tabs__item> <a href=../../other/index.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../tooltips/index.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../projects/index.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <div class="md-nav__link md-nav__container"> <a href=../../languages/index.html class="md-nav__link "> <span class=md-ellipsis> 编程语言 </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 编程语言 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../c-lang/index.html class=md-nav__link> <span class=md-ellipsis> C语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> C++ </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> C++ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../c-to-cpp/c-to-cpp.html class=md-nav__link> <span class=md-ellipsis> C语言过渡C++基础知识 </span> </a> </li> <li class=md-nav__item> <a href=../class-obj/class-obj.html class=md-nav__link> <span class=md-ellipsis> C++类和对象 </span> </a> </li> <li class=md-nav__item> <a href=../member-func/member-func.html class=md-nav__link> <span class=md-ellipsis> C++默认成员函数 </span> </a> </li> <li class=md-nav__item> <a href=../class-obj-other/class-obj-other.html class=md-nav__link> <span class=md-ellipsis> C++类和对象相关内容 </span> </a> </li> <li class=md-nav__item> <a href=../memory/memory.html class=md-nav__link> <span class=md-ellipsis> C++内存管理 </span> </a> </li> <li class=md-nav__item> <a href=../template/template.html class=md-nav__link> <span class=md-ellipsis> C++模版 </span> </a> </li> <li class=md-nav__item> <a href=../stl-intro-string/stl-intro-string.html class=md-nav__link> <span class=md-ellipsis> C++STL简介与string类 </span> </a> </li> <li class=md-nav__item> <a href=../sim-string/sim-string.html class=md-nav__link> <span class=md-ellipsis> string类模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../vector/vector.html class=md-nav__link> <span class=md-ellipsis> vector类 </span> </a> </li> <li class=md-nav__item> <a href=../sim-vector/sim-vector.html class=md-nav__link> <span class=md-ellipsis> vector类模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../list/list.html class=md-nav__link> <span class=md-ellipsis> list类 </span> </a> </li> <li class=md-nav__item> <a href=../sim-list/sim-list.html class=md-nav__link> <span class=md-ellipsis> list类模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../stack/stack.html class=md-nav__link> <span class=md-ellipsis> stack类 </span> </a> </li> <li class=md-nav__item> <a href=../queue-priority-queue/queue-priority-queue.html class=md-nav__link> <span class=md-ellipsis> queue与priority_queue类 </span> </a> </li> <li class=md-nav__item> <a href=../sim-stack-queue/sim-stack-queue.html class=md-nav__link> <span class=md-ellipsis> stack和queue模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../sim-priority-queue/sim-priority-queue.html class=md-nav__link> <span class=md-ellipsis> priority_queue模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../reverse-iterator/reverse-iterator.html class=md-nav__link> <span class=md-ellipsis> 反向迭代器设计 </span> </a> </li> <li class=md-nav__item> <a href=../extend/extend.html class=md-nav__link> <span class=md-ellipsis> C++继承 </span> </a> </li> <li class=md-nav__item> <a href=../polymorphic/polymorphic.html class=md-nav__link> <span class=md-ellipsis> C++多态 </span> </a> </li> <li class=md-nav__item> <a href=../set/set.html class=md-nav__link> <span class=md-ellipsis> set类 </span> </a> </li> <li class=md-nav__item> <a href=../map/map.html class=md-nav__link> <span class=md-ellipsis> map类 </span> </a> </li> <li class=md-nav__item> <a href=../sim-map-set/sim-map-set.html class=md-nav__link> <span class=md-ellipsis> map和set类模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../sim-unordered-map-set/sim-unordered-map-set.html class=md-nav__link> <span class=md-ellipsis> unordered_map和unordered_set类模拟实现 </span> </a> </li> <li class=md-nav__item> <a href=../bitset/bitset.html class=md-nav__link> <span class=md-ellipsis> bitset类 </span> </a> </li> <li class=md-nav__item> <a href=../initializer-list/initializer-list.html class=md-nav__link> <span class=md-ellipsis> initializer_list类 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> C++ 11相关新特性 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=new-in-cpp11.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> C++ 11相关新特性 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 原始字符串 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 列表初始化 </span> </a> <nav class=md-nav aria-label=列表初始化> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 初始化简单变量 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 初始化容器 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decltype class=md-nav__link> <span class=md-ellipsis> decltype关键字 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 尾置返回值类型 </span> </a> </li> <li class=md-nav__item> <a href=#usingtypedef class=md-nav__link> <span class=md-ellipsis> using与typedef </span> </a> </li> <li class=md-nav__item> <a href=#c-11_1 class=md-nav__link> <span class=md-ellipsis> C++ 11新增的容器 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 左值引用和右值引用 </span> </a> <nav class=md-nav aria-label=左值引用和右值引用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 左值与右值 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 左值引用与右值引用 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 左值引用和右值引用的相互转化 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 右值引用的使用 </span> </a> <nav class=md-nav aria-label=右值引用的使用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 拷贝构造函数与移动构造函数 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 赋值重载函数与移动赋值重载函数 </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 元素插入相关函数 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 万能引用与完美转发 </span> </a> <nav class=md-nav aria-label=万能引用与完美转发> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 万能引用 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 完美转发 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#c-11_2 class=md-nav__link> <span class=md-ellipsis> C++ 11新增的两个默认成员函数 </span> </a> <nav class=md-nav aria-label="C++ 11新增的两个默认成员函数"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default class=md-nav__link> <span class=md-ellipsis> 生成默认成员函数=default </span> </a> </li> <li class=md-nav__item> <a href=#delete class=md-nav__link> <span class=md-ellipsis> 不生成默认成员函数=delete </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#c-11_3 class=md-nav__link> <span class=md-ellipsis> C++ 11中的可变参数模版 </span> </a> <nav class=md-nav aria-label="C++ 11中的可变参数模版"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 可变参数模版介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 参数包展开 </span> </a> </li> <li class=md-nav__item> <a href=#emplace class=md-nav__link> <span class=md-ellipsis> 可变参数模版的应用emplace系列函数 </span> </a> </li> <li class=md-nav__item> <a href=#emplacepush class=md-nav__link> <span class=md-ellipsis> emplace系列函数和push系列函数的选择 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lambda class=md-nav__link> <span class=md-ellipsis> lambda表达式 </span> </a> <nav class=md-nav aria-label=lambda表达式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 引入 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_1 class=md-nav__link> <span class=md-ellipsis> lambda表达式介绍 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_2 class=md-nav__link> <span class=md-ellipsis> lambda表达式捕捉列表的传递形式 </span> </a> </li> <li class=md-nav__item> <a href=#for_eachlambda class=md-nav__link> <span class=md-ellipsis> for_each函数与lambda表达式 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_3 class=md-nav__link> <span class=md-ellipsis> lambda表达式的原理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 包装器 </span> </a> <nav class=md-nav aria-label=包装器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 包装器的基本使用 </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 包装器与重载函数 </span> </a> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> <span class=md-ellipsis> 包装器的使用 </span> </a> </li> <li class=md-nav__item> <a href=#_25 class=md-nav__link> <span class=md-ellipsis> 绑定 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../exception/exception.html class=md-nav__link> <span class=md-ellipsis> C++异常 </span> </a> </li> <li class=md-nav__item> <a href=../smart-ptr/smart-ptr.html class=md-nav__link> <span class=md-ellipsis> C++智能指针 </span> </a> </li> <li class=md-nav__item> <a href=../special-class-design/special-class-design.html class=md-nav__link> <span class=md-ellipsis> 特殊类设计 </span> </a> </li> <li class=md-nav__item> <a href=../type-cast/type-cast.html class=md-nav__link> <span class=md-ellipsis> C++中的类型转换 </span> </a> </li> <li class=md-nav__item> <a href=../cppio/cppio.html class=md-nav__link> <span class=md-ellipsis> C++ IO流 </span> </a> </li> <li class=md-nav__item> <a href=../new-in-cpp17/new-in-cpp17.html class=md-nav__link> <span class=md-ellipsis> C++ 17相关新特性 </span> </a> </li> <li class=md-nav__item> <a href=../time-rand/time-rand.html class=md-nav__link> <span class=md-ellipsis> C++时间和随机数相关库 </span> </a> </li> <li class=md-nav__item> <a href=../multi-thread/multi-thread.html class=md-nav__link> <span class=md-ellipsis> C++并发支持库 </span> </a> </li> <li class=md-nav__item> <a href=../format/format.html class=md-nav__link> <span class=md-ellipsis> C++中的格式化字符串 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Java/index.html class=md-nav__link> <span class=md-ellipsis> Java </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../python/index.html class=md-nav__link> <span class=md-ellipsis> Python </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../data-structure-algo/index.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Linux/index.html class=md-nav__link> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../front-end/index.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../MySQL/index.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../JavaEE/index.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../software-test/index.html class=md-nav__link> <span class=md-ellipsis> 软件测试 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../other/index.html class=md-nav__link> <span class=md-ellipsis> 扩展知识 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tooltips/index.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../projects/index.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 原始字符串 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 列表初始化 </span> </a> <nav class=md-nav aria-label=列表初始化> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 初始化简单变量 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 初始化容器 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#decltype class=md-nav__link> <span class=md-ellipsis> decltype关键字 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 尾置返回值类型 </span> </a> </li> <li class=md-nav__item> <a href=#usingtypedef class=md-nav__link> <span class=md-ellipsis> using与typedef </span> </a> </li> <li class=md-nav__item> <a href=#c-11_1 class=md-nav__link> <span class=md-ellipsis> C++ 11新增的容器 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 左值引用和右值引用 </span> </a> <nav class=md-nav aria-label=左值引用和右值引用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 左值与右值 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 左值引用与右值引用 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 左值引用和右值引用的相互转化 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 右值引用的使用 </span> </a> <nav class=md-nav aria-label=右值引用的使用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 拷贝构造函数与移动构造函数 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 赋值重载函数与移动赋值重载函数 </span> </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 元素插入相关函数 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 万能引用与完美转发 </span> </a> <nav class=md-nav aria-label=万能引用与完美转发> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 万能引用 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 完美转发 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#c-11_2 class=md-nav__link> <span class=md-ellipsis> C++ 11新增的两个默认成员函数 </span> </a> <nav class=md-nav aria-label="C++ 11新增的两个默认成员函数"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default class=md-nav__link> <span class=md-ellipsis> 生成默认成员函数=default </span> </a> </li> <li class=md-nav__item> <a href=#delete class=md-nav__link> <span class=md-ellipsis> 不生成默认成员函数=delete </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#c-11_3 class=md-nav__link> <span class=md-ellipsis> C++ 11中的可变参数模版 </span> </a> <nav class=md-nav aria-label="C++ 11中的可变参数模版"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 可变参数模版介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 参数包展开 </span> </a> </li> <li class=md-nav__item> <a href=#emplace class=md-nav__link> <span class=md-ellipsis> 可变参数模版的应用emplace系列函数 </span> </a> </li> <li class=md-nav__item> <a href=#emplacepush class=md-nav__link> <span class=md-ellipsis> emplace系列函数和push系列函数的选择 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#lambda class=md-nav__link> <span class=md-ellipsis> lambda表达式 </span> </a> <nav class=md-nav aria-label=lambda表达式> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 引入 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_1 class=md-nav__link> <span class=md-ellipsis> lambda表达式介绍 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_2 class=md-nav__link> <span class=md-ellipsis> lambda表达式捕捉列表的传递形式 </span> </a> </li> <li class=md-nav__item> <a href=#for_eachlambda class=md-nav__link> <span class=md-ellipsis> for_each函数与lambda表达式 </span> </a> </li> <li class=md-nav__item> <a href=#lambda_3 class=md-nav__link> <span class=md-ellipsis> lambda表达式的原理 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 包装器 </span> </a> <nav class=md-nav aria-label=包装器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 包装器的基本使用 </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 包装器与重载函数 </span> </a> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> <span class=md-ellipsis> 包装器的使用 </span> </a> </li> <li class=md-nav__item> <a href=#_25 class=md-nav__link> <span class=md-ellipsis> 绑定 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=c-11>C++ 11相关新特性<a class=headerlink href=#c-11 title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 8935 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 1355 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 10 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 47 分钟</p> </div> <h2 id=_1>原始字符串<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p>在前面使用字符串时，涉及到一些特殊字符，例如双引号<code>"</code>，直接写在字符串中可能会导致编译错误，例如下面的代码 <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-0-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;string&gt;</span>
</span><span id=__span-0-3>
</span><span id=__span-0-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-0-5><span class=p>{</span>
</span><span id=__span-0-6><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;我是一个 &quot;</span><span class=n>大聪明</span><span class=s>&quot; &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-0-7><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-0-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> 在上面的代码中用于包裹「大聪明」的双引号此时各自匹配最近的引号，导致「大聪明」被孤立于字符串之外，此时要保留包裹「大聪明」的字符串就需要使用转义后的引号<code>\"</code></p> <p>C++11中为了解决减少在不需要使用转义字符的地方减少转义字符的使用引入了原始字符串，这种字符串允许所有字符以原样显示而不会被转义或者被作为特殊符号（例如引号被视为包裹字符串）</p> <p>C++11原始字符串的使用<code>R"(</code>+<code>)"</code>包裹需要的字符串，规则如下： <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><span class=sa>R</span><span class=s>&quot;</span><span class=dl>(</span><span class=s>被包裹的字符串</span><span class=dl>)</span><span class=s>&quot;</span>
</span></code></pre></div></td></tr></table></div> 需要注意，被包裹的字符串不要再使用双引号包裹，否则会原样输出这两个引号</p> <p>使用原始字符串修改前面的代码如下： <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-2-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;string&gt;</span>
</span><span id=__span-2-3>
</span><span id=__span-2-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-2-5><span class=p>{</span>
</span><span id=__span-2-6><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sa>R</span><span class=s>&quot;</span><span class=dl>(</span><span class=s>我是一个&quot;大聪明&quot;</span><span class=dl>)</span><span class=s>&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-2-7><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-2-8><span class=p>}</span>
</span><span id=__span-2-9>
</span><span id=__span-2-10><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-2-11><span class=n>我是一个</span><span class=s>&quot;大聪明&quot;</span>
</span></code></pre></div></td></tr></table></div> 但是上面使用<code>R"(</code>+<code>)"</code>有个问题，那就是如果被包裹的字符串恰好想同时使用<code>)"</code>，此时就会导致原始字符串提前遇到结束符，并且有一个<code>)"</code>落单，为了解决这个问题，还可以使用<code>R"+*(</code>+<code>)+*"</code>包裹其中有<code>)"</code>出现的字符串，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-3-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;string&gt;</span>
</span><span id=__span-3-3>
</span><span id=__span-3-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-3-5><span class=p>{</span>
</span><span id=__span-3-6><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sa>R</span><span class=s>&quot;</span><span class=dl>+*(</span><span class=s>我是一个&quot;(大聪明)&quot;</span><span class=dl>)+*</span><span class=s>&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-3-7><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-3-8><span class=p>}</span>
</span><span id=__span-3-9>
</span><span id=__span-3-10><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-3-11><span class=n>我是一个</span><span class=s>&quot;(大聪明)&quot;</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意，不要交错使用<code>R"(</code>+<code>)"</code>与<code>R"+*(</code>+<code>)+*"</code></p> </div> <h2 id=_2>列表初始化<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <h3 id=_3>初始化简单变量<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>在C语言和C++98中，对一种类型的变量进行初始化时，主要使用赋值符号与初始化值，如果是一个数组或者结构体等具有多个成员的变量初始化时，可以使用<code>{}</code>进行初始化</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=k>struct</span><span class=w> </span><span class=nc>point</span>
</span><span id=__span-4-2><span class=p>{</span>
</span><span id=__span-4-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-4-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
</span><span id=__span-4-5><span class=p>};</span>
</span><span id=__span-4-6>
</span><span id=__span-4-7><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-4-8><span class=p>{</span>
</span><span id=__span-4-9><span class=w>    </span><span class=c1>// 初始化一个内置类型变量，兼容C语言方式</span>
</span><span id=__span-4-10><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-4-11><span class=w>    </span><span class=c1>// 初始化一个数组，兼容C语言方式</span>
</span><span id=__span-4-12><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>data</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>4</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-4-13><span class=w>    </span><span class=c1>// 初始化结构，兼容C语言方式</span>
</span><span id=__span-4-14><span class=w>    </span><span class=n>point</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-4-15>
</span><span id=__span-4-16><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-4-17><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>上面的代码中需要注意对于一个数组和结构来说，为了兼容C语言，默认是使用<code>{}</code>进行初始化，<strong>此时不算作列表初始化</strong>，但是如果省略了赋值符号，则算作列表初始化。列表初始化如果内部没有内容，则变量初始化时值默认为0。例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=k>struct</span><span class=w> </span><span class=nc>point</span>
</span><span id=__span-5-2><span class=p>{</span>
</span><span id=__span-5-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=p>;</span>
</span><span id=__span-5-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>y</span><span class=p>;</span>
</span><span id=__span-5-5><span class=p>};</span>
</span><span id=__span-5-6>
</span><span id=__span-5-7><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-5-8><span class=p>{</span>
</span><span id=__span-5-9><span class=w>    </span><span class=c1>// 初始化一个内置类型变量</span>
</span><span id=__span-5-10><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>{};</span>
</span><span id=__span-5-11><span class=w>    </span><span class=c1>// 初始化一个数组，属于初始化列表</span>
</span><span id=__span-5-12><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>data</span><span class=p>[]{};</span>
</span><span id=__span-5-13><span class=w>    </span><span class=n>string</span><span class=w> </span><span class=n>str</span><span class=p>{};</span>
</span><span id=__span-5-14><span class=w>    </span><span class=c1>// 初始化结构，属于初始化列表</span>
</span><span id=__span-5-15><span class=w>    </span><span class=n>point</span><span class=w> </span><span class=n>p</span><span class=p>{};</span>
</span><span id=__span-5-16>
</span><span id=__span-5-17><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;a = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span><span class=c1>// 0</span>
</span><span id=__span-5-18><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;data[0] = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>data</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span><span class=c1>// 0</span>
</span><span id=__span-5-19><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;p.x = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>x</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span><span class=c1>// 0</span>
</span><span id=__span-5-20><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span><span class=c1>// 空字符</span>
</span><span id=__span-5-21>
</span><span id=__span-5-22><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-5-23><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>需要注意，如果使用了列表初始化，则不可以出现部分用于初始化的值赋值给变量后出现数据丢失的情况，例如<code>double</code>的值赋值给<code>int</code>的变量：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=c1>// double转int</span>
</span><span id=__span-6-2><span class=kt>double</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>3.14</span><span class=p>;</span>
</span><span id=__span-6-3><span class=kt>int</span><span class=w> </span><span class=n>a3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-6-4>
</span><span id=__span-6-5><span class=c1>// long long 转 int</span>
</span><span id=__span-6-6><span class=kt>long</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>648797L</span><span class=n>L</span><span class=p>;</span>
</span><span id=__span-6-7><span class=kt>int</span><span class=w> </span><span class=n>a2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=n>num</span><span class=p>};</span>
</span><span id=__span-6-8>
</span><span id=__span-6-9><span class=c1>// long 转 int</span>
</span><span id=__span-6-10><span class=c1>// 正常编译</span>
</span><span id=__span-6-11><span class=kt>long</span><span class=w> </span><span class=n>num2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>648797L</span><span class=p>;</span>
</span><span id=__span-6-12><span class=kt>int</span><span class=w> </span><span class=n>a4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=n>num2</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-6-13>
</span><span id=__span-6-14><span class=n>报错信息</span><span class=err>：</span>
</span><span id=__span-6-15><span class=n>conversion</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=err>&#39;</span><span class=kr>__int64</span><span class=err>&#39;</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=err>&#39;</span><span class=kt>int</span><span class=err>&#39;</span><span class=w> </span><span class=k>requires</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>narrowing</span><span class=w> </span><span class=n>conversion</span><span class=w>     </span>
</span><span id=__span-6-16><span class=n>conversion</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=err>&#39;</span><span class=kt>double</span><span class=err>&#39;</span><span class=w> </span><span class=n>to</span><span class=w> </span><span class=err>&#39;</span><span class=kt>int</span><span class=err>&#39;</span><span class=w> </span><span class=k>requires</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>narrowing</span><span class=w> </span><span class=n>conversion</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_4>初始化容器<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <p>有了列表初始化后，容器的初始化可以变得更加简单，对比下面的初始化方式</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-7-2><span class=p>{</span>
</span><span id=__span-7-3><span class=w>    </span><span class=c1>// 初始化vector</span>
</span><span id=__span-7-4><span class=w>    </span><span class=c1>// C++ 98的初始化</span>
</span><span id=__span-7-5><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>data</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-7-6><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>v</span><span class=p>;</span>
</span><span id=__span-7-7><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>num</span><span class=err>：</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-7-8><span class=w>        </span><span class=n>v</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-7-9>
</span><span id=__span-7-10><span class=w>    </span><span class=c1>// C++ 11的初始化</span>
</span><span id=__span-7-11><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>v</span><span class=p>{</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-7-12>
</span><span id=__span-7-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-7-14><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>对于map来说，对比下面的初始化方式</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-8-2><span class=p>{</span>
</span><span id=__span-8-3><span class=w>    </span><span class=c1>// 初始化map</span>
</span><span id=__span-8-4><span class=w>    </span><span class=c1>// C++ 98的初始化</span>
</span><span id=__span-8-5><span class=w>    </span><span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
</span><span id=__span-8-6><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-8-7><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-8-8><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-8-9><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-8-10><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-8-11>
</span><span id=__span-8-12><span class=w>    </span><span class=c1>// C++ 11的初始化</span>
</span><span id=__span-8-13><span class=w>    </span><span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>m1</span><span class=p>{{</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=mi>2</span><span class=w> </span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=mi>3</span><span class=w> </span><span class=p>}};</span>
</span><span id=__span-8-14>
</span><span id=__span-8-15><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-8-16><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在上面的代码中，对于C++ 98的初始化来说，通过多参数构造的隐式类型转换作为参数传递给<code>insert()</code>函数，而C++ 11中，结合了类型转换已经列表初始化对map进行初始化</p> <p>列表初始化有以下几点好处：</p> <ol> <li>方便，基本上可以替代普通括号初始化</li> <li>可以使用初始化列表接受任意长度</li> <li>可以防止类型窄化(narrowing conversion)，避免精度丢失的隐式类型转换</li> </ol> <h2 id=decltype><code>decltype</code>关键字<a class=headerlink href=#decltype title="Permanent link">&para;</a></h2> <p>前面声明变量时使用<code>auto</code>关键字，根据赋值符号右侧类型推导变量的类型，但是如果没有赋值，<code>auto</code>此时不可以进行推导；为了知道某一个变量的类型，可以使用<code>typeid(变量).name()</code>进行获取，直接打印即可查看指定变量的类型</p> <p>但是上面两种方式都无法做到根据已有变量/常量的类型创建新的变量，为了解决这个问题，在C++ 11中新增了<code>decltype</code>关键字</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-9-2><span class=p>{</span>
</span><span id=__span-9-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-9-4><span class=w>    </span><span class=c1>// 获取普通变量类型创建变量</span>
</span><span id=__span-9-5><span class=w>    </span><span class=k>decltype</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=n>x1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
</span><span id=__span-9-6><span class=w>    </span><span class=c1>// 获取表达式的值类型创建变量</span>
</span><span id=__span-9-7><span class=w>    </span><span class=k>decltype</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=n>x2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
</span><span id=__span-9-8><span class=w>    </span><span class=k>decltype</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>2.1</span><span class=p>)</span><span class=w> </span><span class=n>x3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>3</span><span class=p>;</span>
</span><span id=__span-9-9>
</span><span id=__span-9-10><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=k>typeid</span><span class=p>(</span><span class=n>x1</span><span class=p>).</span><span class=n>name</span><span class=p>()</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-9-11><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=k>typeid</span><span class=p>(</span><span class=n>x2</span><span class=p>).</span><span class=n>name</span><span class=p>()</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-9-12><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=k>typeid</span><span class=p>(</span><span class=n>x3</span><span class=p>).</span><span class=n>name</span><span class=p>()</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-9-13>
</span><span id=__span-9-14><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-9-15><span class=p>}</span>
</span><span id=__span-9-16>
</span><span id=__span-9-17><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-9-18><span class=kt>int</span>
</span><span id=__span-9-19><span class=kt>int</span>
</span><span id=__span-9-20><span class=kt>double</span>
</span></code></pre></div></td></tr></table></div> <h2 id=_5>尾置返回值类型<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <p>在C++ 98中，函数的定义主要结构如下：</p> <p><div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><span class=n>返回值类型</span><span class=w> </span><span class=nf>函数名</span><span class=p>(</span><span class=n>形式参数1</span><span class=p>,</span><span class=w> </span><span class=n>形式参数2</span><span class=p>,</span><span class=w> </span><span class=p>...)</span>
</span><span id=__span-10-2><span class=p>{</span>
</span><span id=__span-10-3><span class=w>    </span><span class=n>函数体</span>
</span><span id=__span-10-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> 但是如果返回值类型比较长，例如返回一个数组指针<code>int (*)[10]</code>时，上面的写法就会不便于阅读：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1><span class=kt>int</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=p>)[</span><span class=mi>10</span><span class=p>]</span><span class=w> </span><span class=n>func</span><span class=p>()</span>
</span><span id=__span-11-2><span class=p>{</span>
</span><span id=__span-11-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-11-4>
</span><span id=__span-11-5><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>arr</span><span class=p>;</span><span class=w> </span><span class=c1>// 返回一个数组的首地址</span>
</span><span id=__span-11-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>而在C++ 11中，为了更好的可读性，可以使用<code>-&gt;</code>结合对应的函数返回值放置于形参列表后方，而在原来的函数名前方需要使用<code>auto</code>，所以下面的代码可以修改为：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><span class=k>auto</span><span class=w> </span><span class=n>func</span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=p>)[</span><span class=mi>10</span><span class=p>]</span>
</span><span id=__span-12-2><span class=p>{</span>
</span><span id=__span-12-3><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-12-4>
</span><span id=__span-12-5><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>arr</span><span class=p>;</span><span class=c1>// 返回一个数组的首地址</span>
</span><span id=__span-12-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>也可以结合<code>decltype</code>关键字，如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>typename</span><span class=w> </span><span class=nc>U</span><span class=o>&gt;</span>
</span><span id=__span-13-2><span class=k>auto</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>T</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=n>U</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=k>decltype</span><span class=p>(</span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-13-3><span class=p>{</span><span class=w>    </span>
</span><span id=__span-13-4><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-13-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h2 id=usingtypedef><code>using</code>与<code>typedef</code><a class=headerlink href=#usingtypedef title="Permanent link">&para;</a></h2> <p><code>using</code>和<code>typedef</code>都可以用来为已有的类型定义一个新的名称。</p> <p>二者最主要的区别在于，<code>using</code>可以用来定义模板别名，<code>using</code>还可以引入命名空间，而<code>typedef</code>不能</p> <ol> <li> <p><code>typedef</code>主要用于给类型定义别名，但是它不能用于模板别名。 <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=k>typedef</span><span class=w> </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=w> </span><span class=n>ulong</span><span class=p>;</span>
</span><span id=__span-14-2><span class=k>typedef</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=n>FuncPtr</span><span class=p>)(</span><span class=kt>double</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div></p> </li> <li> <p><code>using</code>可以取代<code>typedef</code>的功能，语法相对简洁。 <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=k>using</span><span class=w> </span><span class=n>ulong</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>unsigned</span><span class=w> </span><span class=kt>long</span><span class=p>;</span>
</span><span id=__span-15-2><span class=k>using</span><span class=w> </span><span class=n>FuncPtr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=p>)(</span><span class=kt>double</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div></p> </li> <li> <p>对于模板别名，<code>using</code>显得非常强大且直观。</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1><span class=k>template</span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-16-2><span class=k>using</span><span class=w> </span><span class=n>Vec</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> </li> <li> <p>作用范围：<code>using</code>还可以用于命名空间引入，<code>typedef</code>没有此功能。 <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1><span class=k>namespace</span><span class=w> </span><span class=nn>LongNamespaceName</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-17-2><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>value</span><span class=p>;</span>
</span><span id=__span-17-3><span class=p>}</span>
</span><span id=__span-17-4>
</span><span id=__span-17-5><span class=c1>// using namespace LongNamespaceName; 直接引入命名空间</span>
</span><span id=__span-17-6><span class=k>using</span><span class=w> </span><span class=n>LNN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LongNamespaceName</span><span class=p>;</span><span class=c1>// 引入命名空间并为命名空间取别名</span>
</span><span id=__span-17-7><span class=n>LNN</span><span class=o>::</span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>42</span><span class=p>;</span><span class=w> </span><span class=c1>// 相当于 LongNamespaceName::value</span>
</span></code></pre></div></td></tr></table></div></p> </li> </ol> <p>总之，更推荐使用<code>using</code>，尤其是当你处理模板时。在现代 C++ 代码规范中，C++11 之后，许多代码规范建议优先使用<code>using</code>而不是<code>typedef</code>。这证明了在实际应用和代码维护中，<code>using</code>更具有优势。</p> <h2 id=c-11_1>C++ 11新增的容器<a class=headerlink href=#c-11_1 title="Permanent link">&para;</a></h2> <p>下面红色标记的容器均为C++11新增的容器</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image.png"></a></p> <p><code>&lt;array&gt;</code>：封装的是C语言静态数组，本质还是普通数组，只是为了便于控制数组越界等问题，因为一般的数组越界读写在编译阶段是不容易检测出来的</p> <p><code>&lt;forward_list&gt;</code>：单链表，这个单链表没有尾插和尾删，因为开销大</p> <p><code>&lt;unordered_map&gt;</code>和<code>&lt;unordered_set&gt;</code>：封装的是哈希表</p> <h2 id=_6>正则表达式<a class=headerlink href=#_6 title="Permanent link">&para;</a></h2> <p>C++11中提供了对<a href=http://www.en.cppreference.com/w/cpp/regex.html>正则表达式</a>的原生支持，使用正则表达式可以对字符串进行匹配、查找、替换等操作，使用正则表达式需要引入头文件<code>&lt;regex&gt;</code></p> <p>正则表达式的基本语法如下：</p> <p><strong>基本匹配</strong>：</p> <ul> <li><code>.</code>：匹配除换行符以外的任意单个字符</li> <li><code>[...]</code>：字符集，匹配方括号中任意一个字符。例如<code>[abc]</code>匹配"a"、"b"或"c"</li> <li><code>[^...]</code>：否定字符集，匹配任何不在方括号中的字符。例如<code>[^abc]</code> 匹配任何不是"a"、"b"或"c"的字符</li> <li><code>\d</code>：匹配任意数字，等同于<code>[0-9]</code></li> <li><code>\D</code>：匹配任意非数字字符，等同于<code>[^0-9]</code></li> <li><code>\w</code>：匹配任意字母、数字或下划线，等同于<code>[a-zA-Z0-9_]</code></li> <li><code>\W</code>：匹配任意非字母、数字或下划线字符，等同于<code>[^a-zA-Z0-9_]</code></li> <li><code>\s</code>：匹配任意空白字符，包括空格、制表符、换行符等</li> <li><code>\S</code>：匹配任意非空白字符</li> <li><code>\n</code>：匹配换行符</li> <li><code>\r</code>：匹配回车符</li> <li><code>\t</code>：匹配制表符</li> <li><code>\b</code>：匹配单词边界</li> <li><code>\B</code>：匹配非单词边界</li> <li><code>^</code>：匹配字符串的开头</li> <li><code>$</code>：匹配字符串的结尾</li> </ul> <p><strong>量词 (Quantifiers)</strong>：</p> <ul> <li><code>*</code>：匹配前面的元素零次或多次。例如<code>a*</code>匹配零个或多个"a"</li> <li><code>+</code>：匹配前面的元素一次或多次。例如<code>a+</code>匹配一个或多个"a"</li> <li><code>?</code>：匹配前面的元素零次或一次。例如<code>a?</code>匹配零个或一个"a"</li> <li><code>{n}</code>：匹配前面的元素恰好n次。例如<code>a{3}</code>匹配"aaa"</li> <li><code>{n,}</code>：匹配前面的元素至少n次。例如<code>a{2,}</code>匹配两个或更多"a"</li> <li><code>{n,m}</code>：匹配前面的元素至少n次，但不超过m次。例如<code>a{2,4}</code>匹配"aa"、"aaa" 或"aaaa"</li> <li><code>*?</code>, <code>+?</code>, <code>??</code>, <code>{n,}?</code>, <code>{n,m}?</code>：非贪婪量词，尽可能少地匹配</li> </ul> <p><strong>分组与捕获 (Grouping and Capturing)</strong>：</p> <ul> <li><code>(...)</code>：分组，将括号内的表达式视为一个整体，并捕获匹配的内容</li> <li><code>(?:...)</code>：非捕获分组，将括号内的表达式视为一个整体，但不捕获匹配的内容，如果内部有捕获组，则意味着不为自己创建捕获组，但内部的捕获组仍然有效</li> <li><code>\1</code>, <code>\2</code>, ...：反向引用，匹配前面捕获组捕获到的内容</li> </ul> <p><strong>或操作 (Alternation)</strong>：</p> <ul> <li><code>|</code>：或操作符，匹配<code>|</code>左边或右边的表达式。例如<code>a|b</code>匹配"a"或"b"</li> </ul> <p><strong>转义字符 (Escape Characters)</strong>：</p> <ul> <li><code>\</code>：用于转义特殊字符，使其被视为普通字符。例如<code>\.</code>匹配实际的点字符"."</li> </ul> <p><strong>断言 (Assertions)</strong>：</p> <ul> <li><code>(?=...)</code>：正向先行断言 (Positive Lookahead)，匹配后面跟着<code>...</code>的位置</li> <li><code>(?!...)</code>：负向先行断言 (Negative Lookahead)，匹配后面不跟着<code>...</code>的位置</li> <li><code>(?&lt;=...)</code>：正向后行断言 (Positive Lookbehind)，匹配前面是<code>...</code>的位置</li> <li><code>(?&lt;!...)</code>：负向后行断言 (Negative Lookbehind)，匹配前面不是<code>...</code>的位置</li> </ul> <p><strong>模式修饰符 (Pattern Modifiers/Flags)</strong>：</p> <ul> <li><code>i</code>：忽略大小写 (Case-insensitive)</li> <li><code>g</code>：全局匹配 (Global match)，查找所有匹配项，而不是在找到第一个匹配项后停止</li> <li><code>m</code>：多行匹配 (Multiline)，使<code>^</code>和<code>$</code>匹配每一行的开头和结尾，而不仅仅是整个字符串的开头和结尾</li> <li><code>s</code> (或<code>.</code>的dotall模式): 使<code>.</code>匹配包括换行符在内的所有字符</li> </ul> <p>在C++11的正则表达式中，使用<code>regex</code>类进行正则表达式的匹配，常使用<code>smatch</code>类进行正则表达式的匹配结果的保存，使用<code>regex_match</code>函数进行正则表达式的匹配，使用<code>regex_search</code>函数进行正则表达式的搜索，使用<code>regex_replace</code>函数进行正则表达式的替换</p> <p>其中<code>regex</code>类默认使用的是ECMAScript语法，基本使用如下：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-18-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;regex&gt;</span>
</span><span id=__span-18-3>
</span><span id=__span-18-4><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
</span><span id=__span-18-5>
</span><span id=__span-18-6><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-18-7><span class=p>{</span>
</span><span id=__span-18-8><span class=w>    </span><span class=c1>// 原始字符串</span>
</span><span id=__span-18-9><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;/number/1234&quot;</span><span class=p>;</span>
</span><span id=__span-18-10>
</span><span id=__span-18-11><span class=w>    </span><span class=c1>// 定义正则表达式</span>
</span><span id=__span-18-12><span class=w>    </span><span class=c1>// 以&quot;/number/&quot;开头的含有一个或者多个数字的字符串</span>
</span><span id=__span-18-13><span class=w>    </span><span class=c1>// 并且提取数字字符串</span>
</span><span id=__span-18-14><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>regex</span><span class=w> </span><span class=n>expre</span><span class=p>(</span><span class=sa>R</span><span class=s>&quot;</span><span class=dl>(</span><span class=s>/number/(\d+)</span><span class=dl>)</span><span class=s>&quot;</span><span class=p>);</span>
</span><span id=__span-18-15>
</span><span id=__span-18-16><span class=w>    </span><span class=c1>// 结果数组，用于存储字符串</span>
</span><span id=__span-18-17><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>smatch</span><span class=w> </span><span class=n>results</span><span class=p>;</span>
</span><span id=__span-18-18>
</span><span id=__span-18-19><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>regex_match</span><span class=p>(</span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=n>results</span><span class=p>,</span><span class=w> </span><span class=n>expre</span><span class=p>))</span>
</span><span id=__span-18-20><span class=w>    </span><span class=p>{</span>
</span><span id=__span-18-21><span class=w>        </span><span class=k>auto</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>results</span><span class=p>.</span><span class=n>begin</span><span class=p>();</span>
</span><span id=__span-18-22><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>it</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>results</span><span class=p>.</span><span class=n>end</span><span class=p>())</span>
</span><span id=__span-18-23><span class=w>        </span><span class=p>{</span>
</span><span id=__span-18-24><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=o>*</span><span class=n>it</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-18-25><span class=w>            </span><span class=c1>// 等同于下面的写法</span>
</span><span id=__span-18-26><span class=w>            </span><span class=c1>// std::cout &lt;&lt; it-&gt;str() &lt;&lt; std::endl;</span>
</span><span id=__span-18-27><span class=w>            </span><span class=o>++</span><span class=n>it</span><span class=p>;</span>
</span><span id=__span-18-28><span class=w>        </span><span class=p>}</span>
</span><span id=__span-18-29><span class=w>    </span><span class=p>}</span>
</span><span id=__span-18-30>
</span><span id=__span-18-31><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-18-32><span class=p>}</span>
</span><span id=__span-18-33>
</span><span id=__span-18-34><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-18-35><span class=o>/</span><span class=n>number</span><span class=o>/</span><span class=mi>1234</span>
</span><span id=__span-18-36><span class=mi>1234</span>
</span></code></pre></div></td></tr></table></div> <p>基于上面的代码理解<code>smatch</code>中元素的含义：</p> <p><code>std::smatch</code>对象（在上面例子中是<code>result</code>）用于存储正则表达式匹配的结果。它的元素是<code>std::sub_match</code>对象，每个对象代表一个匹配的子字符串。其中：</p> <ul> <li><code>results[0]</code>（或者迭代器<code>results.begin()</code>指向的元素）总是代表整个正则表达式匹配到的完整字符串</li> <li><code>results[1]</code>、<code>results[2]</code>、...（或者迭代器 <code>results.begin() + 1</code>, <code>results.begin() + 2</code>, ... 指向的元素）代表正则表达式中用括号<code>()</code>定义的捕获组（capturing groups）所匹配到的子字符串</li> </ul> <p>在上面的例子中，<code>str</code>（即<code>"/number/1234"</code>）与<code>expre</code>（即<code>/number/(\d+)</code>）匹配成功，所以<code>results[0]</code>是<code>/number/1234</code>，而<code>(\d+)</code> 是第一个也是唯一一个捕获组。因此，<code>results[1]</code>将是<code>(\d+)</code>匹配到的部分，即<code>1234</code></p> <p>所以，代码中的循环会依次输出：</p> <ol> <li>整个匹配的字符串是<code>/number/1234</code></li> <li>第一个捕获组匹配的字符串是<code>1234</code></li> </ol> <h2 id=_7>左值引用和右值引用<a class=headerlink href=#_7 title="Permanent link">&para;</a></h2> <h3 id=_8>左值与右值<a class=headerlink href=#_8 title="Permanent link">&para;</a></h3> <p>左值代表赋值符号左侧的值，可以直接取地址，一般为变量，并且一般情况下可以修改（被<code>const</code>修饰的左值不可以修改）</p> <p>右值代表赋值符号右侧的值，不可以直接取地址，一般为内置类型常量、函数返回值和表达式的值</p> <p>右值不可以出现在赋值符号的左侧，否则会报错为不可修改的左值，但是左值可以出现在右侧，此时是将左值中的值赋值给赋值符号左侧的新左值，例如<code>int b = 0; a = b;</code></p> <p>右值可以分为两种</p> <ol> <li>纯右值：一般为内置类型常量</li> <li>将亡值：一般为函数返回值中的临时对象、匿名对象等即将被销毁的值</li> </ol> <h3 id=_9>左值引用与右值引用<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>左值引用：即为对左值的引用，在类型后加一个<code>&amp;</code>即可代表左值引用类型，例如<code>int num = 0; int&amp; ref = num;</code> 中<code>ref</code>为左值<code>num</code>的别名，表达式<code>int&amp; ref = num;</code>中的<code>ref</code>和<code>num</code>均为左值</p> <p>右值引用：即为对右值的别名，在类型后加两个<code>&amp;</code>即可代表右值引用类型，例如<code>int&amp;&amp; ref = 1;</code>，表达式中的<code>ref</code>为对右值引用的左值，1为右值</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>一般情况下，左值引用的对象不可以是常量，因为临时变量具有常性，为了解决这个问题，可以使用<code>const</code>修饰左值引用，例如<code>const int&amp; num = 1;</code></p> </div> <h3 id=_10>左值引用和右值引用的相互转化<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>左值引用可以通过强制转换转化为右值引用，也可以通过<code>move()</code>函数进行变换，例如下面的代码</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-19-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-19-2><span class=p>{</span>
</span><span id=__span-19-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-19-4><span class=w>    </span><span class=c1>// 左值引用</span>
</span><span id=__span-19-5><span class=w>    </span><span class=kt>int</span><span class=o>&amp;</span><span class=w> </span><span class=n>r1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=p>;</span>
</span><span id=__span-19-6>
</span><span id=__span-19-7><span class=w>    </span><span class=c1>// 将左值引用强制转换为右值引用</span>
</span><span id=__span-19-8><span class=w>    </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>r2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=p>)</span><span class=n>r1</span><span class=p>;</span>
</span><span id=__span-19-9><span class=w>    </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>r3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>move</span><span class=p>(</span><span class=n>r1</span><span class=p>);</span>
</span><span id=__span-19-10><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-19-11><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>右值引用可以通过强制转换转化成左值引用，例如下面的代码</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-20-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-20-2><span class=p>{</span>
</span><span id=__span-20-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-20-4><span class=w>    </span><span class=c1>// 左值引用</span>
</span><span id=__span-20-5><span class=w>    </span><span class=kt>int</span><span class=o>&amp;</span><span class=w> </span><span class=n>r1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=p>;</span>
</span><span id=__span-20-6>
</span><span id=__span-20-7><span class=w>    </span><span class=c1>// 将左值引用强制转换为右值引用</span>
</span><span id=__span-20-8><span class=w>    </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>r2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=p>)</span><span class=n>r1</span><span class=p>;</span>
</span><span id=__span-20-9>
</span><span id=__span-20-10><span class=w>    </span><span class=c1>// 将右值引用强制转化为左值引用</span>
</span><span id=__span-20-11><span class=w>    </span><span class=kt>int</span><span class=o>&amp;</span><span class=w> </span><span class=n>r3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;</span><span class=p>)</span><span class=n>r2</span><span class=p>;</span>
</span><span id=__span-20-12>
</span><span id=__span-20-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-20-14><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>之所以可以通过强制转换实现左值引用和右值引用之间的相互转换是因为左值引用和右值引用在底层实际上都是一样的，只是语法层面对二者进行了更严格的定义，只要基本类型相同就可以通过强制转换进行改变，参考下图的汇编代码：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image1.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image1.png"></a></p> <h3 id=_11>右值引用的使用<a class=headerlink href=#_11 title="Permanent link">&para;</a></h3> <p>以模拟实现的string为例</p> <details class=quote> <summary>模拟实现string代码</summary> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-21-1><span class=k>namespace</span><span class=w> </span><span class=nn>simulate_string</span>
</span><span id=__span-21-2><span class=p>{</span>
</span><span id=__span-21-3><span class=w>    </span><span class=k>class</span><span class=w> </span><span class=nc>string</span>
</span><span id=__span-21-4><span class=w>    </span><span class=p>{</span>
</span><span id=__span-21-5><span class=w>    </span><span class=k>public</span><span class=o>:</span>
</span><span id=__span-21-6><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>iterator</span><span class=p>;</span>
</span><span id=__span-21-7><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=nf>begin</span><span class=p>()</span>
</span><span id=__span-21-8><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-9><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_str</span><span class=p>;</span>
</span><span id=__span-21-10><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-11><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=nf>end</span><span class=p>()</span>
</span><span id=__span-21-12><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-13><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_str</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>_size</span><span class=p>;</span>
</span><span id=__span-21-14><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-15>
</span><span id=__span-21-16><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>const_iterator</span><span class=p>;</span>
</span><span id=__span-21-17><span class=w>        </span><span class=n>const_iterator</span><span class=w> </span><span class=nf>begin</span><span class=p>()</span><span class=w> </span><span class=k>const</span>
</span><span id=__span-21-18><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-19><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_str</span><span class=p>;</span>
</span><span id=__span-21-20><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-21>
</span><span id=__span-21-22><span class=w>        </span><span class=n>const_iterator</span><span class=w> </span><span class=nf>end</span><span class=p>()</span><span class=w> </span><span class=k>const</span>
</span><span id=__span-21-23><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-24><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_str</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>_size</span><span class=p>;</span>
</span><span id=__span-21-25><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-26>
</span><span id=__span-21-27><span class=w>        </span><span class=n>string</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;&quot;</span><span class=p>)</span>
</span><span id=__span-21-28><span class=w>            </span><span class=o>:</span><span class=n>_size</span><span class=p>(</span><span class=n>strlen</span><span class=p>(</span><span class=n>str</span><span class=p>))</span>
</span><span id=__span-21-29><span class=w>            </span><span class=p>,</span><span class=w> </span><span class=n>_capacity</span><span class=p>(</span><span class=n>_size</span><span class=p>)</span>
</span><span id=__span-21-30><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-31><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;string(char* str)&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-21-32><span class=w>            </span><span class=n>_str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>char</span><span class=p>[</span><span class=n>_capacity</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>];</span>
</span><span id=__span-21-33><span class=w>            </span><span class=n>strcpy</span><span class=p>(</span><span class=n>_str</span><span class=p>,</span><span class=w> </span><span class=n>str</span><span class=p>);</span>
</span><span id=__span-21-34><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-35>
</span><span id=__span-21-36><span class=w>        </span><span class=c1>// s1.swap(s2)</span>
</span><span id=__span-21-37><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>swap</span><span class=p>(</span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-38><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-39><span class=w>            </span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>_str</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>_str</span><span class=p>);</span>
</span><span id=__span-21-40><span class=w>            </span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>_size</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>_size</span><span class=p>);</span>
</span><span id=__span-21-41><span class=w>            </span><span class=o>::</span><span class=n>swap</span><span class=p>(</span><span class=n>_capacity</span><span class=p>,</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=n>_capacity</span><span class=p>);</span>
</span><span id=__span-21-42><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-43>
</span><span id=__span-21-44><span class=w>        </span><span class=c1>// 拷贝构造</span>
</span><span id=__span-21-45><span class=w>        </span><span class=n>string</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-46><span class=w>            </span><span class=o>:</span><span class=n>_str</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-21-47><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-48><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;string(const string&amp; s) -- 深拷贝&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-21-49>
</span><span id=__span-21-50><span class=w>            </span><span class=n>reserve</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>_capacity</span><span class=p>);</span>
</span><span id=__span-21-51><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>ch</span><span class=err>：</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-52><span class=w>            </span><span class=p>{</span>
</span><span id=__span-21-53><span class=w>                </span><span class=n>push_back</span><span class=p>(</span><span class=n>ch</span><span class=p>);</span>
</span><span id=__span-21-54><span class=w>            </span><span class=p>}</span>
</span><span id=__span-21-55><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-56>
</span><span id=__span-21-57><span class=w>        </span><span class=c1>// 赋值重载</span>
</span><span id=__span-21-58><span class=w>        </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-59><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-60><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;string&amp; operator=(const string&amp; s) -- 深拷贝&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-21-61><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=k>this</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=o>&amp;</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-62><span class=w>            </span><span class=p>{</span>
</span><span id=__span-21-63><span class=w>                </span><span class=n>_str</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span><span id=__span-21-64><span class=w>                </span><span class=n>_size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-21-65>
</span><span id=__span-21-66><span class=w>                </span><span class=n>reserve</span><span class=p>(</span><span class=n>s</span><span class=p>.</span><span class=n>_capacity</span><span class=p>);</span>
</span><span id=__span-21-67><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>ch</span><span class=err>：</span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-21-68><span class=w>                </span><span class=p>{</span>
</span><span id=__span-21-69><span class=w>                    </span><span class=n>push_back</span><span class=p>(</span><span class=n>ch</span><span class=p>);</span>
</span><span id=__span-21-70><span class=w>                </span><span class=p>}</span>
</span><span id=__span-21-71><span class=w>            </span><span class=p>}</span>
</span><span id=__span-21-72>
</span><span id=__span-21-73><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-21-74><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-75>
</span><span id=__span-21-76><span class=w>        </span><span class=o>~</span><span class=n>string</span><span class=p>()</span>
</span><span id=__span-21-77><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-78><span class=w>            </span><span class=k>delete</span><span class=p>[]</span><span class=w> </span><span class=n>_str</span><span class=p>;</span>
</span><span id=__span-21-79><span class=w>            </span><span class=n>_str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>nullptr</span><span class=p>;</span>
</span><span id=__span-21-80><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-81>
</span><span id=__span-21-82><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>reserve</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>n</span><span class=p>)</span>
</span><span id=__span-21-83><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-84><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>n</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>_capacity</span><span class=p>)</span>
</span><span id=__span-21-85><span class=w>            </span><span class=p>{</span>
</span><span id=__span-21-86><span class=w>                </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>tmp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=kt>char</span><span class=p>[</span><span class=n>n</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>];</span>
</span><span id=__span-21-87><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_str</span><span class=p>)</span>
</span><span id=__span-21-88><span class=w>                </span><span class=p>{</span>
</span><span id=__span-21-89><span class=w>                    </span><span class=n>strcpy</span><span class=p>(</span><span class=n>tmp</span><span class=p>,</span><span class=w> </span><span class=n>_str</span><span class=p>);</span>
</span><span id=__span-21-90><span class=w>                    </span><span class=k>delete</span><span class=p>[]</span><span class=w> </span><span class=n>_str</span><span class=p>;</span>
</span><span id=__span-21-91><span class=w>                </span><span class=p>}</span>
</span><span id=__span-21-92><span class=w>                </span><span class=n>_str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span>
</span><span id=__span-21-93><span class=w>                </span><span class=n>_capacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>n</span><span class=p>;</span>
</span><span id=__span-21-94><span class=w>            </span><span class=p>}</span>
</span><span id=__span-21-95><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-96>
</span><span id=__span-21-97><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>push_back</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=n>ch</span><span class=p>)</span>
</span><span id=__span-21-98><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-99><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_size</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=n>_capacity</span><span class=p>)</span>
</span><span id=__span-21-100><span class=w>            </span><span class=p>{</span>
</span><span id=__span-21-101><span class=w>                </span><span class=kt>size_t</span><span class=w> </span><span class=n>newcapacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_capacity</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>4</span><span class=err>：</span><span class=n>_capacity</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>2</span><span class=p>;</span>
</span><span id=__span-21-102><span class=w>                </span><span class=n>reserve</span><span class=p>(</span><span class=n>newcapacity</span><span class=p>);</span>
</span><span id=__span-21-103><span class=w>            </span><span class=p>}</span>
</span><span id=__span-21-104>
</span><span id=__span-21-105><span class=w>            </span><span class=n>_str</span><span class=p>[</span><span class=n>_size</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ch</span><span class=p>;</span>
</span><span id=__span-21-106><span class=w>            </span><span class=o>++</span><span class=n>_size</span><span class=p>;</span>
</span><span id=__span-21-107><span class=w>            </span><span class=n>_str</span><span class=p>[</span><span class=n>_size</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span><span id=__span-21-108><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-109>
</span><span id=__span-21-110><span class=w>        </span><span class=c1>//string operator+=(char ch)</span>
</span><span id=__span-21-111><span class=w>        </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>+=</span><span class=p>(</span><span class=kt>char</span><span class=w> </span><span class=n>ch</span><span class=p>)</span>
</span><span id=__span-21-112><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-113><span class=w>            </span><span class=n>push_back</span><span class=p>(</span><span class=n>ch</span><span class=p>);</span>
</span><span id=__span-21-114><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-21-115><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-116>
</span><span id=__span-21-117><span class=w>    </span><span class=k>private</span><span class=o>:</span>
</span><span id=__span-21-118><span class=w>        </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>_str</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>nullptr</span><span class=p>;</span>
</span><span id=__span-21-119><span class=w>        </span><span class=kt>size_t</span><span class=w> </span><span class=n>_size</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-21-120><span class=w>        </span><span class=kt>size_t</span><span class=w> </span><span class=n>_capacity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=c1>// 不包含最后做标识的\0</span>
</span><span id=__span-21-121><span class=w>    </span><span class=p>};</span>
</span><span id=__span-21-122>
</span><span id=__span-21-123><span class=w>    </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>to_string</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-21-124><span class=w>    </span><span class=p>{</span>
</span><span id=__span-21-125><span class=w>        </span><span class=kt>bool</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-21-126><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-21-127><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-128><span class=w>            </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-21-129><span class=w>            </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>value</span><span class=p>;</span>
</span><span id=__span-21-130><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-131><span class=w>        </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>str</span><span class=p>;</span>
</span><span id=__span-21-132>
</span><span id=__span-21-133><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-21-134><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-135><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-21-136><span class=w>            </span><span class=n>value</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-21-137><span class=w>            </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=p>(</span><span class=sc>&#39;0&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-21-138><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-139>
</span><span id=__span-21-140><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>flag</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>false</span><span class=p>)</span>
</span><span id=__span-21-141><span class=w>        </span><span class=p>{</span>
</span><span id=__span-21-142><span class=w>            </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=sc>&#39;-&#39;</span><span class=p>;</span>
</span><span id=__span-21-143><span class=w>        </span><span class=p>}</span>
</span><span id=__span-21-144>
</span><span id=__span-21-145><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>reverse</span><span class=p>(</span><span class=n>str</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>str</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-21-146>
</span><span id=__span-21-147><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>str</span><span class=p>;</span>
</span><span id=__span-21-148><span class=w>    </span><span class=p>}</span>
</span><span id=__span-21-149><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> <h4 id=_12>拷贝构造函数与移动构造函数<a class=headerlink href=#_12 title="Permanent link">&para;</a></h4> <p>在前面对于需要深拷贝的类来说，需要自己写类的拷贝构造函数，在没有移动构造函数时，只要是涉及到对象的拷贝都会调用拷贝构造函数，包括但不限于返回临时对象，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-22-1><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=nf>to_string</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>value</span><span class=p>)</span>
</span><span id=__span-22-2><span class=p>{</span>
</span><span id=__span-22-3><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-22-4><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-22-5><span class=w>    </span><span class=p>{</span>
</span><span id=__span-22-6><span class=w>        </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-22-7><span class=w>        </span><span class=n>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>value</span><span class=p>;</span>
</span><span id=__span-22-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-22-9><span class=w>    </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>str</span><span class=p>;</span>
</span><span id=__span-22-10>
</span><span id=__span-22-11><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-22-12><span class=w>    </span><span class=p>{</span>
</span><span id=__span-22-13><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-22-14><span class=w>        </span><span class=n>value</span><span class=w> </span><span class=o>/=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-22-15><span class=w>        </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=p>(</span><span class=sc>&#39;0&#39;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-22-16><span class=w>    </span><span class=p>}</span>
</span><span id=__span-22-17>
</span><span id=__span-22-18><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>flag</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>false</span><span class=p>)</span>
</span><span id=__span-22-19><span class=w>    </span><span class=p>{</span>
</span><span id=__span-22-20><span class=w>        </span><span class=n>str</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=sc>&#39;-&#39;</span><span class=p>;</span>
</span><span id=__span-22-21><span class=w>    </span><span class=p>}</span>
</span><span id=__span-22-22>
</span><span id=__span-22-23><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>reverse</span><span class=p>(</span><span class=n>str</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>str</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-22-24>
</span><span id=__span-22-25><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>str</span><span class=p>;</span>
</span><span id=__span-22-26><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>上面的代码中模拟实现了<code>to_string</code>函数，函数返回一个<code>simulate_string::string</code>类的对象<code>str</code>，调用该函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-23-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-23-2><span class=p>{</span>
</span><span id=__span-23-3><span class=w>    </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>to_string</span><span class=p>(</span><span class=mi>123</span><span class=p>);</span>
</span><span id=__span-23-4>
</span><span id=__span-23-5><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-23-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在编译器没有优化并且只有一个拷贝构造函数时，当执行<code>main</code>函数中的第一条语句时，执行过程如下：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image2.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image2.png"></a></p> <p>当编译器检测到当前写法<code>simulate_string::string s = simulate_string::to_string(123);</code>时，会进行优化，所以执行过程优化为直接调用拷贝构造函数构造对象<code>s</code>，如下图所示：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image3.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image3.png"></a></p> <p>但是，进入拷贝构造函数中拷贝<code>str</code>的内容会存在一定的空间和时间消耗，所以为了解决这个问题，可以采用移动拷贝构造，移动拷贝构造本质就是利用了右值引用。<code>str</code>返回时，在未被编译器优化的情况下会生成一个临时对象，这个临时对象会进行一次拷贝，但因为临时对象是属于将亡值，所以使用右值引用的移动构造会更加方便且高效，只需要将临时对象中的值和现有对象中的值进行交换即可，移动构造如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-24-1><span class=c1>// 移动构造</span>
</span><span id=__span-24-2><span class=n>string</span><span class=p>(</span><span class=n>string</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-24-3><span class=p>{</span>
</span><span id=__span-24-4><span class=w>    </span><span class=n>swap</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span><span id=__span-24-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>有了移动构造函数以后，对于需要使用返回的临时对象进行拷贝构造时就会直接走移动构造，从而减少原来拷贝构造的消耗</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意的是，为了确保可以交换成功形式参数不可以使用<code>const</code>修饰</p> </div> <p>在C++ 11中，构造函数也包括了移动构造，例如string类中的移动构造：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image4.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image4.png"></a></p> <h4 id=_13>赋值重载函数与移动赋值重载函数<a class=headerlink href=#_13 title="Permanent link">&para;</a></h4> <p>上面的移动构造只解决了在拷贝临时对象时会调用拷贝构造函数产生的消耗问题，如果<code>main</code>函数的代码修改为如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-25-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-25-2><span class=p>{</span>
</span><span id=__span-25-3><span class=w>    </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>s</span><span class=p>;</span>
</span><span id=__span-25-4><span class=w>    </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>simulate_string</span><span class=o>::</span><span class=n>to_string</span><span class=p>(</span><span class=mi>123</span><span class=p>);</span>
</span><span id=__span-25-5>
</span><span id=__span-25-6><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-25-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>此时移动构造就无法解决问题，因为是赋值符号重载函数与临时对象之间的关系，同样，当编译器未进行优化时会进行下面的过程：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image5.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image5.png"></a></p> <p>当编译器优化后，会直接调用一次赋值重载函数，用<code>str</code>对象为<code>s</code>对象赋值</p> <p>但是尽管编译器进行了优化，赋值重载函数因为是将<code>str</code>中的内容深拷贝给<code>s</code>对象，所以依旧会产生开销，当对象很大时，开销也会变得很大。因为<code>str</code>是将亡值，所以可以采用右值引用的方式，重载一个新的赋值重载函数如下，同样只需要交换一下将亡值和当前对象中的内容即可：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-26-1><span class=c1>// 移动赋值</span>
</span><span id=__span-26-2><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=n>string</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span>
</span><span id=__span-26-3><span class=p>{</span>
</span><span id=__span-26-4><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;string&amp; operator=(string&amp;&amp; s) -- 移动赋值&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-26-5>
</span><span id=__span-26-6><span class=w>    </span><span class=n>swap</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span><span id=__span-26-7><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-26-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在C++ 11中，赋值重载函数也包括了移动赋值重载函数，例如string类中的移动赋值重载函数：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image6.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image6.png"></a></p> <h4 id=_14>元素插入相关函数<a class=headerlink href=#_14 title="Permanent link">&para;</a></h4> <p>以模拟实现的list类为例</p> <details class=quote> <summary>模拟实现list代码</summary> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span>
<span class=normal>154</span>
<span class=normal>155</span>
<span class=normal>156</span>
<span class=normal>157</span>
<span class=normal>158</span>
<span class=normal>159</span>
<span class=normal>160</span>
<span class=normal>161</span>
<span class=normal>162</span>
<span class=normal>163</span>
<span class=normal>164</span>
<span class=normal>165</span>
<span class=normal>166</span>
<span class=normal>167</span>
<span class=normal>168</span>
<span class=normal>169</span>
<span class=normal>170</span>
<span class=normal>171</span>
<span class=normal>172</span>
<span class=normal>173</span>
<span class=normal>174</span>
<span class=normal>175</span>
<span class=normal>176</span>
<span class=normal>177</span>
<span class=normal>178</span>
<span class=normal>179</span>
<span class=normal>180</span>
<span class=normal>181</span>
<span class=normal>182</span>
<span class=normal>183</span>
<span class=normal>184</span>
<span class=normal>185</span>
<span class=normal>186</span>
<span class=normal>187</span>
<span class=normal>188</span>
<span class=normal>189</span>
<span class=normal>190</span>
<span class=normal>191</span>
<span class=normal>192</span>
<span class=normal>193</span>
<span class=normal>194</span>
<span class=normal>195</span>
<span class=normal>196</span>
<span class=normal>197</span>
<span class=normal>198</span>
<span class=normal>199</span>
<span class=normal>200</span>
<span class=normal>201</span>
<span class=normal>202</span>
<span class=normal>203</span>
<span class=normal>204</span>
<span class=normal>205</span>
<span class=normal>206</span>
<span class=normal>207</span>
<span class=normal>208</span>
<span class=normal>209</span>
<span class=normal>210</span>
<span class=normal>211</span>
<span class=normal>212</span>
<span class=normal>213</span>
<span class=normal>214</span>
<span class=normal>215</span>
<span class=normal>216</span>
<span class=normal>217</span>
<span class=normal>218</span>
<span class=normal>219</span>
<span class=normal>220</span>
<span class=normal>221</span>
<span class=normal>222</span>
<span class=normal>223</span>
<span class=normal>224</span>
<span class=normal>225</span>
<span class=normal>226</span>
<span class=normal>227</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-27-1><span class=cp>#pragma once</span>
</span><span id=__span-27-2>
</span><span id=__span-27-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-27-4><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;assert.h&gt;</span>
</span><span id=__span-27-5><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
</span><span id=__span-27-6>
</span><span id=__span-27-7><span class=k>namespace</span><span class=w> </span><span class=nn>simulate_list</span>
</span><span id=__span-27-8><span class=p>{</span>
</span><span id=__span-27-9><span class=w>    </span><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-27-10><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>ListNode</span>
</span><span id=__span-27-11><span class=w>    </span><span class=p>{</span>
</span><span id=__span-27-12><span class=w>        </span><span class=n>ListNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;*</span><span class=w> </span><span class=n>_next</span><span class=p>;</span>
</span><span id=__span-27-13><span class=w>        </span><span class=n>ListNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;*</span><span class=w> </span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-27-14>
</span><span id=__span-27-15><span class=w>        </span><span class=n>T</span><span class=w> </span><span class=n>_data</span><span class=p>;</span>
</span><span id=__span-27-16>
</span><span id=__span-27-17><span class=w>        </span><span class=n>ListNode</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=w> </span><span class=n>data</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>T</span><span class=p>())</span>
</span><span id=__span-27-18><span class=w>            </span><span class=o>:</span><span class=n>_next</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-27-19><span class=w>            </span><span class=p>,</span><span class=w> </span><span class=n>_prev</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-27-20><span class=w>            </span><span class=p>,</span><span class=w> </span><span class=n>_data</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-27-21><span class=w>        </span><span class=p>{}</span>
</span><span id=__span-27-22><span class=w>    </span><span class=p>};</span>
</span><span id=__span-27-23>
</span><span id=__span-27-24><span class=w>    </span><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=nc>Ref</span><span class=p>,</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=nc>Ptr</span><span class=o>&gt;</span>
</span><span id=__span-27-25><span class=w>    </span><span class=k>struct</span><span class=w> </span><span class=nc>ListIterator</span>
</span><span id=__span-27-26><span class=w>    </span><span class=p>{</span>
</span><span id=__span-27-27><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=n>ListNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>Node</span><span class=p>;</span>
</span><span id=__span-27-28><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=n>ListIterator</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=n>Ref</span><span class=p>,</span><span class=w> </span><span class=n>Ptr</span><span class=o>&gt;</span><span class=w> </span><span class=n>Self</span><span class=p>;</span>
</span><span id=__span-27-29><span class=w>        </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-27-30>
</span><span id=__span-27-31><span class=w>        </span><span class=n>ListIterator</span><span class=p>(</span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>node</span><span class=p>)</span>
</span><span id=__span-27-32><span class=w>            </span><span class=o>:</span><span class=n>_node</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
</span><span id=__span-27-33><span class=w>        </span><span class=p>{}</span>
</span><span id=__span-27-34>
</span><span id=__span-27-35><span class=w>        </span><span class=c1>// ++it;</span>
</span><span id=__span-27-36><span class=w>        </span><span class=n>Self</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>++</span><span class=p>()</span>
</span><span id=__span-27-37><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-38><span class=w>            </span><span class=n>_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_next</span><span class=p>;</span>
</span><span id=__span-27-39><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-27-40><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-41>
</span><span id=__span-27-42><span class=w>        </span><span class=n>Self</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>--</span><span class=p>()</span>
</span><span id=__span-27-43><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-44><span class=w>            </span><span class=n>_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-27-45><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-27-46><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-47>
</span><span id=__span-27-48><span class=w>        </span><span class=n>Self</span><span class=w> </span><span class=k>operator</span><span class=o>++</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span><span id=__span-27-49><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-50><span class=w>            </span><span class=n>Self</span><span class=w> </span><span class=nf>tmp</span><span class=p>(</span><span class=o>*</span><span class=k>this</span><span class=p>);</span>
</span><span id=__span-27-51><span class=w>            </span><span class=n>_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_next</span><span class=p>;</span>
</span><span id=__span-27-52>
</span><span id=__span-27-53><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span>
</span><span id=__span-27-54><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-55>
</span><span id=__span-27-56><span class=w>        </span><span class=n>Self</span><span class=o>&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>--</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span>
</span><span id=__span-27-57><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-58><span class=w>            </span><span class=n>Self</span><span class=w> </span><span class=nf>tmp</span><span class=p>(</span><span class=o>*</span><span class=k>this</span><span class=p>);</span>
</span><span id=__span-27-59><span class=w>            </span><span class=n>_node</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-27-60>
</span><span id=__span-27-61><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>tmp</span><span class=p>;</span>
</span><span id=__span-27-62><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-63>
</span><span id=__span-27-64><span class=w>        </span><span class=n>Ref</span><span class=w> </span><span class=k>operator</span><span class=o>*</span><span class=p>()</span>
</span><span id=__span-27-65><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-66><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_data</span><span class=p>;</span>
</span><span id=__span-27-67><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-68>
</span><span id=__span-27-69><span class=w>        </span><span class=n>Ptr</span><span class=w> </span><span class=k>operator</span><span class=o>-&gt;</span><span class=p>()</span>
</span><span id=__span-27-70><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-71><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>&amp;</span><span class=n>_node</span><span class=o>-&gt;</span><span class=n>_data</span><span class=p>;</span>
</span><span id=__span-27-72><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-73>
</span><span id=__span-27-74><span class=w>        </span><span class=kt>bool</span><span class=w> </span><span class=k>operator</span><span class=o>!=</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Self</span><span class=o>&amp;</span><span class=w> </span><span class=n>it</span><span class=p>)</span>
</span><span id=__span-27-75><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-76><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_node</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>it</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-27-77><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-78>
</span><span id=__span-27-79><span class=w>        </span><span class=kt>bool</span><span class=w> </span><span class=k>operator</span><span class=o>==</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>Self</span><span class=o>&amp;</span><span class=w> </span><span class=n>it</span><span class=p>)</span>
</span><span id=__span-27-80><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-81><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_node</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=n>it</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-27-82><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-83><span class=w>    </span><span class=p>};</span>
</span><span id=__span-27-84>
</span><span id=__span-27-85><span class=w>    </span><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-27-86><span class=w>    </span><span class=k>class</span><span class=w> </span><span class=nc>list</span>
</span><span id=__span-27-87><span class=w>    </span><span class=p>{</span>
</span><span id=__span-27-88><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=n>ListNode</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>Node</span><span class=p>;</span>
</span><span id=__span-27-89><span class=w>    </span><span class=k>public</span><span class=o>:</span>
</span><span id=__span-27-90>
</span><span id=__span-27-91><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=n>ListIterator</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>*&gt;</span><span class=w> </span><span class=n>iterator</span><span class=p>;</span>
</span><span id=__span-27-92><span class=w>        </span><span class=k>typedef</span><span class=w> </span><span class=n>ListIterator</span><span class=o>&lt;</span><span class=n>T</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>*&gt;</span><span class=w> </span><span class=n>const_iterator</span><span class=p>;</span>
</span><span id=__span-27-93>
</span><span id=__span-27-94><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=nf>begin</span><span class=p>()</span>
</span><span id=__span-27-95><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-96><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>iterator</span><span class=p>(</span><span class=n>_head</span><span class=o>-&gt;</span><span class=n>_next</span><span class=p>);</span>
</span><span id=__span-27-97><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-98>
</span><span id=__span-27-99><span class=w>        </span><span class=n>const_iterator</span><span class=w> </span><span class=nf>begin</span><span class=p>()</span><span class=w> </span><span class=k>const</span>
</span><span id=__span-27-100><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-101><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>const_iterator</span><span class=p>(</span><span class=n>_head</span><span class=o>-&gt;</span><span class=n>_next</span><span class=p>);</span>
</span><span id=__span-27-102><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-103>
</span><span id=__span-27-104><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=nf>end</span><span class=p>()</span>
</span><span id=__span-27-105><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-106><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>iterator</span><span class=p>(</span><span class=n>_head</span><span class=p>);</span>
</span><span id=__span-27-107><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-108>
</span><span id=__span-27-109><span class=w>        </span><span class=n>const_iterator</span><span class=w> </span><span class=nf>end</span><span class=p>()</span><span class=w> </span><span class=k>const</span>
</span><span id=__span-27-110><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-111><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>const_iterator</span><span class=p>(</span><span class=n>_head</span><span class=p>);</span>
</span><span id=__span-27-112><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-113>
</span><span id=__span-27-114><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=nf>empty_init</span><span class=p>()</span>
</span><span id=__span-27-115><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-116><span class=w>            </span><span class=n>_head</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Node</span><span class=p>();</span>
</span><span id=__span-27-117><span class=w>            </span><span class=n>_head</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_head</span><span class=p>;</span>
</span><span id=__span-27-118><span class=w>            </span><span class=n>_head</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>_head</span><span class=p>;</span>
</span><span id=__span-27-119><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-120>
</span><span id=__span-27-121><span class=w>        </span><span class=n>list</span><span class=p>()</span>
</span><span id=__span-27-122><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-123><span class=w>            </span><span class=n>empty_init</span><span class=p>();</span>
</span><span id=__span-27-124><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-125>
</span><span id=__span-27-126><span class=w>        </span><span class=n>list</span><span class=p>(</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>il</span><span class=p>)</span>
</span><span id=__span-27-127><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-128><span class=w>            </span><span class=n>empty_init</span><span class=p>();</span>
</span><span id=__span-27-129>
</span><span id=__span-27-130><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>e</span><span class=err>：</span><span class=n>il</span><span class=p>)</span>
</span><span id=__span-27-131><span class=w>            </span><span class=p>{</span>
</span><span id=__span-27-132><span class=w>                </span><span class=n>push_back</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
</span><span id=__span-27-133><span class=w>            </span><span class=p>}</span>
</span><span id=__span-27-134><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-135>
</span><span id=__span-27-136><span class=w>        </span><span class=c1>// lt2(lt1)</span>
</span><span id=__span-27-137><span class=w>        </span><span class=n>list</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>list</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=n>lt</span><span class=p>)</span>
</span><span id=__span-27-138><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-139><span class=w>            </span><span class=n>empty_init</span><span class=p>();</span>
</span><span id=__span-27-140>
</span><span id=__span-27-141><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=k>auto</span><span class=o>&amp;</span><span class=w> </span><span class=n>e</span><span class=err>：</span><span class=n>lt</span><span class=p>)</span>
</span><span id=__span-27-142><span class=w>            </span><span class=p>{</span>
</span><span id=__span-27-143><span class=w>                </span><span class=n>push_back</span><span class=p>(</span><span class=n>e</span><span class=p>);</span>
</span><span id=__span-27-144><span class=w>            </span><span class=p>}</span>
</span><span id=__span-27-145><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-146>
</span><span id=__span-27-147><span class=w>        </span><span class=c1>// lt1 = lt3</span>
</span><span id=__span-27-148><span class=w>        </span><span class=n>list</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;&amp;</span><span class=w> </span><span class=k>operator</span><span class=o>=</span><span class=p>(</span><span class=n>list</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>lt</span><span class=p>)</span>
</span><span id=__span-27-149><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-150><span class=w>            </span><span class=n>swap</span><span class=p>(</span><span class=n>_head</span><span class=p>,</span><span class=w> </span><span class=n>lt</span><span class=p>.</span><span class=n>_head</span><span class=p>);</span>
</span><span id=__span-27-151>
</span><span id=__span-27-152><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=o>*</span><span class=k>this</span><span class=p>;</span>
</span><span id=__span-27-153><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-154>
</span><span id=__span-27-155><span class=w>        </span><span class=o>~</span><span class=n>list</span><span class=p>()</span>
</span><span id=__span-27-156><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-157><span class=w>            </span><span class=n>clear</span><span class=p>();</span>
</span><span id=__span-27-158><span class=w>            </span><span class=k>delete</span><span class=w> </span><span class=n>_head</span><span class=p>;</span>
</span><span id=__span-27-159><span class=w>            </span><span class=n>_head</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>nullptr</span><span class=p>;</span>
</span><span id=__span-27-160><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-161>
</span><span id=__span-27-162><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>clear</span><span class=p>()</span>
</span><span id=__span-27-163><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-164><span class=w>            </span><span class=k>auto</span><span class=w> </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>begin</span><span class=p>();</span>
</span><span id=__span-27-165><span class=w>            </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>it</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>end</span><span class=p>())</span>
</span><span id=__span-27-166><span class=w>            </span><span class=p>{</span>
</span><span id=__span-27-167><span class=w>                </span><span class=n>it</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>erase</span><span class=p>(</span><span class=n>it</span><span class=p>);</span>
</span><span id=__span-27-168><span class=w>            </span><span class=p>}</span>
</span><span id=__span-27-169><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-170>
</span><span id=__span-27-171><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>push_back</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-27-172><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-173><span class=w>            </span><span class=n>insert</span><span class=p>(</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-27-174><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-175>
</span><span id=__span-27-176><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>pop_back</span><span class=p>()</span>
</span><span id=__span-27-177><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-178><span class=w>            </span><span class=n>erase</span><span class=p>(</span><span class=o>--</span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-27-179><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-180>
</span><span id=__span-27-181><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>push_front</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-27-182><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-183><span class=w>            </span><span class=n>insert</span><span class=p>(</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-27-184><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-185>
</span><span id=__span-27-186><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>pop_front</span><span class=p>()</span>
</span><span id=__span-27-187><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-188><span class=w>            </span><span class=n>erase</span><span class=p>(</span><span class=n>begin</span><span class=p>());</span>
</span><span id=__span-27-189><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-190>
</span><span id=__span-27-191><span class=w>        </span><span class=c1>// 没有iterator失效</span>
</span><span id=__span-27-192><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=n>insert</span><span class=p>(</span><span class=n>iterator</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>T</span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-27-193><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-194><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>cur</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-27-195><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>newnode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Node</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-27-196><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-27-197>
</span><span id=__span-27-198><span class=w>            </span><span class=c1>// prev  newnode  cur</span>
</span><span id=__span-27-199><span class=w>            </span><span class=n>prev</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>newnode</span><span class=p>;</span>
</span><span id=__span-27-200><span class=w>            </span><span class=n>newnode</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>prev</span><span class=p>;</span>
</span><span id=__span-27-201><span class=w>            </span><span class=n>newnode</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=p>;</span>
</span><span id=__span-27-202><span class=w>            </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>newnode</span><span class=p>;</span>
</span><span id=__span-27-203>
</span><span id=__span-27-204><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>iterator</span><span class=p>(</span><span class=n>newnode</span><span class=p>);</span>
</span><span id=__span-27-205><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-206>
</span><span id=__span-27-207><span class=w>        </span><span class=c1>// erase 后 pos失效了，pos指向节点被释放了</span>
</span><span id=__span-27-208><span class=w>        </span><span class=n>iterator</span><span class=w> </span><span class=n>erase</span><span class=p>(</span><span class=n>iterator</span><span class=w> </span><span class=n>pos</span><span class=p>)</span>
</span><span id=__span-27-209><span class=w>        </span><span class=p>{</span>
</span><span id=__span-27-210><span class=w>            </span><span class=n>assert</span><span class=p>(</span><span class=n>pos</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-27-211>
</span><span id=__span-27-212><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>cur</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-27-213><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-27-214><span class=w>            </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_next</span><span class=p>;</span>
</span><span id=__span-27-215>
</span><span id=__span-27-216><span class=w>            </span><span class=n>prev</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>next</span><span class=p>;</span>
</span><span id=__span-27-217><span class=w>            </span><span class=n>next</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>prev</span><span class=p>;</span>
</span><span id=__span-27-218>
</span><span id=__span-27-219><span class=w>            </span><span class=k>delete</span><span class=w> </span><span class=n>cur</span><span class=p>;</span>
</span><span id=__span-27-220>
</span><span id=__span-27-221><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>iterator</span><span class=p>(</span><span class=n>next</span><span class=p>);</span>
</span><span id=__span-27-222><span class=w>        </span><span class=p>}</span>
</span><span id=__span-27-223>
</span><span id=__span-27-224><span class=w>    </span><span class=k>private</span><span class=o>:</span>
</span><span id=__span-27-225><span class=w>        </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>_head</span><span class=p>;</span>
</span><span id=__span-27-226><span class=w>    </span><span class=p>};</span>
</span><span id=__span-27-227><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> <p>当在<code>main</code>函数中创建对象后进行尾插：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-28-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-28-2><span class=p>{</span>
</span><span id=__span-28-3><span class=w>    </span><span class=n>simulate_list</span><span class=o>::</span><span class=n>list</span><span class=o>&lt;</span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>ls</span><span class=p>;</span>
</span><span id=__span-28-4>
</span><span id=__span-28-5><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=s>&quot;11111&quot;</span><span class=p>);</span>
</span><span id=__span-28-6>
</span><span id=__span-28-7><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-28-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>因为<code>"1111"</code>属于常量字符串，属于右值，在<code>push_back</code>函数中会调用<code>Node</code>节点的构造函数初始化<code>_data</code>，而因为<code>_data</code>是<code>simulate_string</code>类型的，所以会调用对应的构造函数将其转化为<code>simulate_string</code>类型，接着再链接，但是整个过程会涉及到<code>simulate_string</code>类的拷贝构造函数，并且因为<code>_data</code>是左值，所以在进入<code>simulate_string</code>类后也是左值，就不会调用前面的移动拷贝构造函数，这个现象也称为右值退化为左值，为了解决这个问题，首先需要修改push_back函数，将<code>"11111"</code>识别为右值，所以需要使用右值引用作为<code>push_back</code>函数的形式参数，所以push_back函数需要重载一份为如下形式：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-29-1><span class=kt>void</span><span class=w> </span><span class=nf>push_back</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-29-2><span class=p>{</span>
</span><span id=__span-29-3><span class=w>    </span><span class=n>insert</span><span class=p>(</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-29-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着，因为<code>push_back</code>底层调用的还是<code>insert</code>函数，所以<code>insert</code>函数的形式参数也需要重载一份为如下形式：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-30-1><span class=n>iterator</span><span class=w> </span><span class=nf>insert</span><span class=p>(</span><span class=n>iterator</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-30-2><span class=p>{</span>
</span><span id=__span-30-3><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>cur</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-30-4><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>newnode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Node</span><span class=p>(</span><span class=n>x</span><span class=p>);</span>
</span><span id=__span-30-5><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=p>;</span>
</span><span id=__span-30-6>
</span><span id=__span-30-7><span class=w>    </span><span class=c1>// prev  newnode  cur</span>
</span><span id=__span-30-8><span class=w>    </span><span class=n>prev</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>newnode</span><span class=p>;</span>
</span><span id=__span-30-9><span class=w>    </span><span class=n>newnode</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>prev</span><span class=p>;</span>
</span><span id=__span-30-10><span class=w>    </span><span class=n>newnode</span><span class=o>-&gt;</span><span class=n>_next</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cur</span><span class=p>;</span>
</span><span id=__span-30-11><span class=w>    </span><span class=n>cur</span><span class=o>-&gt;</span><span class=n>_prev</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>newnode</span><span class=p>;</span>
</span><span id=__span-30-12>
</span><span id=__span-30-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>iterator</span><span class=p>(</span><span class=n>newnode</span><span class=p>);</span>
</span><span id=__span-30-14><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>但是，仅仅修改这两个函数的形式参数并不能解决问题，首先看<code>push_back</code>函数，因为底层调用的是<code>insert</code>函数，所以需要将<code>push_back</code>的右值引用<code>x</code>接收到的值继续传递给<code>insert</code>函数，此时需要注意，右值引用本身还是左值，所以传递给<code>insert</code>函数参数的<code>x</code>依旧还是左值，此时尽管写了重载右值引用的<code>insert</code>函数，依旧会调用左值引用的<code>insert</code>函数，所以需要对<code>push_back</code>函数进行进一步的修改，如下形式：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-31-1><span class=kt>void</span><span class=w> </span><span class=nf>push_back</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-31-2><span class=p>{</span>
</span><span id=__span-31-3><span class=w>    </span><span class=n>insert</span><span class=p>(</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>move</span><span class=p>(</span><span class=n>x</span><span class=p>));</span><span class=c1>// 将左值的右值引用转化为右值的右值引用</span>
</span><span id=__span-31-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着到<code>insert</code>函数，在<code>push_back</code>函数修改为上述形式后，此时调用的<code>insert</code>函数即为重载右值引用的版本，接下来创建节点，此时依旧是同样的问题，<code>x</code>是右值引用，但是本身是左值，所以传递给<code>Node</code>节点的构造函数时也依旧是左值，所以同样需要将其转化为右值，如下形式：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-32-1><span class=n>iterator</span><span class=w> </span><span class=nf>insert</span><span class=p>(</span><span class=n>iterator</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-32-2><span class=p>{</span>
</span><span id=__span-32-3><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>cur</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-32-4><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>newnode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Node</span><span class=p>(</span><span class=n>x</span><span class=p>);</span><span class=c1>// 将左值的右值引用转化为右值的右值引用</span>
</span><span id=__span-32-5><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-32-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着是<code>Node</code>节点的构造函数，当前情况下只有一个左值引用版本的构造函数，所以需要重载一个右值引用版本，如下形式：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-33-1><span class=n>ListNode</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-33-2><span class=w>    </span><span class=o>:</span><span class=n>_next</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-33-3><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_prev</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-33-4><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_data</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-33-5><span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> <p>但是上面的代码依旧是同样的问题，形式参数<code>data</code>是右值引用，但本身是左值，所以需要将<code>data</code>转化为右值，修改为：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-34-1><span class=n>ListNode</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-34-2><span class=w>    </span><span class=o>:</span><span class=n>_next</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-34-3><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_prev</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-34-4><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_data</span><span class=p>(</span><span class=n>move</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span><span id=__span-34-5><span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> <p>此时再调用<code>simulate_string</code>类的构造函数时，就会只调用移动拷贝构造函数</p> <p>在C++ 11中，元素插入相关的函数也包括了右值引用的版本，例如list类中的右值引用版本的<code>push_back</code>函数：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image7.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image7.png"></a></p> <h2 id=_15>万能引用与完美转发<a class=headerlink href=#_15 title="Permanent link">&para;</a></h2> <h3 id=_16>万能引用<a class=headerlink href=#_16 title="Permanent link">&para;</a></h3> <p>万能引用可以将在函数模版中使用，形式如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-35-1><span class=c1>// 万能引用</span>
</span><span id=__span-35-2><span class=k>template</span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-35-3><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-35-4><span class=p>{</span>
</span><span id=__span-35-5>
</span><span id=__span-35-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在上面的代码中，<code>T&amp;&amp;</code>是一个万能引用，当传递左值时，<code>T</code>被推导为左值引用，当传递右值时，<code>T</code>被推导为右值引用，但是不论<code>T</code>被推导为左值引用还是右值引用，形参<code>t</code>本身依旧是左值，所以当需要再向下传递需要使用到右值时，依旧需要将<code>t</code>进行转化，例如下面的例子：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-36-1><span class=c1>// 查看引用类型</span>
</span><span id=__span-36-2><span class=kt>void</span><span class=w> </span><span class=nf>Func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-36-3><span class=p>{</span><span class=w> </span>
</span><span id=__span-36-4><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;左值引用&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-36-5><span class=p>}</span>
</span><span id=__span-36-6>
</span><span id=__span-36-7><span class=kt>void</span><span class=w> </span><span class=nf>Func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-36-8><span class=p>{</span><span class=w> </span>
</span><span id=__span-36-9><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;右值引用&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-36-10><span class=p>}</span>
</span><span id=__span-36-11>
</span><span id=__span-36-12><span class=c1>// 万能引用</span>
</span><span id=__span-36-13><span class=k>template</span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-36-14><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-36-15><span class=p>{</span>
</span><span id=__span-36-16><span class=w>    </span><span class=c1>// 万能引用的类型推导</span>
</span><span id=__span-36-17><span class=w>    </span><span class=c1>// T&amp;&amp;是一个万能引用，当传递左值时，T被推导为左值引用</span>
</span><span id=__span-36-18><span class=w>    </span><span class=c1>// 当传递右值时，T被推导为右值引用</span>
</span><span id=__span-36-19><span class=w>    </span><span class=n>Func</span><span class=p>(</span><span class=n>t</span><span class=p>);</span>
</span><span id=__span-36-20><span class=p>}</span>
</span><span id=__span-36-21>
</span><span id=__span-36-22><span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span>
</span><span id=__span-36-23><span class=p>{</span>
</span><span id=__span-36-24><span class=w>    </span><span class=c1>// 左值传递给func函数</span>
</span><span id=__span-36-25><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-36-26><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span><span id=__span-36-27><span class=w>    </span><span class=c1>// 右值传递给func函数</span>
</span><span id=__span-36-28><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=mi>20</span><span class=p>);</span>
</span><span id=__span-36-29><span class=w>    </span><span class=c1>// 将左值move为右值</span>
</span><span id=__span-36-30><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>move</span><span class=p>(</span><span class=n>a</span><span class=p>));</span>
</span><span id=__span-36-31>
</span><span id=__span-36-32><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-36-33><span class=p>}</span>
</span><span id=__span-36-34>
</span><span id=__span-36-35><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-36-36><span class=n>左值引用</span>
</span><span id=__span-36-37><span class=n>左值引用</span>
</span><span id=__span-36-38><span class=n>左值引用</span>
</span></code></pre></div></td></tr></table></div> <p>此时不论<code>t</code>是左值引用还是右值引用，<code>t</code>本身都是左值，所以传递给<code>Func</code>函数只会走打印“左值引用”的部分，如果使用<code>move</code>对形参<code>t</code>进行转化，那么只会走打印“右值引用”的<code>Func</code>函数，为了解决这个问题，可以使用完美转发</p> <h3 id=_17>完美转发<a class=headerlink href=#_17 title="Permanent link">&para;</a></h3> <p>完美转发可以将变量原有的类型传递给下一层，如果本身是左值引用，则完美转发后就是左值引用，如果本身是右值引用，则完美转发后就是右值引用，所以上面的代码可以写成：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-37-1><span class=c1>// 查看引用类型</span>
</span><span id=__span-37-2><span class=kt>void</span><span class=w> </span><span class=nf>Func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-37-3><span class=p>{</span><span class=w> </span>
</span><span id=__span-37-4><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;左值引用&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-37-5><span class=p>}</span>
</span><span id=__span-37-6>
</span><span id=__span-37-7><span class=kt>void</span><span class=w> </span><span class=nf>Func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-37-8><span class=p>{</span><span class=w> </span>
</span><span id=__span-37-9><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;右值引用&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=w> </span>
</span><span id=__span-37-10><span class=p>}</span>
</span><span id=__span-37-11>
</span><span id=__span-37-12><span class=c1>// 万能引用</span>
</span><span id=__span-37-13><span class=k>template</span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span>
</span><span id=__span-37-14><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>t</span><span class=p>)</span>
</span><span id=__span-37-15><span class=p>{</span>
</span><span id=__span-37-16><span class=w>    </span><span class=c1>// 使用完美转发</span>
</span><span id=__span-37-17><span class=w>    </span><span class=n>Func</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>t</span><span class=p>));</span>
</span><span id=__span-37-18><span class=p>}</span>
</span><span id=__span-37-19>
</span><span id=__span-37-20><span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span>
</span><span id=__span-37-21><span class=p>{</span>
</span><span id=__span-37-22><span class=w>    </span><span class=c1>// 左值传递给func函数</span>
</span><span id=__span-37-23><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-37-24><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span><span id=__span-37-25><span class=w>    </span><span class=c1>// 右值传递给func函数</span>
</span><span id=__span-37-26><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=mi>20</span><span class=p>);</span>
</span><span id=__span-37-27><span class=w>    </span><span class=c1>// 将左值move为右值</span>
</span><span id=__span-37-28><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>move</span><span class=p>(</span><span class=n>a</span><span class=p>));</span>
</span><span id=__span-37-29>
</span><span id=__span-37-30><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-37-31><span class=p>}</span>
</span><span id=__span-37-32>
</span><span id=__span-37-33><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-37-34><span class=n>左值引用</span>
</span><span id=__span-37-35><span class=n>右值引用</span>
</span><span id=__span-37-36><span class=n>右值引用</span>
</span></code></pre></div></td></tr></table></div> <p>有了完美转发后，就可以对上面list模拟实现中的插入函数进行修改，前面遇到的问题就是本身是右值，给了右值引用再向下传递时发生右值引用退化为左值引用，所以可以使用完美转发使其按照右值引用的方式传递，以<code>push_back</code>为例</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-38-1><span class=kt>void</span><span class=w> </span><span class=nf>push_back</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>)</span>
</span><span id=__span-38-2><span class=p>{</span>
</span><span id=__span-38-3><span class=w>    </span><span class=n>insert</span><span class=p>(</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span><span class=p>(</span><span class=n>x</span><span class=p>));</span><span class=c1>// 将左值的右值引用转化为右值的右值引用</span>
</span><span id=__span-38-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h2 id=c-11_2>C++ 11新增的两个默认成员函数<a class=headerlink href=#c-11_2 title="Permanent link">&para;</a></h2> <p>在有了移动拷贝构造函数和移动赋值重载函数后，类的默认成员函数从原有的6个变为了现在的8个，对于新增的两个默认成员函数来说，默认的生成规则如下：</p> <ul> <li>移动拷贝构造函数：当<strong>类中没有显式写移动拷贝构造函数并且类中也没有显式写拷贝构造函数、析构函数和赋值重载函数</strong>时，编译器会默认生成移动拷贝构造函数，该函数的行为是，当类中的成员是内置类型时，将会进行值拷贝，当类中的成员是自定义类型时，会调用自定义类型的移动拷贝构造函数，如果自定义类型也没有移动拷贝构造函数，则调用拷贝构造函数</li> <li>移动赋值重载函数：当<strong>类中没有显式写移动赋值重载函数并且类中也没有显式写拷贝构造函数、析构函数和赋值重载函数</strong>时，编译器会默认生成移动赋值重载函数，该函数的行为是，当类中的成员是内置类型时，将会进行值拷贝，当类中的成员是自定义类型时，会调用自定义类型的移动赋值重载函数，如果自定义类型也没有移动赋值重载函数，则调用赋值重载函数</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>理解满足两个条件（1. 没有显式写移动拷贝构造函数 2. 没有显式写拷贝构造函数、析构函数和赋值重载函数）：</p> <p>考虑移动赋值重载函数和移动拷贝构造函数的使用场景：当类中的成员都是内置类型时，没有大型资源释放行为，所以不需要显示写析构函数，此时对于拷贝构造函数和赋值重载函数来说，直接复制原有对象的内容开销也不大，而对于移动拷贝构造函数和移动赋值重载函数来说，目的就是解决拷贝构造函数和赋值重载函数在部分场景下的时间和空间消耗，所以没有拷贝构造函数、析构函数和赋值重载函数代表没有大型的资源释放行为，自然也就可以不会产生大量的时间和空间消耗，所以也就不需要写移动拷贝构造函数和移动赋值重载函数</p> </div> <h3 id=default>生成默认成员函数<code>=default</code><a class=headerlink href=#default title="Permanent link">&para;</a></h3> <p>如果一定要生成默认的移动拷贝构造和移动赋值重载函数时，可以使用<code>=default</code>关键字，例如如果需要默认生成string类的拷贝构造函数，可以写成：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-39-1><span class=n>string</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=o>=</span><span class=k>default</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意的是，如果想让编译器默认生成移动拷贝构造函数和移动赋值重载函数时，一定要有拷贝构造函数、析构函数和赋值重载函数的出现，哪怕是使用<code>=default</code>让移动拷贝构造函数和移动赋值重载函数默认生成，不可以缺少三个默认成员函数的一个，否则无法通过编译</p> </div> <h3 id=delete>不生成默认成员函数<code>=delete</code><a class=headerlink href=#delete title="Permanent link">&para;</a></h3> <p>如果不想编译器默认生成某一个默认成员函数时，可以使用<code>=delete</code>关键字，例如如果不像默认生成string类的拷贝构造函数，可以写成：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-40-1><span class=n>string</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>string</span><span class=o>&amp;</span><span class=w> </span><span class=n>s</span><span class=p>)</span><span class=o>=</span><span class=k>delete</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> <p>在C++ 98中，如果不想一个对象可以通过调用拷贝构造函数和赋值重载函数进行构造可以将对应的拷贝构造函数和赋值重载函数修饰为<code>private</code>，而在有了C++ 11的<code>=delete</code>关键字后，就可以对这两个函数修饰为<code>=delete</code>，而无需在放入<code>private</code>中</p> <h2 id=c-11_3>C++ 11中的可变参数模版<a class=headerlink href=#c-11_3 title="Permanent link">&para;</a></h2> <h3 id=_18>可变参数模版介绍<a class=headerlink href=#_18 title="Permanent link">&para;</a></h3> <p>在C++ 98中，如果一个函数是一个模版函数，那么该函数可以传递的参数个数就由模版参数个数决定，如果传递参数多于或少于（此处不考虑含有缺省参数的情况）规定的模版个数，则编译器无法生成对应的函数</p> <p>在C++ 11中，为了解决上面的问题提出了可变参数的函数模版，基本格式如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-41-1><span class=c1>// 可变参数模版</span>
</span><span id=__span-41-2><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-41-3><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>Args</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-41-4><span class=p>{</span>
</span><span id=__span-41-5>
</span><span id=__span-41-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在上面的代码中使用<code>...</code>代表可变参数，<code>...Args</code>代表模版参数包，<code>... args</code>代表形式参数包，参数包中可以有[0, N] (N &gt;= 0且N为整数)个模版参数，此时编译器会根据传递的参数个数生成对应的函数。</p> <p>如果想要获取函数参数的数量时，可以使用<code>sizeof</code>运算符计算形式参数包，代码如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-42-1><span class=c1>// 可变参数模版</span>
</span><span id=__span-42-2><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-42-3><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>Args</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-42-4><span class=p>{</span>
</span><span id=__span-42-5><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=k>sizeof</span><span class=p>...(</span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-42-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>sizeof</code>计算属于编译时就可以计算的，所以可以直接使用，需要注意省略号的所在位置</p> </div> <p>如果想在函数<code>func</code>中查看传递的参数时则不可以使用遍历等运行时的逻辑进行打印，例如使用<code>for</code>循环</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-43-1><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-43-2><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>Args</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-43-3><span class=p>{</span>
</span><span id=__span-43-4><span class=w>    </span><span class=c1>//cout &lt;&lt; sizeof...(args) &lt;&lt; endl;</span>
</span><span id=__span-43-5><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=k>sizeof</span><span class=p>...(</span><span class=n>args</span><span class=p>);</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-43-6><span class=w>    </span><span class=p>{</span>
</span><span id=__span-43-7><span class=w>        </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>args</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-43-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-43-9><span class=p>}</span>
</span><span id=__span-43-10>
</span><span id=__span-43-11><span class=n>报错信息</span><span class=err>：</span>
</span><span id=__span-43-12><span class=err>&#39;</span><span class=n>args</span><span class=err>&#39;</span><span class=o>:</span><span class=w> </span><span class=n>parameter</span><span class=w> </span><span class=n>pack</span><span class=w> </span><span class=n>must</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>expanded</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=k>this</span><span class=w> </span><span class=n>context</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_19>参数包展开<a class=headerlink href=#_19 title="Permanent link">&para;</a></h3> <p>为了能够展示参数，下面采用两种方法进行显示，以下面的代码为例：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-44-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-44-2><span class=p>{</span>
</span><span id=__span-44-3><span class=w>    </span><span class=c1>// 可变参数模版</span>
</span><span id=__span-44-4><span class=w>    </span><span class=n>func</span><span class=p>();</span>
</span><span id=__span-44-5><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>);</span>
</span><span id=__span-44-6><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=s>&quot;hello&quot;</span><span class=p>,</span><span class=w> </span><span class=mf>3.14</span><span class=p>);</span>
</span><span id=__span-44-7>
</span><span id=__span-44-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-44-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <ol> <li> <p>编译时递归展开参数包</p> <p>编译时递归和运行时递归的最大区别就是不可以使用<code>if</code>语句进行递归结束条件的判断</p> <p>编译时递归展开参数包的思路是：创建一个有可变参数模版的函数<code>func</code>，该模版参数含有两部分，第一个部分是万能引用的单一参数，该部分用于接收每一个参数值，第二个部分是可变参数模版，在函数体内，先打印第一个参数的内容，再调用<code>func</code>函数，传递剩余的参数，用于递归调用，再外侧写一个无参的<code>func</code>函数，该函数作为编译时递归的终止条件</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-45-1><span class=c1>// 递归终止函数</span>
</span><span id=__span-45-2><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>()</span>
</span><span id=__span-45-3><span class=p>{</span>
</span><span id=__span-45-4><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-45-5><span class=p>}</span>
</span><span id=__span-45-6>
</span><span id=__span-45-7><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=p>,</span><span class=w> </span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-45-8><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>T</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=n>Args</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-45-9><span class=p>{</span>
</span><span id=__span-45-10><span class=w>    </span><span class=c1>// 打印当前的x</span>
</span><span id=__span-45-11><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-45-12><span class=w>    </span><span class=c1>// 递归调用打印剩余的参数</span>
</span><span id=__span-45-13><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)...);</span>
</span><span id=__span-45-14><span class=p>}</span>
</span><span id=__span-45-15>
</span><span id=__span-45-16><span class=n>对于上面的测试函数</span><span class=err>，</span><span class=n>结果如下</span><span class=err>：</span>
</span><span id=__span-45-17>
</span><span id=__span-45-18><span class=mi>1</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=mi>3</span>
</span><span id=__span-45-19><span class=mi>1</span><span class=w> </span><span class=n>hello</span><span class=w> </span><span class=mf>3.14</span>
</span></code></pre></div></td></tr></table></div> <p>以第二个测试为例<code>func(1, 2, 3);</code>，上面的代码可以理解为：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-46-1><span class=c1>//4. 第四步</span>
</span><span id=__span-46-2><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>()</span>
</span><span id=__span-46-3><span class=p>{</span>
</span><span id=__span-46-4><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-46-5><span class=p>}</span>
</span><span id=__span-46-6><span class=c1>//3. 第三步</span>
</span><span id=__span-46-7><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-46-8><span class=p>{</span>
</span><span id=__span-46-9><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>z</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-46-10><span class=w>    </span><span class=n>func</span><span class=p>();</span>
</span><span id=__span-46-11><span class=p>}</span>
</span><span id=__span-46-12><span class=c1>//2. 第二步</span>
</span><span id=__span-46-13><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-46-14><span class=p>{</span>
</span><span id=__span-46-15><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>y</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-46-16><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>z</span><span class=p>));</span>
</span><span id=__span-46-17><span class=p>}</span>
</span><span id=__span-46-18><span class=c1>//1. 第一步</span>
</span><span id=__span-46-19><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-46-20><span class=p>{</span>
</span><span id=__span-46-21><span class=w>    </span><span class=c1>// 打印当前的x</span>
</span><span id=__span-46-22><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>x</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-46-23><span class=w>    </span><span class=c1>// 递归调用打印剩余的参数</span>
</span><span id=__span-46-24><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>y</span><span class=p>),</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>z</span><span class=p>));</span>
</span><span id=__span-46-25><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </li> <li> <p>利用数组根据个数初始化数组大小的机制展开参数包</p> <p>该方式的原理是：当一个数组在初始化时，如果不指定数组的大小，编译器会根据数组的元素个数推导出数组的大小，所以可以写为：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-47-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-47-2><span class=kt>void</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=n>Args</span><span class=o>&amp;&amp;</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-47-3><span class=p>{</span>
</span><span id=__span-47-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>arr</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=p>((</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>))...</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-47-5><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-47-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>这个方法需要注意，对于没有实参的函数来说会编译报错，例如<code>func()</code>函数，并且不可以去掉逗号表达式，因为<code>cout</code>的返回值是<code>ostream</code>类型，该类型不支持赋值运算符重载函数</p> </div> <p>上面的方法可以理解为：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-48-1><span class=c1>// 上面的展开可以理解为</span>
</span><span id=__span-48-2><span class=kt>void</span><span class=w> </span><span class=nf>func</span><span class=p>(</span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>x</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>y</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>z</span><span class=p>)</span>
</span><span id=__span-48-3><span class=p>{</span>
</span><span id=__span-48-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>arr</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=p>((</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>x</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)),</span><span class=w> </span><span class=p>((</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>y</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>)),</span><span class=w> </span><span class=p>((</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>forward</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>z</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>))</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-48-5><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-48-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>因为数组在开辟大小是会计算元素的个数，逗号表达式的左右两侧都会进行运算，所以先打印<code>x</code>的值，再执行0，所以第一个表达式的值为0，作为数组的第一个元素，以此类推直到最后一个元素</p> </li> </ol> <h3 id=emplace>可变参数模版的应用<code>emplace</code>系列函数<a class=headerlink href=#emplace title="Permanent link">&para;</a></h3> <p>在前面学习到的容器中，基本上都支持<code>emplace</code>系列的函数，以list类为例，list类中存在一个<code>emplace_back</code>函数，该函数可以支持在list的尾部插入数据，与<code>push_back</code>函数实现的功能基本一致，但是<code>emplace_back</code>函数除了可以支持插入已经构造的对象和单个用于构造对象的值，还可以接受构造函数的参数，直接在list的内存空间中调用该对象的构造函数，避免了额外的拷贝或移动操作。这可以提高效率，尤其是在处理复杂杂对象时，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-49-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-49-2><span class=p>{</span>
</span><span id=__span-49-3><span class=w>    </span><span class=c1>// 插入一个新的对象</span>
</span><span id=__span-49-4><span class=w>    </span><span class=n>list</span><span class=o>&lt;</span><span class=n>string</span><span class=o>&gt;</span><span class=w> </span><span class=n>ls</span><span class=p>;</span>
</span><span id=__span-49-5><span class=w>    </span><span class=n>string</span><span class=w> </span><span class=n>s1</span><span class=p>(</span><span class=s>&quot;1111111&quot;</span><span class=p>);</span>
</span><span id=__span-49-6><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>s1</span><span class=p>);</span>
</span><span id=__span-49-7><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=n>s1</span><span class=p>);</span>
</span><span id=__span-49-8>
</span><span id=__span-49-9><span class=w>    </span><span class=c1>// 插入一个右值</span>
</span><span id=__span-49-10><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=s>&quot;2222222&quot;</span><span class=p>);</span>
</span><span id=__span-49-11><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=s>&quot;2222222222&quot;</span><span class=p>);</span>
</span><span id=__span-49-12>
</span><span id=__span-49-13><span class=w>    </span><span class=c1>// 插入时构造对象</span>
</span><span id=__span-49-14><span class=w>    </span><span class=n>list</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=n>simulate_string</span><span class=o>::</span><span class=n>string</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>ls1</span><span class=p>;</span>
</span><span id=__span-49-15><span class=w>    </span><span class=c1>// 插入时，用插入的内容构造一个pair对象</span>
</span><span id=__span-49-16><span class=w>    </span><span class=n>ls</span><span class=p>.</span><span class=n>emplace_back</span><span class=p>(</span><span class=s>&quot;2222222&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-49-17>
</span><span id=__span-49-18><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-49-19><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>之所以可以接受构造函数的参数，是因为<code>emplace_back</code>函数本身是一个可变模版参数的函数模版，但是注意，这个可变参数模版不代表可以传递多个参数，例如，插入多个字符串<code>ls.emplace_back("1111", "2222");</code>这种行为是错误的</p> <p>使用可变参数模版模拟实现<code>emplace_back</code>函数，以模拟实现list为例：</p> <p>因为<code>emplace_back</code>本身是一个插入函数，所以底层调用<code>insert</code>函数即可，将函数的形式参数设置为右值引用，为了可以实现向下传递时也是右值引用，需要使用完美转发，代码如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-50-1><span class=c1>// 模拟实现emplace_back</span>
</span><span id=__span-50-2><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-50-3><span class=kt>void</span><span class=w> </span><span class=n>emplace_back</span><span class=p>(</span><span class=n>Args</span><span class=o>&amp;&amp;</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-50-4><span class=p>{</span>
</span><span id=__span-50-5><span class=w>    </span><span class=n>insert</span><span class=p>(</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>T</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)...));</span>
</span><span id=__span-50-6><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>接着，实现<code>insert</code>函数针对<code>emplace_back</code>的版本，因为需要调用构造函数，所以当是右值引用时，需要保留是右值引用，同样需要使用完美转发</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-51-1><span class=k>template</span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-51-2><span class=kt>void</span><span class=w> </span><span class=n>insert</span><span class=p>(</span><span class=n>iterator</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w> </span><span class=n>Args</span><span class=p>..,</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-51-3><span class=p>{</span>
</span><span id=__span-51-4><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>cur</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pos</span><span class=p>.</span><span class=n>_node</span><span class=p>;</span>
</span><span id=__span-51-5><span class=w>    </span><span class=n>Node</span><span class=o>*</span><span class=w> </span><span class=n>newnode</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Node</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>x</span><span class=p>));</span><span class=c1>// 保证右值引用不退化</span>
</span><span id=__span-51-6><span class=w>    </span><span class=c1>// ...</span>
</span><span id=__span-51-7><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>最后，完善<code>Node</code>节点的构造函数，使其满足可变参数模版，同样需要完美转发</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-52-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span>
</span><span id=__span-52-2><span class=n>ListNode</span><span class=p>(</span><span class=n>Args</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span>
</span><span id=__span-52-3><span class=w>   </span><span class=err>：</span><span class=n>_next</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-52-4><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_prev</span><span class=p>(</span><span class=k>nullptr</span><span class=p>)</span>
</span><span id=__span-52-5><span class=w>    </span><span class=p>,</span><span class=w> </span><span class=n>_data</span><span class=p>(</span><span class=n>forward</span><span class=o>&lt;</span><span class=n>Args</span><span class=o>&gt;</span><span class=p>(</span><span class=n>args</span><span class=p>)...)</span><span class=w> </span><span class=c1>// 保证右值引用不退化</span>
</span><span id=__span-52-6><span class=p>{}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=emplacepush><code>emplace</code>系列函数和<code>push</code>系列函数的选择<a class=headerlink href=#emplacepush title="Permanent link">&para;</a></h3> <p>以vector中的<code>emplace_back</code>和<code>push_back</code>为例</p> <p><code>push_back</code> 和 <code>emplace_back</code> 都是 vector 类的成员函数，用于在 vector 的末尾添加元素。它们之间的主要区别在于添加元素的方式:</p> <ol> <li><code>push_back</code>：接受一个已存在的对象作为参数，进行拷贝或移动，将其添加到 vector 的未尾。这会引发一次拷贝或移动构造函数的调用，具体取决于传递的对象是否可移动。</li> <li><code>emplace_back</code>：接受构造函数的参数，直接在 vector 的内存空间中调用该对象的构造函数，避免了额外的拷贝或移动操作。这可以提高效率，尤其是在处理复杂对象时。</li> </ol> <p>使用场景:</p> <ul> <li>如果需要将一个已经存在的对象添加到vector中，使用<code>push_back</code></li> <li>如果希望直接在vector中构造对象,避免额外的拷贝或移动开销，使用<code>emplace_back</code></li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>当然可以无脑选择<code>emplace_back</code>函数</p> </div> <h2 id=lambda>lambda表达式<a class=headerlink href=#lambda title="Permanent link">&para;</a></h2> <h3 id=_20>引入<a class=headerlink href=#_20 title="Permanent link">&para;</a></h3> <p>在C++ 98中，对于<code>sort</code>函数来说，如果需要根据不同的比较方式实现不同的排序结果，需要写不同的仿函数，而在C++ 11中，可以通过lambda表达式解决这个问题，例如下面的例子：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-53-1><span class=k>struct</span><span class=w> </span><span class=nc>Goods</span>
</span><span id=__span-53-2><span class=p>{</span>
</span><span id=__span-53-3><span class=w>    </span><span class=n>string</span><span class=w> </span><span class=n>_name</span><span class=p>;</span><span class=w>  </span><span class=c1>// 名字</span>
</span><span id=__span-53-4><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>_price</span><span class=p>;</span><span class=w> </span><span class=c1>// 价格</span>
</span><span id=__span-53-5><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>_evaluate</span><span class=p>;</span><span class=w> </span><span class=c1>// 评价</span>
</span><span id=__span-53-6><span class=w>    </span><span class=n>Goods</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=kt>char</span><span class=o>*</span><span class=w> </span><span class=n>str</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>price</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>evaluate</span><span class=p>)</span>
</span><span id=__span-53-7><span class=w>        </span><span class=o>:</span><span class=n>_name</span><span class=p>(</span><span class=n>str</span><span class=p>)</span>
</span><span id=__span-53-8><span class=w>        </span><span class=p>,</span><span class=w> </span><span class=n>_price</span><span class=p>(</span><span class=n>price</span><span class=p>)</span>
</span><span id=__span-53-9><span class=w>        </span><span class=p>,</span><span class=w> </span><span class=n>_evaluate</span><span class=p>(</span><span class=n>evaluate</span><span class=p>)</span>
</span><span id=__span-53-10><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-53-11><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>当需要按照商品的价格和评价排序时，则需要写两个仿函数</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-54-1><span class=k>struct</span><span class=w> </span><span class=nc>ComparePrice</span>
</span><span id=__span-54-2><span class=p>{</span>
</span><span id=__span-54-3><span class=w>    </span><span class=c1>// 按照价格排序</span>
</span><span id=__span-54-4><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=nf>operator</span><span class=p>()(</span><span class=k>const</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g1</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g2</span><span class=p>)</span>
</span><span id=__span-54-5><span class=w>    </span><span class=p>{</span>
</span><span id=__span-54-6><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>g1</span><span class=p>.</span><span class=n>_price</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>g2</span><span class=p>.</span><span class=n>_price</span><span class=p>;</span>
</span><span id=__span-54-7><span class=w>    </span><span class=p>}</span>
</span><span id=__span-54-8><span class=p>};</span>
</span><span id=__span-54-9>
</span><span id=__span-54-10><span class=k>struct</span><span class=w> </span><span class=nc>CompareEvaluate</span>
</span><span id=__span-54-11><span class=p>{</span>
</span><span id=__span-54-12><span class=w>    </span><span class=c1>// 按照评价排序</span>
</span><span id=__span-54-13><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=nf>operator</span><span class=p>()(</span><span class=k>const</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g1</span><span class=p>,</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g2</span><span class=p>)</span>
</span><span id=__span-54-14><span class=w>    </span><span class=p>{</span>
</span><span id=__span-54-15><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>g1</span><span class=p>.</span><span class=n>_evaluate</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>g2</span><span class=p>.</span><span class=n>_evaluate</span><span class=p>;</span>
</span><span id=__span-54-16><span class=w>    </span><span class=p>}</span>
</span><span id=__span-54-17><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>调用时传递仿函数匿名对象</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-55-1><span class=n>sort</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>ComparePrice</span><span class=p>());</span>
</span><span id=__span-55-2><span class=n>sort</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>CompareEvaluate</span><span class=p>());</span>
</span></code></pre></div></td></tr></table></div> <p>但是当需要按照其他方式进行比较时，需要再写其他的仿函数，为了简化步骤，可以使用lambda表达式</p> <h3 id=lambda_1>lambda表达式介绍<a class=headerlink href=#lambda_1 title="Permanent link">&para;</a></h3> <p>lambda表达式基本结构如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-56-1><span class=p>[</span><span class=n>捕捉列表</span><span class=p>](</span><span class=n>形式参数</span><span class=p>)</span><span class=k>mutable</span><span class=o>-&gt;</span><span class=n>返回值类型</span>
</span><span id=__span-56-2><span class=p>{</span>
</span><span id=__span-56-3><span class=w>    </span><span class=n>函数体</span>
</span><span id=__span-56-4><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <ul> <li>捕捉列表：编译器根据<code>[]</code>来判断接下来的代码是否为lambda函数，用于传递在lambda表达式体内的使用到的参数，一般为lambda表达式所在的直接作用域的变量</li> <li>形式参数：用于lambda表达式体内的变量，如果不需要传递形式参数，则当前项可以省略不写，如果需要加<code>mutable</code>，则不论是有还是没有形式参数，都需要带上<code>()</code></li> <li><code>mutable</code>：默认情况下lambda表达式捕捉列表的参数是被<code>const</code>修饰的，所以捕捉列表的参数是以传值的方式传递时是无法直接在lambda表达式内部进行修改的，但是如果加了<code>mutable</code>，就可以取消<code>const</code>属性</li> <li><code>-&gt;</code>返回值类型：与普通的函数体一样的返回类型声明，但是此处一定要使用尾置返回值类型，如果lambda表达式的返回值类型比较明确时，该项可以不写</li> <li>函数体：同普通函数</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p><code>mutable</code>关键字在C++中也可以在一个<code>const</code>结构体中修饰一个变量，此时被<code>mutable</code>修饰的变量就是<code>const</code>结构体中可以修改的变量，而其他的没被<code>mutable</code>变量则不可以</p> </div> <p>有了lambda表达式，引入部分的例子中的仿函数可以用lambda表达式进行替换，如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-57-1><span class=c1>// lambda表达式</span>
</span><span id=__span-57-2><span class=n>sort</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=p>[](</span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g1</span><span class=p>,</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g2</span><span class=p>)</span>
</span><span id=__span-57-3><span class=w>    </span><span class=p>{</span>
</span><span id=__span-57-4><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>g1</span><span class=p>.</span><span class=n>_price</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>g2</span><span class=p>.</span><span class=n>_price</span><span class=p>;</span>
</span><span id=__span-57-5><span class=w>    </span><span class=p>});</span>
</span><span id=__span-57-6><span class=n>sort</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=p>[](</span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g1</span><span class=p>,</span><span class=w> </span><span class=n>Goods</span><span class=o>&amp;</span><span class=w> </span><span class=n>g2</span><span class=p>)</span>
</span><span id=__span-57-7><span class=w>    </span><span class=p>{</span>
</span><span id=__span-57-8><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>g1</span><span class=p>.</span><span class=n>_evaluate</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>g2</span><span class=p>.</span><span class=n>_evaluate</span><span class=p>;</span>
</span><span id=__span-57-9><span class=w>    </span><span class=p>});</span>
</span></code></pre></div></td></tr></table></div> <h3 id=lambda_2>lambda表达式捕捉列表的传递形式<a class=headerlink href=#lambda_2 title="Permanent link">&para;</a></h3> <p>如果没有形式参数传递，lambda表达式想使用其所在的直接作用域中的变量（全局除外）需要在捕捉列表中传递，在lambda表达式中，捕捉列表的传递形式一共有4种：</p> <ol> <li>具体变量值传递<code>[variable]</code>：直接传递变量的值，在lambda表达式中就是对该变量的值进行拷贝，所以lambda表达式内部对<code>variable</code>修改时不影响<code>variable</code>本身的内容，并且在没有<code>mutable</code>的情况下不可以在内部对<code>variable</code>进行修改</li> <li>具体变量引用传递<code>[&amp;variable]</code>：以<code>variable</code>引用的方式传递，在lambda表达式中可以对<code>variable</code>内容进行修改，从而达到传址调用的效果</li> <li>所有变量值传递<code>[=]</code>：将lambda表达式所在作用域中的变量全部以传值的方式传递给lambda表达式，具体传递了哪些值需要看lambda表达式中使用到了哪些值</li> <li>所有变量引用传递<code>[&amp;]</code>：将将lambda表达式所在作用域中的变量全部以传址的方式传递给lambda表达式，具体传递了哪些值需要看lambda表达式中使用到了哪些值，如果lambda内部需要进行修改，需要加<code>mutable</code></li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>对于第二种情况，如果想在lambda表达式内部修改lambda所在作用域的变量的值，可以在lambda表达式的形式参数部分以引用的方式传递实参，此时就可以不需要添加<code>mutable</code>关键字，这个方法与普通函数的思路一致</p> </div> <p>上面4种方法也可以交错使用，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-58-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-58-2><span class=p>{</span>
</span><span id=__span-58-3><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-58-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-58-5><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-58-6><span class=w>    </span><span class=c1>// a，b以值传递，c以引用传递</span>
</span><span id=__span-58-7><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>func</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=n>c</span><span class=p>]()</span>
</span><span id=__span-58-8><span class=w>    </span><span class=p>{</span>
</span><span id=__span-58-9><span class=w>        </span><span class=c1>// a和b是值传递，不能修改</span>
</span><span id=__span-58-10><span class=w>        </span><span class=c1>// a = 10;</span>
</span><span id=__span-58-11><span class=w>        </span><span class=c1>// b = 20;</span>
</span><span id=__span-58-12><span class=w>        </span><span class=c1>// c是引用传递，可以修改</span>
</span><span id=__span-58-13><span class=w>        </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>30</span><span class=p>;</span>
</span><span id=__span-58-14><span class=w>    </span><span class=p>};</span>
</span><span id=__span-58-15>
</span><span id=__span-58-16><span class=w>    </span><span class=n>func</span><span class=p>();</span>
</span><span id=__span-58-17>
</span><span id=__span-58-18><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-58-19><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=for_eachlambda><code>for_each</code>函数与lambda表达式<a class=headerlink href=#for_eachlambda title="Permanent link">&para;</a></h3> <p><code>for_each()</code>是C++11中引入的一种容器遍历方式，其原型如下：</p> <p><div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-59-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>InputIterator</span><span class=p>,</span><span class=w> </span><span class=k>class</span><span class=w> </span><span class=nc>Function</span><span class=o>&gt;</span>
</span><span id=__span-59-2><span class=w>   </span><span class=n>Function</span><span class=w> </span><span class=n>for_each</span><span class=w> </span><span class=p>(</span><span class=n>InputIterator</span><span class=w> </span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>InputIterator</span><span class=w> </span><span class=n>last</span><span class=p>,</span><span class=w> </span><span class=n>Function</span><span class=w> </span><span class=n>fn</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> 第一个参数和第二个参数都是容器的迭代器，因为是<code>InputIterator</code>，所以可以传递单向、双向和随机迭代器，第三个参数可以传递仿函数或者lambda表达式</p> <p>第三个参数中一般是指定在循环遍历中对遍历容器元素的操作，例如遍历容器元素等</p> <p>例如下面的代码： <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-60-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-60-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;algorithm&gt;</span>
</span><span id=__span-60-3><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
</span><span id=__span-60-4>
</span><span id=__span-60-5><span class=c1>// 使用仿函数</span>
</span><span id=__span-60-6><span class=k>struct</span><span class=w> </span><span class=nc>print</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-60-7><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>operator</span><span class=p>()(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=k>const</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-60-8><span class=w>        </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-60-9><span class=w>    </span><span class=p>}</span>
</span><span id=__span-60-10><span class=p>};</span>
</span><span id=__span-60-11>
</span><span id=__span-60-12><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-60-13><span class=p>{</span>
</span><span id=__span-60-14><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>,</span><span class=w> </span><span class=mi>4</span><span class=p>,</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-60-15><span class=w>    </span><span class=n>for_each</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=n>print</span><span class=p>());</span>
</span><span id=__span-60-16>
</span><span id=__span-60-17><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-60-18>
</span><span id=__span-60-19>
</span><span id=__span-60-20><span class=w>    </span><span class=c1>// 使用lambda表达式</span>
</span><span id=__span-60-21><span class=w>    </span><span class=n>for_each</span><span class=p>(</span><span class=n>v</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>v</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=p>[](</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-60-22><span class=w>    </span><span class=c1>// 也可以写成</span>
</span><span id=__span-60-23><span class=w>    </span><span class=c1>// auto print = [](int i) {cout &lt;&lt; i &lt;&lt; &quot; &quot;; };</span>
</span><span id=__span-60-24><span class=w>    </span><span class=c1>// for_each(v.begin(), v.end(), print);</span>
</span><span id=__span-60-25>
</span><span id=__span-60-26><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-60-27><span class=p>}</span>
</span><span id=__span-60-28>
</span><span id=__span-60-29><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-60-30><span class=mi>1</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=mi>5</span>
</span><span id=__span-60-31><span class=mi>1</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=mi>3</span><span class=w> </span><span class=mi>4</span><span class=w> </span><span class=mi>5</span>
</span></code></pre></div></td></tr></table></div></p> <h3 id=lambda_3>lambda表达式的原理<a class=headerlink href=#lambda_3 title="Permanent link">&para;</a></h3> <p>前面通过lambda表达式简化了原本应该使用仿函数改写比较方式的例子展示了lambda表达式的使用，但是lambda表达式实际与仿函数的原理基本一致，所以lambda表达式也被称为匿名函数，观察下面的代码的反汇编代码</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-61-1><span class=k>class</span><span class=w> </span><span class=nc>Rate</span>
</span><span id=__span-61-2><span class=p>{</span>
</span><span id=__span-61-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-61-4><span class=w>    </span><span class=n>Rate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-61-5><span class=w>       </span><span class=err>：</span><span class=n>_rate</span><span class=p>(</span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-61-6><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-61-7>
</span><span id=__span-61-8><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=k>operator</span><span class=p>()(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-61-9><span class=w>    </span><span class=p>{</span>
</span><span id=__span-61-10><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>_rate</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-61-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-61-12><span class=k>private</span><span class=o>:</span>
</span><span id=__span-61-13><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>_rate</span><span class=p>;</span>
</span><span id=__span-61-14><span class=p>};</span>
</span><span id=__span-61-15>
</span><span id=__span-61-16>
</span><span id=__span-61-17><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-61-18><span class=p>{</span>
</span><span id=__span-61-19><span class=w>    </span><span class=c1>// 创建普通对象</span>
</span><span id=__span-61-20><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>0.1</span><span class=p>;</span>
</span><span id=__span-61-21><span class=w>    </span><span class=n>Rate</span><span class=w> </span><span class=n>r</span><span class=p>(</span><span class=n>rate</span><span class=p>);</span>
</span><span id=__span-61-22><span class=w>    </span><span class=c1>// 使用仿函数</span>
</span><span id=__span-61-23><span class=w>    </span><span class=n>r</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-61-24>
</span><span id=__span-61-25><span class=w>    </span><span class=c1>// 使用lambda表达式</span>
</span><span id=__span-61-26><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>func</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>](</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-61-27><span class=w>    </span><span class=p>{</span>
</span><span id=__span-61-28><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>rate</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-61-29><span class=w>    </span><span class=p>};</span>
</span><span id=__span-61-30>
</span><span id=__span-61-31><span class=w>    </span><span class=n>func</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-61-32><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-61-33><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>反汇编如下：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image8.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image8.png"></a></p> <p>需要注意的是，lambda表达式对象不可以相互转化，尽管完全相同，在底层两个逻辑一模一样的lambda表达式存在不同的<code>lambda+uuid</code>名称</p> <h2 id=_21>包装器<a class=headerlink href=#_21 title="Permanent link">&para;</a></h2> <h3 id=_22>包装器的基本使用<a class=headerlink href=#_22 title="Permanent link">&para;</a></h3> <p>C++11中引入了<code>function</code>包装器，也叫做适配器，在前面有了lambda表达式后，可以发现如果直接调用lambda表达式的对象，其方式和函数的调用基本相同，但是前面的函数还有可能是仿函数，为了使程序的模版使用效率变高，可以使用包装器</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>使用包装器需要引入头文件<code>&lt;functional&gt;</code></p> </div> <p>包装器可以根据已有的函数、函数指针、lambda表达式进行包装，基本结构如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-62-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>T</span><span class=o>&gt;</span><span class=w> </span><span class=n>function</span><span class=p>;</span><span class=w>     </span><span class=c1>// undefined</span>
</span><span id=__span-62-2><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=k>class</span><span class=w> </span><span class=nc>Ret</span><span class=p>,</span><span class=w> </span><span class=k>class</span><span class=p>...</span><span class=w> </span><span class=n>Args</span><span class=o>&gt;</span><span class=w> </span>
</span><span id=__span-62-3><span class=k>class</span><span class=w> </span><span class=nc>function</span><span class=o>&lt;</span><span class=n>Ret</span><span class=p>(</span><span class=n>Args</span><span class=p>...)</span><span class=o>&gt;</span><span class=p>;</span>
</span><span id=__span-62-4>
</span><span id=__span-62-5><span class=c1>// 其中Ret代表指定的函数的返回值</span>
</span><span id=__span-62-6><span class=c1>// Args代表指定的函数的参数</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>需要注意，使用包装器必须保证包装器中的模版参数（返回值和形式参数）与被包装的对象完全相同</p> </div> <p>使用方式如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-63-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;functional&gt;</span>
</span><span id=__span-63-2>
</span><span id=__span-63-3><span class=k>class</span><span class=w> </span><span class=nc>Rate</span>
</span><span id=__span-63-4><span class=p>{</span>
</span><span id=__span-63-5><span class=k>public</span><span class=o>:</span>
</span><span id=__span-63-6><span class=w>    </span><span class=n>Rate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-63-7><span class=w>       </span><span class=err>：</span><span class=n>_rate</span><span class=p>(</span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-63-8><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-63-9>
</span><span id=__span-63-10><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=k>operator</span><span class=p>()(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-63-11><span class=w>    </span><span class=p>{</span>
</span><span id=__span-63-12><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>_rate</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-63-13><span class=w>    </span><span class=p>}</span>
</span><span id=__span-63-14>
</span><span id=__span-63-15><span class=w>    </span><span class=k>static</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>calculate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-63-16><span class=w>    </span><span class=p>{</span>
</span><span id=__span-63-17><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-63-18><span class=w>    </span><span class=p>}</span>
</span><span id=__span-63-19><span class=k>private</span><span class=o>:</span>
</span><span id=__span-63-20><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>_rate</span><span class=p>;</span>
</span><span id=__span-63-21><span class=p>};</span>
</span><span id=__span-63-22>
</span><span id=__span-63-23><span class=kt>double</span><span class=w> </span><span class=nf>func</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-63-24><span class=p>{</span>
</span><span id=__span-63-25><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-63-26><span class=p>}</span>
</span><span id=__span-63-27>
</span><span id=__span-63-28><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-63-29><span class=p>{</span>
</span><span id=__span-63-30><span class=w>    </span><span class=c1>// 包装普通函数</span>
</span><span id=__span-63-31><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>func</span><span class=p>;</span>
</span><span id=__span-63-32><span class=w>    </span><span class=n>func1</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-63-33>
</span><span id=__span-63-34><span class=w>    </span><span class=c1>// 包装仿函数</span>
</span><span id=__span-63-35><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=n>Rate</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>Rate</span><span class=o>::</span><span class=k>operator</span><span class=p>();</span>
</span><span id=__span-63-36><span class=w>    </span><span class=n>func2</span><span class=p>(</span><span class=n>Rate</span><span class=p>(</span><span class=mf>0.1</span><span class=p>),</span><span class=w> </span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-63-37>
</span><span id=__span-63-38><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Rate</span><span class=o>::</span><span class=n>calculate</span><span class=p>;</span>
</span><span id=__span-63-39><span class=w>    </span><span class=n>func3</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-63-40>
</span><span id=__span-63-41><span class=w>    </span><span class=c1>// 包装lambda表达式</span>
</span><span id=__span-63-42><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>=</span><span class=p>](</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-63-43><span class=w>    </span><span class=p>{</span>
</span><span id=__span-63-44><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mf>0.1</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-63-45><span class=w>    </span><span class=p>};</span>
</span><span id=__span-63-46>
</span><span id=__span-63-47><span class=w>    </span><span class=n>func4</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span>
</span><span id=__span-63-48><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-63-49><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>上面代码中，包装普通函数与包装函数指针类似，包装成员函数需要注意两种形式：</p> <ol> <li>静态成员函数：可以直接取地址，与普通函数类似，但是需要指定类域</li> <li>非静态成员函数：需要加上<code>&amp;</code>，因为非静态成员函数存在一个隐含的参数<code>this</code>，需要依赖对象实例进行调用，所以非静态成员需要传递一个类名（或类指针）代表调用时需要传递同类类型的（匿名/非匿名）对象（或对象地址）</li> </ol> <p>在调用包装后的函数时，实际上是通过对象进行调用，而不是包装器进行调用，对于lambda表达式来说，直接使包装器接受lambda表达式即可</p> <h3 id=_23>包装器与重载函数<a class=headerlink href=#_23 title="Permanent link">&para;</a></h3> <p>重载函数的根本条件就是必须满足函数名相同，但是此时如果直接使用函数名作为包装器的对象就会产生二义性问题，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-64-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;functional&gt;</span>
</span><span id=__span-64-2><span class=kt>int</span><span class=w> </span><span class=nf>add</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-64-3><span class=p>{</span>
</span><span id=__span-64-4><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-64-5><span class=p>}</span>
</span><span id=__span-64-6>
</span><span id=__span-64-7><span class=kt>double</span><span class=w> </span><span class=nf>add</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-64-8><span class=p>{</span>
</span><span id=__span-64-9><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-64-10><span class=p>}</span>
</span><span id=__span-64-11>
</span><span id=__span-64-12><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-64-13><span class=p>{</span>
</span><span id=__span-64-14><span class=w>    </span><span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
</span><span id=__span-64-15><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>add</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-64-16><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-64-17><span class=p>}</span>
</span><span id=__span-64-18>
</span><span id=__span-64-19><span class=n>报错信息</span><span class=err>：</span>
</span><span id=__span-64-20><span class=err>&#39;</span><span class=n>std</span><span class=o>::</span><span class=n>_Tree</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>_Tmap_traits</span><span class=o>&lt;</span><span class=n>_Kty</span><span class=p>,</span><span class=n>_Ty</span><span class=p>,</span><span class=n>_Pr</span><span class=p>,</span><span class=n>_Alloc</span><span class=p>,</span><span class=nb>false</span><span class=o>&gt;&gt;::</span><span class=n>insert</span><span class=err>&#39;</span><span class=o>:</span><span class=w> </span><span class=n>no</span><span class=w> </span><span class=n>overloaded</span><span class=w> </span><span class=n>function</span><span class=w> </span><span class=n>could</span><span class=w> </span><span class=n>convert</span><span class=w> </span><span class=n>all</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>argument</span><span class=w> </span><span class=n>types</span>
</span></code></pre></div></td></tr></table></div> <p>在上面的代码中，map的模版参数是<code>int</code>和<code>function&lt;int(int, int)&gt;</code>，代码中也存在对应包装器模版类型的<code>add</code>函数，但是编译器并不会自动选择对应的重载函数，所以在出现重载函数时，推荐使用函数指针对重载函数进行指代，再传入函数指针，避免传入重载函数的函数名，另外也可以使用lambda表达式，从而不使用函数重载，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-65-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-65-2><span class=p>{</span>
</span><span id=__span-65-3><span class=w>    </span><span class=n>map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>m</span><span class=p>;</span>
</span><span id=__span-65-4><span class=w>    </span><span class=c1>//m.insert({ 1, add }); 直接插入导致二义性</span>
</span><span id=__span-65-5>
</span><span id=__span-65-6><span class=w>    </span><span class=c1>// 使用函数指针指代需要插入的函数</span>
</span><span id=__span-65-7><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=p>(</span><span class=o>*</span><span class=n>pint</span><span class=p>)(</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>add</span><span class=p>;</span>
</span><span id=__span-65-8><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>pint</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-65-9>
</span><span id=__span-65-10><span class=w>    </span><span class=c1>// 使用lambda表达式</span>
</span><span id=__span-65-11><span class=w>    </span><span class=n>m</span><span class=p>.</span><span class=n>insert</span><span class=p>({</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=p>[](</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>;</span><span class=w> </span><span class=p>}</span><span class=w> </span><span class=p>});</span>
</span><span id=__span-65-12><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-65-13><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_24>包装器的使用<a class=headerlink href=#_24 title="Permanent link">&para;</a></h3> <p>C++形式的转移表，以实现简易计算器为例：</p> <p>下面的代码是用于计算的函数：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-66-1><span class=kt>int</span><span class=w> </span><span class=nf>add</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-66-2><span class=p>{</span>
</span><span id=__span-66-3><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-66-4><span class=p>}</span>
</span><span id=__span-66-5>
</span><span id=__span-66-6><span class=kt>int</span><span class=w> </span><span class=nf>sub</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-66-7><span class=p>{</span>
</span><span id=__span-66-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-66-9><span class=p>}</span>
</span><span id=__span-66-10>
</span><span id=__span-66-11><span class=kt>int</span><span class=w> </span><span class=nf>divide</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-66-12><span class=p>{</span>
</span><span id=__span-66-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-66-14><span class=p>}</span>
</span><span id=__span-66-15>
</span><span id=__span-66-16><span class=kt>int</span><span class=w> </span><span class=nf>multiply</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>)</span>
</span><span id=__span-66-17><span class=p>{</span>
</span><span id=__span-66-18><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>b</span><span class=p>;</span>
</span><span id=__span-66-19><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>常规写法：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-67-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-67-2><span class=p>{</span>
</span><span id=__span-67-3><span class=w>    </span><span class=c1>// 处理操作数和操作符输入</span>
</span><span id=__span-67-4><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-67-5><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-67-6><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>opt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-67-7><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-67-8>
</span><span id=__span-67-9><span class=w>    </span><span class=c1>// 处理计算</span>
</span><span id=__span-67-10><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>flag</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>opt</span><span class=p>)</span>
</span><span id=__span-67-11><span class=w>    </span><span class=p>{</span>
</span><span id=__span-67-12><span class=w>        </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>opt</span><span class=p>)</span>
</span><span id=__span-67-13><span class=w>        </span><span class=p>{</span>
</span><span id=__span-67-14><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;+&#39;</span><span class=p>:</span>
</span><span id=__span-67-15><span class=w>            </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num2</span><span class=p>;</span>
</span><span id=__span-67-16><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>add</span><span class=p>(</span><span class=n>num1</span><span class=p>,</span><span class=w> </span><span class=n>num2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-67-17><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-18><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;-&#39;</span><span class=p>:</span>
</span><span id=__span-67-19><span class=w>            </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num2</span><span class=p>;</span>
</span><span id=__span-67-20><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>sub</span><span class=p>(</span><span class=n>num1</span><span class=p>,</span><span class=w> </span><span class=n>num2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-67-21><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-22><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;*&#39;</span><span class=p>:</span>
</span><span id=__span-67-23><span class=w>            </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num2</span><span class=p>;</span>
</span><span id=__span-67-24><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>multiply</span><span class=p>(</span><span class=n>num1</span><span class=p>,</span><span class=w> </span><span class=n>num2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-67-25><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-26><span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;/&#39;</span><span class=p>:</span>
</span><span id=__span-67-27><span class=w>            </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num2</span><span class=p>;</span>
</span><span id=__span-67-28><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>divide</span><span class=p>(</span><span class=n>num1</span><span class=p>,</span><span class=w> </span><span class=n>num2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-67-29><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-30><span class=w>        </span><span class=k>default</span><span class=o>:</span>
</span><span id=__span-67-31><span class=w>            </span><span class=n>flag</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-67-32><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-33><span class=w>        </span><span class=p>}</span>
</span><span id=__span-67-34><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>flag</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-67-35><span class=w>        </span><span class=p>{</span>
</span><span id=__span-67-36><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-67-37><span class=w>        </span><span class=p>}</span>
</span><span id=__span-67-38><span class=w>    </span><span class=p>}</span>
</span><span id=__span-67-39>
</span><span id=__span-67-40><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-67-41><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>使用包装器后：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-68-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;functional&gt;</span>
</span><span id=__span-68-2>
</span><span id=__span-68-3><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-68-4><span class=p>{</span>
</span><span id=__span-68-5><span class=w>    </span><span class=n>map</span><span class=o>&lt;</span><span class=kt>char</span><span class=p>,</span><span class=w> </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>m</span><span class=p>{</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;+&#39;</span><span class=p>,</span><span class=w> </span><span class=n>add</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;-&#39;</span><span class=p>,</span><span class=w> </span><span class=n>sub</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;*&#39;</span><span class=p>,</span><span class=w> </span><span class=n>multiply</span><span class=p>},</span><span class=w> </span><span class=p>{</span><span class=sc>&#39;/&#39;</span><span class=p>,</span><span class=w> </span><span class=n>divide</span><span class=p>}</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-68-6><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-68-7><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-68-8><span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>opt</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-68-9>
</span><span id=__span-68-10><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>opt</span><span class=p>)</span>
</span><span id=__span-68-11><span class=w>    </span><span class=p>{</span>
</span><span id=__span-68-12><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>m</span><span class=p>.</span><span class=n>count</span><span class=p>(</span><span class=n>opt</span><span class=p>))</span><span class=w> </span><span class=c1>// 如果count为1，代表map中存在对应的键值对</span>
</span><span id=__span-68-13><span class=w>        </span><span class=p>{</span>
</span><span id=__span-68-14><span class=w>            </span><span class=n>cin</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num1</span><span class=w> </span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>num2</span><span class=p>;</span>
</span><span id=__span-68-15><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>m</span><span class=p>[</span><span class=n>opt</span><span class=p>](</span><span class=n>num1</span><span class=p>,</span><span class=w> </span><span class=n>num2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span><span class=c1>// 返回的value是包装器，直接传参即可调用对应</span>
</span><span id=__span-68-16><span class=w>        </span><span class=p>}</span>
</span><span id=__span-68-17><span class=w>        </span><span class=k>else</span>
</span><span id=__span-68-18><span class=w>        </span><span class=p>{</span>
</span><span id=__span-68-19><span class=w>            </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-68-20><span class=w>        </span><span class=p>}</span>
</span><span id=__span-68-21><span class=w>    </span><span class=p>}</span>
</span><span id=__span-68-22>
</span><span id=__span-68-23><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-68-24><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_25>绑定<a class=headerlink href=#_25 title="Permanent link">&para;</a></h3> <p>在C++ 11中，增加了绑定配合包装器的使用，包装器可以实现两种功能：</p> <ol> <li>改变实参在传参时的顺序</li> <li>固定形参中的某一个值</li> </ol> <div class="admonition note"> <p class=admonition-title>Note</p> <p>使用<code>bind</code>时需要展开命名空间<code>placeholders</code>，因为要使用其中的<code>_1</code>，<code>_2</code>...</p> <p><code>placeholders</code>中的内容表示调用绑定函数的实际参数，<code>_1</code>代表第一个实际参数，<code>_2</code>代表第二个实际参数，以此类推</p> </div> <ul> <li> <p>改变实参在传参时的顺序</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-69-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;functional&gt;</span>
</span><span id=__span-69-2><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>placeholders</span><span class=p>;</span>
</span><span id=__span-69-3>
</span><span id=__span-69-4><span class=kt>int</span><span class=w> </span><span class=nf>sub</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>a</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>b</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>)</span>
</span><span id=__span-69-5><span class=p>{</span>
</span><span id=__span-69-6><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>b</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>c</span><span class=p>;</span>
</span><span id=__span-69-7><span class=p>}</span>
</span><span id=__span-69-8>
</span><span id=__span-69-9><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-69-10><span class=p>{</span>
</span><span id=__span-69-11><span class=w>    </span><span class=c1>// 1. 改变实际参数顺序</span>
</span><span id=__span-69-12><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sub</span><span class=p>;</span>
</span><span id=__span-69-13><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-69-14><span class=w>    </span><span class=c1>// 绑定改变顺序</span>
</span><span id=__span-69-15><span class=w>    </span><span class=n>func</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bind</span><span class=p>(</span><span class=n>func</span><span class=p>,</span><span class=w> </span><span class=n>_2</span><span class=p>,</span><span class=w> </span><span class=n>_3</span><span class=p>,</span><span class=w> </span><span class=n>_1</span><span class=p>);</span>
</span><span id=__span-69-16><span class=w>    </span><span class=c1>// 改变后的传递顺序为：2， 3， 1</span>
</span><span id=__span-69-17><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-69-18>
</span><span id=__span-69-19><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-69-20><span class=p>}</span>
</span><span id=__span-69-21>
</span><span id=__span-69-22><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-69-23><span class=mi>-4</span>
</span><span id=__span-69-24><span class=mi>-2</span>
</span></code></pre></div></td></tr></table></div> <p>传递顺序改变如下图所示：</p> <p><a class=glightbox href="C++ 11相关新特性.assets\image9.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="C++ 11相关新特性.assets\image9.png"></a></p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>注意，<code>bind</code>改变的是实际参数的传递顺序，而不是形参的接收顺序，形参接收还是按照从左到右依次接收传递的实际参数，只是写的第一个实际参数（本应该传递给形参a）被<code>bind</code>改变作为第三个实际参数，传递给形参<code>c</code>，依次类推<code>a</code>和<code>b</code></p> </div> </li> <li> <p>固定形参中的某一个值</p> <p>例如，在前面使用<code>function</code>包装器调用非静态成员函数时，需要单独传递一个对象给隐含的<code>this</code>指针，如果每一次传递都需要传递一个对象会显得繁琐，可以考虑将对象参数进行固定，例如下面的代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-70-1><span class=k>class</span><span class=w> </span><span class=nc>Rate</span>
</span><span id=__span-70-2><span class=p>{</span>
</span><span id=__span-70-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-70-4><span class=w>    </span><span class=n>Rate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-70-5><span class=w>    </span><span class=err>：</span><span class=n>_rate</span><span class=p>(</span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-70-6><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-70-7>
</span><span id=__span-70-8><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>calculate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-70-9><span class=w>    </span><span class=p>{</span>
</span><span id=__span-70-10><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>_rate</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-70-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-70-12>
</span><span id=__span-70-13><span class=k>private</span><span class=o>:</span>
</span><span id=__span-70-14><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>_rate</span><span class=p>;</span>
</span><span id=__span-70-15><span class=p>};</span>
</span><span id=__span-70-16>
</span><span id=__span-70-17><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-70-18><span class=p>{</span>
</span><span id=__span-70-19><span class=w>    </span><span class=c1>// 不使用bind下使用包装器</span>
</span><span id=__span-70-20><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=n>Rate</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>Rate</span><span class=o>::</span><span class=n>calculate</span><span class=p>;</span>
</span><span id=__span-70-21><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func1</span><span class=p>(</span><span class=n>Rate</span><span class=p>(</span><span class=mf>0.1</span><span class=p>),</span><span class=w> </span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-70-22>
</span><span id=__span-70-23>
</span><span id=__span-70-24><span class=w>    </span><span class=c1>// 使用bind下使用包装器</span>
</span><span id=__span-70-25><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=n>Rate</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>Rate</span><span class=o>::</span><span class=n>calculate</span><span class=p>;</span>
</span><span id=__span-70-26><span class=w>    </span><span class=c1>// 使用bind固定对象Rate(0.1)</span>
</span><span id=__span-70-27><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bind</span><span class=p>(</span><span class=n>func2</span><span class=p>,</span><span class=w> </span><span class=n>Rate</span><span class=p>(</span><span class=mf>0.1</span><span class=p>),</span><span class=w> </span><span class=n>_1</span><span class=p>,</span><span class=w> </span><span class=n>_2</span><span class=p>);</span>
</span><span id=__span-70-28><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func3</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-70-29>
</span><span id=__span-70-30><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-70-31><span class=p>}</span>
</span><span id=__span-70-32>
</span><span id=__span-70-33><span class=n>输出结果</span><span class=err>：</span>
</span><span id=__span-70-34><span class=mi>2000</span>
</span><span id=__span-70-35><span class=mi>2000</span>
</span></code></pre></div></td></tr></table></div> <p>上面代码中，需要注意尽管固定了<code>func2</code>的第一个参数，实际参数的指代还是从<code>_1</code>开始，如果固定中间的参数，则最左边的为<code>_1</code>，最右边的为<code>_2</code>（代码如下），以此类推</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-71-1><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=n>Rate</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func4</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bind</span><span class=p>(</span><span class=n>func2</span><span class=p>,</span><span class=w> </span><span class=n>_1</span><span class=p>,</span><span class=w> </span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=n>_2</span><span class=p>);</span>
</span><span id=__span-71-2><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func4</span><span class=p>(</span><span class=n>Rate</span><span class=p>(</span><span class=mf>0.1</span><span class=p>),</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div> </li> </ul> <p>需要注意的是，如果使用绑定固定一个参数传给指定的函数，这个参数是按照值传递的方式而不是引用，所以如果要用引用的方式，可以考虑使用<code>ref</code>函数，例如：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-72-1><span class=k>class</span><span class=w> </span><span class=nc>Rate</span>
</span><span id=__span-72-2><span class=p>{</span>
</span><span id=__span-72-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-72-4><span class=w>    </span><span class=n>Rate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-72-5><span class=w>       </span><span class=err>：</span><span class=n>_rate</span><span class=p>(</span><span class=n>rate</span><span class=p>)</span>
</span><span id=__span-72-6><span class=w>    </span><span class=p>{}</span>
</span><span id=__span-72-7>
</span><span id=__span-72-8><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>calculate</span><span class=p>(</span><span class=kt>double</span><span class=w> </span><span class=n>money</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>year</span><span class=p>)</span>
</span><span id=__span-72-9><span class=w>    </span><span class=p>{</span>
</span><span id=__span-72-10><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>money</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>_rate</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>year</span><span class=p>;</span>
</span><span id=__span-72-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-72-12>
</span><span id=__span-72-13><span class=k>private</span><span class=o>:</span>
</span><span id=__span-72-14><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>_rate</span><span class=p>;</span>
</span><span id=__span-72-15><span class=p>};</span>
</span><span id=__span-72-16>
</span><span id=__span-72-17><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-72-18><span class=p>{</span>
</span><span id=__span-72-19><span class=w>    </span><span class=c1>// 使用bind下使用包装器</span>
</span><span id=__span-72-20><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=n>Rate</span><span class=p>,</span><span class=w> </span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>&amp;</span><span class=n>Rate</span><span class=o>::</span><span class=n>calculate</span><span class=p>;</span>
</span><span id=__span-72-21><span class=w>    </span><span class=c1>// 使用bind固定对象Rate r(0.1)，并且以引用的方式传递</span>
</span><span id=__span-72-22><span class=w>    </span><span class=n>Rate</span><span class=w> </span><span class=n>r</span><span class=p>(</span><span class=mf>0.1</span><span class=p>);</span>
</span><span id=__span-72-23><span class=w>    </span><span class=n>function</span><span class=o>&lt;</span><span class=kt>double</span><span class=p>(</span><span class=kt>double</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=p>)</span><span class=o>&gt;</span><span class=w> </span><span class=n>func3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bind</span><span class=p>(</span><span class=n>func2</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>ref</span><span class=p>(</span><span class=n>r</span><span class=p>),</span><span class=w> </span><span class=n>_1</span><span class=p>,</span><span class=w> </span><span class=n>_2</span><span class=p>);</span>
</span><span id=__span-72-24><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>func3</span><span class=p>(</span><span class=mi>10000</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-72-25>
</span><span id=__span-72-26><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-72-27><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在使用<code>bind</code>时，指定的函数是否需要<code>&amp;</code>也需要注意两种情况：</p> <ol> <li>类成员函数：需要使用<code>&amp;</code>，因为类成员函数存在一个隐含的参数<code>this</code>，需要依赖对象实例进行调用，所以非静态成员需要传递一个类名（或类指针）代表调用时需要传递同类类型的（匿名/非匿名）对象（或对象地址）</li> <li>普通函数及静态类成员函数：可以不需要使用<code>&amp;</code>，因为普通函数和静态类成员函数不存在隐含的参数<code>this</code>，并且函数名代表函数的地址</li> </ol> <p>例如下面的代码：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-73-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-73-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;functional&gt;</span>
</span><span id=__span-73-3>
</span><span id=__span-73-4><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
</span><span id=__span-73-5>
</span><span id=__span-73-6><span class=k>class</span><span class=w> </span><span class=nc>A</span>
</span><span id=__span-73-7><span class=p>{</span>
</span><span id=__span-73-8><span class=k>public</span><span class=o>:</span>
</span><span id=__span-73-9><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=n>test1</span><span class=p>()</span>
</span><span id=__span-73-10><span class=w>    </span><span class=p>{</span>
</span><span id=__span-73-11><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;test1</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-73-12><span class=w>    </span><span class=p>}</span>
</span><span id=__span-73-13>
</span><span id=__span-73-14><span class=w>    </span><span class=k>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=n>test2</span><span class=p>()</span>
</span><span id=__span-73-15><span class=w>    </span><span class=p>{</span>
</span><span id=__span-73-16><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;test2</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-73-17><span class=w>    </span><span class=p>}</span>
</span><span id=__span-73-18><span class=p>};</span>
</span><span id=__span-73-19>
</span><span id=__span-73-20><span class=kt>void</span><span class=w> </span><span class=nf>test</span><span class=p>()</span>
</span><span id=__span-73-21><span class=p>{</span>
</span><span id=__span-73-22><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;test</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-73-23><span class=p>}</span>
</span><span id=__span-73-24>
</span><span id=__span-73-25><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-73-26><span class=p>{</span>
</span><span id=__span-73-27><span class=w>    </span><span class=n>A</span><span class=w> </span><span class=n>a</span><span class=p>;</span>
</span><span id=__span-73-28>
</span><span id=__span-73-29><span class=w>    </span><span class=c1>// 绑定普通函数</span>
</span><span id=__span-73-30><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>function</span><span class=o>&lt;</span><span class=kt>void</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=n>f1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>bind</span><span class=p>(</span><span class=n>test</span><span class=p>);</span>
</span><span id=__span-73-31><span class=w>    </span><span class=c1>// 也可以</span>
</span><span id=__span-73-32><span class=w>    </span><span class=c1>// std::function&lt;void()&gt; f1 = std::bind(&amp;test);</span>
</span><span id=__span-73-33><span class=w>    </span><span class=c1>// 绑定静态成员函数</span>
</span><span id=__span-73-34><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>function</span><span class=o>&lt;</span><span class=kt>void</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=n>f2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>bind</span><span class=p>(</span><span class=n>A</span><span class=o>::</span><span class=n>test2</span><span class=p>);</span>
</span><span id=__span-73-35><span class=w>    </span><span class=c1>// 也可以</span>
</span><span id=__span-73-36><span class=w>    </span><span class=c1>// std::function&lt;void()&gt; f2 = std::bind(&amp;A::test2);</span>
</span><span id=__span-73-37>
</span><span id=__span-73-38><span class=w>    </span><span class=c1>// 绑定类成员函数</span>
</span><span id=__span-73-39><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>function</span><span class=o>&lt;</span><span class=kt>void</span><span class=p>()</span><span class=o>&gt;</span><span class=w> </span><span class=n>f3</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>bind</span><span class=p>(</span><span class=o>&amp;</span><span class=n>A</span><span class=o>::</span><span class=n>test1</span><span class=p>,</span><span class=w> </span><span class=o>&amp;</span><span class=n>a</span><span class=p>);</span>
</span><span id=__span-73-40><span class=w>    </span><span class=c1>// 不可以</span>
</span><span id=__span-73-41><span class=w>    </span><span class=c1>//std::function&lt;void()&gt; f3 = std::bind(A::test1, &amp;a);</span>
</span><span id=__span-73-42>
</span><span id=__span-73-43><span class=w>    </span><span class=n>f1</span><span class=p>();</span>
</span><span id=__span-73-44><span class=w>    </span><span class=n>f2</span><span class=p>();</span>
</span><span id=__span-73-45><span class=w>    </span><span class=n>f3</span><span class=p>();</span>
</span><span id=__span-73-46>
</span><span id=__span-73-47><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-73-48><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年8月29日</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> 页面有帮助吗？ </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title=页面对我有帮助 data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title=页面没有帮助到我 data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> 谢谢你的反馈！ </div> <div data-md-value=0 hidden> 谢谢你的反馈！联系<a href=https://www.help-doc.top/author/contact/contact.html>作者</a>提供更详细的信息 </div> </div> </div> </fieldset> </form> <!-- Waline 评论系统 --> <div id=waline></div> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../javascripts/katex.min.js></script> <script src=../../javascripts/other.min.js></script> <script src=../../javascripts/copyright.min.js></script> <script src=../../javascripts/waline.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script src=../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>