<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/data-structure/bitset/bitset.html><link rel=prev href=../hash-table/hash-table.html><link rel=next href=../bloom-filter/bloom-filter.html><link rel=icon href=../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>位图 - 柯懒的知识库</title><link rel=stylesheet href=../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../css/timeline.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-9XWRGNRRSY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-9XWRGNRRSY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-9XWRGNRRSY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link rel=stylesheet href=../../stylesheets/colors.min.css><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)" id=theme2-desktop><link rel=stylesheet href=../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)" id=theme1-desktop><link rel=stylesheet href=../../stylesheets/print.min.css><link rel=stylesheet href=../../stylesheets/font-dongguanti.min.css id=font-dongguanti><link rel=stylesheet href=../../stylesheets/font-oppoti.min.css id=font-oppoti disabled><link rel=stylesheet href=../../stylesheets/font-jiangchengti.min.css id=font-jiangchengti disabled><link rel=stylesheet href=../../stylesheets/font-lxgw.min.css id=font-lxgw disabled><link rel=stylesheet href=../../stylesheets/code-font-dejavu-sans-mono.min.css id=code-font-dejavu-sans-mono><link rel=stylesheet href=../../stylesheets/code-font-zsft-hk.min.css id=code-font-zsft-hk disabled><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css><link rel=stylesheet href=../../stylesheets/waline.min.css><script src=../../javascripts/start.min.js></script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 位图 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <!-- 头像元素 - 直接在HTML中定义 --> <div class=header-avatar> <img src=../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../author/contact/contact.html class=avatar-dropdown-item>吵醒柯懒</a> <div class=avatar-dropdown-divider></div> <a href=../../author/about/about.html class=avatar-dropdown-item>柯懒自传</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>柯懒的零食库</a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <!-- 独立的切换按钮 --> <div class=toolbar-toggle-btn id=toolbarToggleBtn onclick=toggleToolbar()> <div class=toggle-icon> <svg class=toggle-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=16 height=16> <path d="M346.538667 1024L170.666667 853.333333l341.333333-341.333333-341.333333-341.333333 175.872-170.666667L853.333333 512z" fill=currentColor></path> </svg> </div> </div> <!-- 右侧固定功能条 - 独立于内容区 --> <div class=floating-toolbar id=floatingToolbar> <!-- 字体切换功能 --> <div class="toolbar-item font-switcher"> <div class=toolbar-icon> <svg class=font-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M913.408 1024l-66.56 0q-29.696 0-51.2-5.12t-36.864-15.872-26.112-27.136-19.968-37.888q-15.36-38.912-28.16-70.656t-22.016-55.296q-11.264-26.624-20.48-49.152l-254.976 0q-7.168 23.552-17.408 51.2-8.192 23.552-21.504 56.832t-30.72 72.192q-20.48 46.08-47.104 63.488t-60.416 17.408l-70.656 0q-45.056 0-60.928-19.968t2.56-68.096q18.432-46.08 43.008-108.544t52.224-132.608 57.344-143.872 57.344-144.384q65.536-164.864 137.216-343.04 7.168-17.408 18.432-31.744 10.24-11.264 27.136-21.504t42.496-10.24q26.624 0 43.52 10.752t28.16 24.064q12.288 15.36 19.456 33.792 72.704 180.224 138.24 345.088 27.648 70.656 57.344 143.872t56.832 142.336 51.2 129.536 41.472 104.448q14.336 34.816 4.096 62.464t-43.008 27.648zM616.448 634.88l-97.28-347.136-1.024 0-108.544 347.136 206.848 0z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>内容字体</div> <div class=font-dropdown-toolbar> <div class=font-current-toolbar onclick=toggleFontDropdownToolbar()> <span class=current-font-name-toolbar>东观体</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=font-options-toolbar> <div class=font-option-toolbar data-font=dongguanti onclick="selectFontToolbar('dongguanti')">上图东观体 </div> <div class=font-option-toolbar data-font=oppoti onclick="selectFontToolbar('oppoti')">OPPO Sans </div> <div class=font-option-toolbar data-font=jiangchengti onclick="selectFontToolbar('jiangchengti')"> 江城黑体</div> <div class=font-option-toolbar data-font=lxgw onclick="selectFontToolbar('lxgw')">霞鹜臻楷</div> </div> </div> </div> <!-- 代码字体切换功能 --> <div class="toolbar-item code-font-switcher"> <div class=toolbar-icon> <svg t=1753672111433 class="icon code-font-icon" viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=5148 width=20 height=20> <path d="M941.709938 0H82.290062A82.290062 82.290062 0 0 0 0 82.290062v859.419876A82.290062 82.290062 0 0 0 82.290062 1022.53923h859.419876A82.290062 82.290062 0 0 0 1022.53923 941.709938V82.290062A82.290062 82.290062 0 0 0 941.709938 0zM188.439372 553.631954a40.901569 40.901569 0 0 1-29.215406-70.116975L292.154066 351.558726 159.223966 218.628626a40.901569 40.901569 0 0 1 58.430813-57.94389l160.197813 162.145507a40.901569 40.901569 0 0 1 0 57.943889l-160.197813 160.684736a40.901569 40.901569 0 0 1-29.215407 12.173086z m443.587257 0H405.120304a40.901569 40.901569 0 0 1 0-82.290061H633.000476a40.901569 40.901569 0 0 1 0 82.290061z" fill=currentColor p-id=5149></path> </svg> </div> <div class=toolbar-label>代码字体</div> <div class=code-font-dropdown-toolbar> <div class=code-font-current-toolbar onclick=toggleCodeFontDropdownToolbar()> <span class=current-code-font-name-toolbar>DejaVu Sans Mono</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=code-font-options-toolbar> <div class=code-font-option-toolbar data-code-font=dejavu onclick="selectCodeFontToolbar('dejavu')"> DejaVu Sans Mono</div> <div class=code-font-option-toolbar data-code-font=zsft onclick="selectCodeFontToolbar('zsft')"> JetBrains Mono</div> </div> </div> </div> <!-- 主题切换功能 --> <div class="toolbar-item theme-switcher" onclick=switchTheme()> <div class=toolbar-icon> <svg class=theme-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M876.572788 522.301623c-1.886977 12.375865-9.657964 30.331819-35.880185 45.48903-56.489572 32.697703-150.21828 83.990926-174.010149 96.958262-13.143345 24.431435-66.067718 122.221646-98.141204 178.503487-16.117073 28.124548-36.055171 34.041304-50.030463 34.041304-0.031722 0-0.031722 0-0.031722 0-14.613836 0-29.1806-6.460132-43.234687-19.218714-47.183626-42.643216-125.994576-117.105115-146.013515-136.083351-27.757181-4.732791-138.338718-23.743774-200.584388-35.752272-17.924231-3.533476-32.649608-14.07046-40.372499-29.084409-5.78782-11.256368-10.281157-30.05962 1.471514-55.658647 26.989701-59.047838 74.126254-157.557432 85.957721-182.196599-3.437286-27.117614-16.996093-135.060045-23.760147-198.905142-1.886977-17.460674 3.901867-35.096333 15.829524-48.351218 12.791327-14.278191 30.667463-21.48943 49.854455-19.426445 63.669088 6.332219 173.259042 19.426445 200.584388 22.705118 24.335245-11.879562 121.085776-58.936297 180.133613-86.34146 9.91379-4.573155 19.85828-6.92369 29.596062-6.92369 28.748764 0 52.172243 20.642133 58.328453 51.421136 12.599969 62.997799 30.93864 166.70272 35.639708 193.484689 18.851347 19.682271 91.953272 96.031147 135.060045 143.07151C872.72004 487.125473 879.307062 504.71406 876.572788 522.301623L876.572788 522.301623zM825.375755 499.085876C776.017604 445.314205 687.245791 352.977193 686.365748 352.017332c-2.942005-3.069919-4.956895-6.971785-5.676279-11.208273-0.207731-1.215688-22.193465-127.001509-36.551474-198.936865-0.799202-3.917216-4.285606-16.836457-16.196891-16.836457-3.453658 0-7.30743 1.006933-11.464099 2.942005-67.282383 31.179117-183.955662 88.180342-185.170327 88.771813-3.693112 1.790786-7.850805 2.558265-11.975752 2.01489-1.295506-0.224104-133.63765-16.165168-205.988468-23.424502-0.079818 0-0.207731 0-0.287549 0-7.30743 0-11.128455 2.89391-13.319353 5.40408-3.677762 4.124947-5.644557 9.91379-5.068436 15.110139 7.674796 72.623018 24.255427 202.934922 24.463158 204.325595 0.511653 4.109598-0.159636 8.266267-1.966795 11.960403-0.591471 1.215688-57.657164 120.04712-88.339977 187.201589-3.565199 7.754614-4.41352 14.214746-2.350534 18.131963 1.935072 3.725858 6.588045 5.820566 10.360975 6.53995 70.719668 13.718443 204.644867 36.519752 206.036563 36.727483 4.189416 0.671289 8.058536 2.686179 11.112082 5.580089 1.006933 0.87902 96.414887 91.281983 150.090367 139.889027 8.314363 7.563256 13.143345 8.106632 14.437827 8.106632 3.485381 0 8.314363-4.621251 12.727882-12.391215 36.343743-63.828724 100.011808-181.988868 100.636025-183.155437 1.983167-3.64604 5.004991-6.667863 8.650007-8.650007 1.134847-0.671289 114.418936-62.373583 178.6314-99.516528 8.698103-5.036713 14.278191-10.568706 14.94948-14.854313C834.681702 511.845481 831.49922 505.800811 825.375755 499.085876L825.375755 499.085876zM935.333076 935.670256c-4.157693 4.157693-9.689686 6.299473-15.141862 6.299473-5.548366 0-11.048637-2.142803-15.238053-6.299473l-171.915441-171.915441c-8.362458-8.394181-8.362458-21.98471 0-30.426987 8.394181-8.394181 21.98471-8.394181 30.379914 0l171.915441 171.915441C943.727257 913.684522 943.727257 927.275052 935.333076 935.670256L935.333076 935.670256z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>主题切换</div> </div> <!-- 返回顶部功能 --> <div class="toolbar-item back-to-top" onclick=scrollToTop()> <div class=toolbar-icon> <svg class=back-to-top-icon viewbox="0 0 1024 1024" xmlns=http://www.w3.org/2000/svg> <path d="M882.688 624.128l-336.896-583.68c-15.872-27.136-54.784-27.136-70.656 0L138.24 624.128c-15.872 27.136 4.096 61.44 35.328 61.44H317.44c22.528 0 40.96 18.432 40.96 40.96v239.616c0 22.528 18.432 40.96 40.96 40.96h223.232c22.528 0 40.96-18.432 40.96-40.96v-239.616c0-22.528 18.432-40.96 40.96-40.96h143.872c30.208 0 50.176-34.304 34.304-61.44z"> </path> </svg> </div> <div class=toolbar-label>返回顶部</div> </div> </div> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../intro/intro.html class=md-tabs__link> 网站介绍 </a> </li> <li class=md-tabs__item> <a href=../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../c-lang/index.html class=md-tabs__link> 编程语言 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../time-space-complexity/time-space-complexity.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class=md-tabs__item> <a href=../../Linux/options-commands/options-commands.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../html-css/html/html.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../MySQL/JDBC/JDBC-basic/JDBC-basic.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../JavaEE/Spring/springmvc-basic/springmvc-basic.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../other/shell/shell.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../tooltips/vscode-snippets/vscode-snippets.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../projects/boost-searching-engine/boost-searching-engine.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../intro/intro.html class=md-nav__link> <span class=md-ellipsis> 网站介绍 </span> </a> </li> <li class=md-nav__item> <a href=../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../c-lang/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 数据结构与算法 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_1 checked> <label class=md-nav__link for=__nav_5_1 id=__nav_5_1_label tabindex=0> <span class=md-ellipsis> 数据结构 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_1_label aria-expanded=true> <label class=md-nav__title for=__nav_5_1> <span class="md-nav__icon md-icon"></span> 数据结构 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../time-space-complexity/time-space-complexity.html class=md-nav__link> <span class=md-ellipsis> 数据结构基础 </span> </a> </li> <li class=md-nav__item> <a href=../sequential-structure-and-sequential-table/sequential-structure-and-sequential-table.html class=md-nav__link> <span class=md-ellipsis> 顺序结构与顺序表 </span> </a> </li> <li class=md-nav__item> <a href=../linked-list/linked-list.html class=md-nav__link> <span class=md-ellipsis> 链表 </span> </a> </li> <li class=md-nav__item> <a href=../stack/stack.html class=md-nav__link> <span class=md-ellipsis> 栈 </span> </a> </li> <li class=md-nav__item> <a href=../queue/queue.html class=md-nav__link> <span class=md-ellipsis> 队列 </span> </a> </li> <li class=md-nav__item> <a href=../tree-basic-concept/tree-basic-concept.html class=md-nav__link> <span class=md-ellipsis> 树的基本概念 </span> </a> </li> <li class=md-nav__item> <a href=../binary-tree/binary-tree.html class=md-nav__link> <span class=md-ellipsis> 二叉树（基础） </span> </a> </li> <li class=md-nav__item> <a href=../heap/heap.html class=md-nav__link> <span class=md-ellipsis> 堆 </span> </a> </li> <li class=md-nav__item> <a href=../sort/sort.html class=md-nav__link> <span class=md-ellipsis> 排序 </span> </a> </li> <li class=md-nav__item> <a href=../binary-search-tree/binary-search-tree.html class=md-nav__link> <span class=md-ellipsis> 二叉搜索树 </span> </a> </li> <li class=md-nav__item> <a href=../avl-tree/avl-tree.html class=md-nav__link> <span class=md-ellipsis> AVL树 </span> </a> </li> <li class=md-nav__item> <a href=../red-black-tree/red-black-tree.html class=md-nav__link> <span class=md-ellipsis> 红黑树 </span> </a> </li> <li class=md-nav__item> <a href=../hash-table/hash-table.html class=md-nav__link> <span class=md-ellipsis> 哈希表 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 位图 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=bitset.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 位图 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 案例引入 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 位图实现基本思路 </span> </a> <nav class=md-nav aria-label=位图实现基本思路> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 位图如何实现标记 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 位图如何取消标记 </span> </a> <nav class=md-nav aria-label=位图如何取消标记> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 与运算和取反运算结合 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 异或运算 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 结合左移运算符取消标记 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 判断是否存在 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 位图代码实现 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 位图的优缺点 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 位图相关考察题目 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../bloom-filter/bloom-filter.html class=md-nav__link> <span class=md-ellipsis> 布隆过滤器与海量数据处理 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../algorithm/common/common.html class=md-nav__link> <span class=md-ellipsis> 算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Linux/options-commands/options-commands.html class=md-nav__link> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../html-css/html/html.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../MySQL/JDBC/JDBC-basic/JDBC-basic.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../JavaEE/Spring/springmvc-basic/springmvc-basic.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../other/shell/shell.html class=md-nav__link> <span class=md-ellipsis> 扩展知识 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tooltips/vscode-snippets/vscode-snippets.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../projects/boost-searching-engine/boost-searching-engine.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 案例引入 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 位图实现基本思路 </span> </a> <nav class=md-nav aria-label=位图实现基本思路> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 位图如何实现标记 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 位图如何取消标记 </span> </a> <nav class=md-nav aria-label=位图如何取消标记> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 与运算和取反运算结合 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 异或运算 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 结合左移运算符取消标记 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 判断是否存在 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 位图代码实现 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 位图的优缺点 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 位图相关考察题目 </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=_1>位图<a class=headerlink href=#_1 title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 2901 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 137 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 10 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 11 分钟</p> </div> <h2 id=_2>案例引入<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>给40亿个不重复的无符号整数，没排过序。给一个无符号整数，如何快速判断一个数是否在这40亿个数中。</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>本题为腾讯/百度等公司出过的一个面试题</p> </div> <ul> <li>思路1：暴力遍历，时间复杂度<span class=arithmatex>\(O(N)\)</span>，太慢</li> <li>思路2：排序+二分查找，时间复杂度消耗<span class=arithmatex>\(O(Nlog_{2}{N}) + O(log_{2}{N})\)</span></li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>思路2在理论上可行的原因：</p> <p>首先在消耗时间上，尽管排序的时间复杂度是<span class=arithmatex>\(O(Nlog_{2}{N})\)</span>，但是排序只会进行依次，之后的时间消耗都只是二分查找上的消耗，而对40亿取2的对数可以得出差不多需要32次左右的次数，推导如下：</p> <p><span class=arithmatex>\(2^{10} = 1024\)</span></p> <p><span class=arithmatex>\(2^{20} = 1024 \times 1024 = 1,048,576\)</span> (一百万)</p> <p><span class=arithmatex>\(2^{30} = 1024 \times 1024 \times 1024 = 1073741824\)</span>（十亿）</p> <p>则有40亿：</p> <p><span class=arithmatex>\(2^2 \times 2^{30} = 2^{32} = 4 \times 2^{30} = 4,294,967,296\)</span>（四十亿）</p> </div> <p>深入分析解题思路2是否可行，可以先算算40亿个数据大概需要多少内存：</p> <p>因为题目说的是无符号整数，在C语言/C++中，一个整数占用4个字节，40亿个数据就占用<span class=arithmatex>\(4 \times 40\)</span>亿个字节，因为<span class=arithmatex>\(1 GB = 1024MB = 1024 * 1024 KB = 1024 \times 1024 \times 1024 Byte\)</span>，所以可以得出一共需要<span class=arithmatex>\(4 \times 4 \times 2^{30} = 16GB\)</span></p> <p>但是16GB在现在民用计算机中已经算比较大的内存占用了，而且一般操作系统也无法一次性开出这么大的连续空间，所以思路2在实际中也不可行</p> <p>考虑一种新的思路：题目给出的是「一个数是否在这40亿个数中」，而「在和不在」只有两种情况：在以及不在，而刚好二进制0和1也可以表示两种状态，此时就可以考虑使用每一个比特位来标记某一个数值是否存在：如果存在则标记为1，不存在则标记为0</p> <p>在新的思路中，使用比特位来标记数据是否存在的数据结构就称为「位图」</p> <h2 id=_3>位图实现基本思路<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <p>位图本质是一个直接定址法的哈希表，每个整型值映射一个比特位，位图提供控制这个比特位的相关接口（主要关注「设置标记位<code>set</code>方法」、「恢复标记位<code>reset</code>方法」和「判断是否存在<code>test</code>方法」）</p> <h3 id=_4>位图如何实现标记<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <p>在一个整型数字中，假设开辟一个长度为4的数组，则该数组中就有<span class=arithmatex>\(4 \times 32\)</span>个比特位，如果此时存入一个数据就需要在对应位设置标记，但是在标记之前就需要知道这个数值是如何在位图中映射的</p> <p>假设现在有一个数值23准备映射到位图中，因为是直接定址法，所以在长度为4的数组中映射位置下标为23</p> <p><a class=glightbox href="14. 位图.assets\image.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image.png"></a></p> <p>映射的思想已经成型，现在要考虑的就是如何找到映射位置，因为每一个整型数值有32个比特位，所以考虑下面的方案：</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>引例：</p> <p>思路引入：一个人在第5组第8个位置，假设每一组有10个人，则该人在的位置就是<span class=arithmatex>\((5-1)\times10+8\)</span> 问题：现在认为只知道每一组有10个人，知道一个人的位置在整个组中的第48个，问这个人在哪一组哪一个位置 解决：首先求出这个人所在的组，用这个人的位置除以10（整除）：<span class=arithmatex>\(48 \div 10 = 4\)</span>，而因为<span class=arithmatex>\(40 &lt; 48\)</span>，所以这个人在第5组，而因为<span class=arithmatex>\(48 \mod 40 = 1......8\)</span>，所以这个人在第8个位置，结合组和具体位置可以得出这个人在第5组第8个位置</p> </div> <p>假设插入的数值为<span class=arithmatex>\(x\)</span>，则根据上面的引例可以有下面的步骤（一个整型数值占32个比特位）：</p> <ol> <li>首先确定待映射的数值在第几个整数（类比引例中的「第几组」）：<span class=arithmatex>\(x \div 32\)</span></li> <li>接着确定待映射的数值在第几个比特位（类比引例中的「第几个位置」）：<span class=arithmatex>\(x \mod 32\)</span></li> </ol> <p>通过上面的两个步骤就可以完全确定该数值的具体映射位置，例如数值23的映射位置为：第<span class=arithmatex>\(23 \div 32 = 0\)</span>个整数第<span class=arithmatex>\(23 \mod 32 = 23\)</span>个比特位（下标）</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>上面的下标是从1开始计算，直接将具体位置作为下标值</p> </div> <p>有了映射位置，就证明该数值已经有了对应的标记位置，接下来要处理的就是如何标记</p> <p>所谓的标记，实际上就是将数值对应的映射位置置为1，最大的前提就是不能修改其他位置的标记，可以考虑下面的思路：</p> <p>假设已经标记的整数二进制为<code>00000100 01110000 00011000 00000000</code>（左低右高），现在要标记第23个比特位，为了保证不改变其他比特位，可以考虑使用保留原值情况最多的<a href=https://www.help-doc.top/c-lang/op/op.html#_20>或运算</a>，假设将原二进制与1进行与运算，就可以得到下面的结果：</p> <p><a class=glightbox href="14. 位图.assets\image1.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image1.png" style=width:70%></a></p> <p>现在需要在第23个比特位处将0置为1，就需要在获取一个在第23个比特位为1其余比特位为0的整型数值，如果直接考虑这种数值，则根据计算器可以得到该数值：</p> <p><a class=glightbox href="14. 位图.assets\image2.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image2.png" style=width:70%></a></p> <p>可以看到这个数值非常大，而且如果依次列举，则时间复杂度也会特别高，所以可以考虑使用移位运算符，将<code>10000000 00000000 00000000 00000000</code>中的1移动到第23个比特位</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>这一步可能会考虑到一个问题：大小端字节序 在模拟移位过程中需要使用左移，在C语言/C++数组中，存储一个数值是从数组的低位开始存储，而一个数值存储到内存中在小端机器是按照小端字节序存储，大端机器按照大端字节序存储（具体内容见<a href=https://www.help-doc.top/c-lang/num-in-memory/num-in-memory.html#_17>C语言部分讲解大端与小端字节序</a>），此时就会出现既需要考虑数组的最低位以及数值的最低位，以考虑数值的最低位为例，可能会考虑到的效果：</p> <p><a class=glightbox href="14. 位图.assets\image3.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image3.png"></a></p> </div> <p>但是实际上，可以不用考虑上面到底哪一侧是低位哪一侧是高位，因为在标准底层实现左移和右移时已经考虑到对应的机器的字节序了，所以左移真正的定义是「从低位向高位移动」，而不是「向左边移动」，右移则是「从高位向低位移动」，而不是「向右边移动」，所以正确的思路图如下，以左移为例：</p> <p><a class=glightbox href="14. 位图.assets\image4.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image4.png" style=width:70%></a></p> <p>所以结合或运算和与运算符就可以实现在映射位置标记（假设插入的数值为<span class=arithmatex>\(x\)</span>）：</p> <ol> <li>将最低位1通过左移运算符移动到第<span class=arithmatex>\(x\)</span>个比特位</li> <li>通过或运算符将移动1的数值与原二进制对应的数值进行或运算</li> <li>将或运算结果赋值给对应的数值在数组中的下标位置「第几组」</li> </ol> <h3 id=_5>位图如何取消标记<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <p>解决了如何实现标记，接下来考虑如何取消标记，以<code>10000100 01110000 00011000 00000000</code>为例，假设要取消从左往右数的第11个1，就要将第11个比特位的1置为0，而此时如果再使用或运算与1进行计算就无法达到需要的效果，剩下三种位运算：<code>&amp;</code>、<code>^</code>和<code>~</code></p> <h4 id=_6>与运算和取反运算结合<a class=headerlink href=#_6 title="Permanent link">&para;</a></h4> <p>考虑<a href=https://www.help-doc.top/c-lang/op/op.html#_19>与运算</a>的特点：同1为1，有0则0，如果进行与运算则结果如下：</p> <p><a class=glightbox href="14. 位图.assets\image5.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image5.png" style=width:70%></a></p> <p>可以发现，直接使用与运算符将原数值二进制和1相与会导致除了均为1的位以外其他全变成了0，违背了「不改变其他位的原则」，既然如此那么就反着来：「把1中比特位为1的变为0，把比特位为0的变成1」，所以考虑在与运算之前对1先进行<a href=https://www.help-doc.top/c-lang/op/op.html#_22>取反运算</a>，可以看到下面的效果：</p> <p><a class=glightbox href="14. 位图.assets\image6.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image6.png" style=width:70%></a></p> <p>可以看到原来全为1时的结果由1变成了0，其他位没有改变，所以本思路可行</p> <h4 id=_7>异或运算<a class=headerlink href=#_7 title="Permanent link">&para;</a></h4> <p>在使用「与运算和取反运算结合」结合时可以发现一个特点，需要的结果是「相同的为0（取消标记），不同为1（不改变标记）」，这个结果与<a href=https://www.help-doc.top/c-lang/op/op.html#_21>异或运算</a>的特点：异1同0，完全一致，以同样的二进制数值与1进行异或运算，下面是运算过程：</p> <p><a class=glightbox href="14. 位图.assets\image7.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image7.png" style=width:70%></a></p> <p>可以看到原来全为1时的结果由1变成了0，其他位没有改变，所以本思路也可行</p> <h4 id=_8>结合左移运算符取消标记<a class=headerlink href=#_8 title="Permanent link">&para;</a></h4> <p>前面使用了左移运算符，考虑此处是否可以使用左移运算符</p> <p>首先需要获取到映射位置，方法与设置标记处相同：</p> <p>假设插入的数值为<span class=arithmatex>\(x\)</span>，则根据上面的引例可以有下面的步骤（一个整型数值占32个比特位）：</p> <ol> <li>首先确定待映射的数值在第几个整数（类比引例中的「第几组」）：<span class=arithmatex>\(x \div 32\)</span></li> <li>接着确定待映射的数值在第几个比特位（类比引例中的「第几个位置」）：<span class=arithmatex>\(x \mod 32\)</span></li> </ol> <p>以<code>10000100 01110000 00011000 00000000</code>为例（左低右高），取消第11个比特位的标记，可以考虑将1的二进制中为1的位左移11位，与运算和取反运算结合，计算结果如下：</p> <p><a class=glightbox href="14. 位图.assets\image8.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image8.png"></a></p> <p>可以看到需要取消标记的位已经置为了0，其他位也并没有影响，满足取消标记的要求</p> <p>考虑异或运算是否也可以取消：</p> <p><a class=glightbox href="14. 位图.assets\image9.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="14. 位图.assets\image9.png"></a></p> <p>通过计算发现也可以做到同样的效果，满足取消标记的要求</p> <p>所以结合「与运算符和取反运算符」和「左移运算符」就可以取消在映射位置标记（假设插入的数值为<span class=arithmatex>\(x\)</span>）：</p> <ol> <li>将最低位1通过左移运算符移动到第<span class=arithmatex>\(x\)</span>个比特位</li> <li>对移动后的1的二进制进行取反运算</li> <li>将取反运算结果和原二进制对应的数值进行与运算</li> <li>将与运算结果赋值给对应的数值在数组中的下标位置「第几组」</li> </ol> <p>或者「异或运算符」和「左移运算符」（假设插入的数值为<span class=arithmatex>\(x\)</span>）：</p> <ol> <li>将最低位1通过左移运算符移动到第<span class=arithmatex>\(x\)</span>个比特位</li> <li>将移动后的1的二进制结果和原二进制对应的数值进行异或运算</li> <li>将异或运算结果赋值给对应的数值在数组中的下标位置「第几组」</li> </ol> <h3 id=_9>判断是否存在<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>所谓判断是否存在，就是判断指定数值是否在位图中，前面提到如果存在则对应二进制位为1，否则为0，所以只需要确定指定数值的映射位置是否为1即可判断指定数值是否存在</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>此处注意一个细节：任何一个数值只要不是0，其二进制位至少存在一位为1</p> </div> <h2 id=_10>位图代码实现<a class=headerlink href=#_10 title="Permanent link">&para;</a></h2> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><span class=k>namespace</span><span class=w> </span><span class=nn>simulate_bitset</span>
</span><span id=__span-0-2><span class=p>{</span>
</span><span id=__span-0-3><span class=w>    </span><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=kt>size_t</span><span class=w> </span><span class=n>N</span><span class=o>&gt;</span>
</span><span id=__span-0-4><span class=w>    </span><span class=k>class</span><span class=w> </span><span class=nc>bitset</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-0-5><span class=w>    </span><span class=k>public</span><span class=o>:</span>
</span><span id=__span-0-6><span class=w>        </span><span class=n>bitset</span><span class=p>()</span>
</span><span id=__span-0-7><span class=w>        </span><span class=p>{</span>
</span><span id=__span-0-8><span class=w>            </span><span class=c1>// 提前开辟空间，为了保证空间在65/32这种情况下依旧有空间，可以多开辟一个无符号整型的空间</span>
</span><span id=__span-0-9><span class=w>            </span><span class=n>_bs</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>N</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-0-10><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-11>
</span><span id=__span-0-12><span class=w>        </span><span class=c1>// 设置标记</span>
</span><span id=__span-0-13><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>set</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-0-14><span class=w>        </span><span class=p>{</span>
</span><span id=__span-0-15><span class=w>            </span><span class=c1>// 找到映射位置</span>
</span><span id=__span-0-16><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_group</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-17><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_detail</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-18>
</span><span id=__span-0-19><span class=w>            </span><span class=c1>// 左移+或运算</span>
</span><span id=__span-0-20><span class=w>            </span><span class=n>_bs</span><span class=p>[</span><span class=n>pos_group</span><span class=p>]</span><span class=w> </span><span class=o>|=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>pos_detail</span><span class=p>);</span>
</span><span id=__span-0-21><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-22>
</span><span id=__span-0-23><span class=w>        </span><span class=c1>// 取消标记</span>
</span><span id=__span-0-24><span class=w>        </span><span class=kt>void</span><span class=w> </span><span class=n>reset</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-0-25><span class=w>        </span><span class=p>{</span>
</span><span id=__span-0-26><span class=w>            </span><span class=c1>// 找到映射位置</span>
</span><span id=__span-0-27><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_group</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-28><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_detail</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-29>
</span><span id=__span-0-30><span class=w>            </span><span class=c1>// 左移+取反运算+与运算</span>
</span><span id=__span-0-31><span class=w>            </span><span class=c1>// _bs[pos_group] &amp;= (~(1 &lt;&lt; pos_detail));</span>
</span><span id=__span-0-32><span class=w>            </span><span class=c1>// 左移+异或运算</span>
</span><span id=__span-0-33><span class=w>            </span><span class=n>_bs</span><span class=p>[</span><span class=n>pos_group</span><span class=p>]</span><span class=w> </span><span class=o>^=</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>pos_detail</span><span class=p>);</span>
</span><span id=__span-0-34><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-35>
</span><span id=__span-0-36><span class=w>        </span><span class=c1>// 测试</span>
</span><span id=__span-0-37><span class=w>        </span><span class=kt>bool</span><span class=w> </span><span class=n>test</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-0-38><span class=w>        </span><span class=p>{</span>
</span><span id=__span-0-39><span class=w>            </span><span class=c1>// 找到映射位置</span>
</span><span id=__span-0-40><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_group</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-41><span class=w>            </span><span class=kt>size_t</span><span class=w> </span><span class=n>pos_detail</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>num</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=p>(</span><span class=k>sizeof</span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>8</span><span class=p>);</span>
</span><span id=__span-0-42>
</span><span id=__span-0-43><span class=w>            </span><span class=c1>// 判断指定位是否为1</span>
</span><span id=__span-0-44><span class=w>            </span><span class=k>return</span><span class=w> </span><span class=n>_bs</span><span class=p>[</span><span class=n>pos_group</span><span class=p>]</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>pos_detail</span><span class=p>);</span>
</span><span id=__span-0-45><span class=w>        </span><span class=p>}</span>
</span><span id=__span-0-46>
</span><span id=__span-0-47><span class=w>    </span><span class=k>private</span><span class=o>:</span>
</span><span id=__span-0-48><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs</span><span class=p>;</span>
</span><span id=__span-0-49><span class=w>    </span><span class=p>};</span>
</span><span id=__span-0-50><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>注意，上面位图不考虑负数的情况，否则会导致未定义行为，如果将三个函数的参数类型已经位置变量类型改为<code>int</code>，在<code>g++</code>可能可以成功，但是这个结果不是确定的</p> </div> <h2 id=_11>位图的优缺点<a class=headerlink href=#_11 title="Permanent link">&para;</a></h2> <p>优点：增删查改快，节省空间</p> <p>缺点：只适用于整形</p> <h2 id=_12>位图相关考察题目<a class=headerlink href=#_12 title="Permanent link">&para;</a></h2> <ol> <li>给定100亿个整数，设计算法找到只出现一次的整数</li> <li>给两个文件，分别有100亿个整数，只有1G内存，如何找到两个文件交集</li> <li>一个文件有100亿个整数，只有1G内存，设计算法找到出现次数不超过2次的所有整数</li> </ol> <p>第一个问题和第三个问题基本是一致的，考虑第一个问题，「只出现一次」则可以分为三种情况：</p> <ol> <li>没出现</li> <li>出现一次</li> <li>出现两次及以上</li> </ol> <p>此时只使用前面的一位作为标记位就不够了，需要使用两个标记位，所以上面的三种情况对应的二进制位分别为：</p> <ol> <li>没出现：00</li> <li>出现一次：01</li> <li>出现两次：10</li> </ol> <p>以100个无符号整数为例，所以对应的<code>bitset</code>结构可以为如下代码：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=kt>size_t</span><span class=w> </span><span class=n>N</span><span class=o>&gt;</span>
</span><span id=__span-1-2><span class=k>class</span><span class=w> </span><span class=nc>bitsetForTwo</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-1-4><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=n>set</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-1-5><span class=w>    </span><span class=p>{</span>
</span><span id=__span-1-6><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span>
</span><span id=__span-1-7><span class=w>        </span><span class=p>{</span>
</span><span id=__span-1-8><span class=w>            </span><span class=c1>// 一次没出现</span>
</span><span id=__span-1-9><span class=w>            </span><span class=n>_bs2</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span><span class=w> </span><span class=c1>// 00 -&gt; 01</span>
</span><span id=__span-1-10><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-11><span class=w>        </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span>
</span><span id=__span-1-12><span class=w>        </span><span class=p>{</span>
</span><span id=__span-1-13><span class=w>            </span><span class=c1>// 出现一次 01 -&gt; 10</span>
</span><span id=__span-1-14><span class=w>            </span><span class=n>_bs1</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-1-15><span class=w>            </span><span class=n>_bs2</span><span class=p>.</span><span class=n>reset</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-1-16><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-17><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-18>
</span><span id=__span-1-19><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>test</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-1-20><span class=w>    </span><span class=p>{</span>
</span><span id=__span-1-21><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-1-22><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-23>
</span><span id=__span-1-24><span class=k>private</span><span class=o>:</span>
</span><span id=__span-1-25><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs1</span><span class=p>;</span>
</span><span id=__span-1-26><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs2</span><span class=p>;</span>
</span><span id=__span-1-27><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>第三个问题只需要获取不超过两次的数值（以100个无符号整数为例）即可，基本思路与第一个问题一致，修改代码如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=k>template</span><span class=w> </span><span class=o>&lt;</span><span class=kt>size_t</span><span class=w> </span><span class=n>N</span><span class=o>&gt;</span>
</span><span id=__span-2-2><span class=k>class</span><span class=w> </span><span class=nc>bitsetForTwo</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-3><span class=k>public</span><span class=o>:</span>
</span><span id=__span-2-4><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=n>set</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-2-5><span class=w>    </span><span class=p>{</span>
</span><span id=__span-2-6><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span>
</span><span id=__span-2-7><span class=w>        </span><span class=p>{</span>
</span><span id=__span-2-8><span class=w>            </span><span class=c1>// 一次没出现</span>
</span><span id=__span-2-9><span class=w>            </span><span class=n>_bs2</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span><span class=w> </span><span class=c1>// 00 -&gt; 01</span>
</span><span id=__span-2-10><span class=w>        </span><span class=p>}</span>
</span><span id=__span-2-11><span class=w>        </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span>
</span><span id=__span-2-12><span class=w>        </span><span class=p>{</span>
</span><span id=__span-2-13><span class=w>            </span><span class=c1>// 出现一次 01 -&gt; 10</span>
</span><span id=__span-2-14><span class=w>            </span><span class=n>_bs1</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-2-15><span class=w>            </span><span class=n>_bs2</span><span class=p>.</span><span class=n>reset</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-2-16><span class=w>        </span><span class=p>}</span>
</span><span id=__span-2-17><span class=w>        </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span>
</span><span id=__span-2-18><span class=w>        </span><span class=p>{</span>
</span><span id=__span-2-19><span class=w>            </span><span class=c1>// 出现两次 10 -&gt; 11</span>
</span><span id=__span-2-20><span class=w>            </span><span class=n>_bs1</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-2-21><span class=w>            </span><span class=n>_bs2</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-2-22><span class=w>        </span><span class=p>}</span>
</span><span id=__span-2-23><span class=w>    </span><span class=p>}</span>
</span><span id=__span-2-24>
</span><span id=__span-2-25><span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>test</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>num</span><span class=p>)</span>
</span><span id=__span-2-26><span class=w>    </span><span class=p>{</span>
</span><span id=__span-2-27><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>))</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>_bs1</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>num</span><span class=p>);</span>
</span><span id=__span-2-28><span class=w>    </span><span class=p>}</span>
</span><span id=__span-2-29>
</span><span id=__span-2-30><span class=k>private</span><span class=o>:</span>
</span><span id=__span-2-31><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs1</span><span class=p>;</span>
</span><span id=__span-2-32><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs2</span><span class=p>;</span>
</span><span id=__span-2-33><span class=p>};</span>
</span></code></pre></div></td></tr></table></div> <p>考虑第二个问题（以100个无符号整数为例），所谓交集，就是两个位图同时为1，即取出11，测试代码如下：</p> <div class="language-c++ highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-3-2><span class=p>{</span>
</span><span id=__span-3-3><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs2</span><span class=p>;</span>
</span><span id=__span-3-4><span class=w>    </span><span class=n>simulate_bitset</span><span class=o>::</span><span class=n>bitset</span><span class=o>&lt;</span><span class=mi>100</span><span class=o>&gt;</span><span class=w> </span><span class=n>_bs3</span><span class=p>;</span>
</span><span id=__span-3-5>
</span><span id=__span-3-6><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a1</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>7</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>9</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>55</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>6</span><span class=w> </span><span class=p>};</span>
</span><span id=__span-3-7><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>a2</span><span class=p>[]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>99</span><span class=p>,</span><span class=mi>33</span><span class=p>,</span><span class=mi>66</span><span class=p>};</span>
</span><span id=__span-3-8><span class=w>    </span><span class=c1>// 插入数据</span>
</span><span id=__span-3-9><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a1</span><span class=p>)</span>
</span><span id=__span-3-10><span class=w>    </span><span class=p>{</span>
</span><span id=__span-3-11><span class=w>        </span><span class=n>_bs2</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span><span id=__span-3-12><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-13>
</span><span id=__span-3-14><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>a2</span><span class=p>)</span>
</span><span id=__span-3-15><span class=w>    </span><span class=p>{</span>
</span><span id=__span-3-16><span class=w>        </span><span class=n>_bs3</span><span class=p>.</span><span class=n>set</span><span class=p>(</span><span class=n>a</span><span class=p>);</span>
</span><span id=__span-3-17><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-18>
</span><span id=__span-3-19><span class=w>    </span><span class=k>for</span><span class=p>(</span><span class=kt>size_t</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>100</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-3-20><span class=w>    </span><span class=p>{</span>
</span><span id=__span-3-21><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=n>_bs2</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>_bs3</span><span class=p>.</span><span class=n>test</span><span class=p>(</span><span class=n>i</span><span class=p>))</span>
</span><span id=__span-3-22><span class=w>        </span><span class=p>{</span>
</span><span id=__span-3-23><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-3-24><span class=w>        </span><span class=p>}</span>
</span><span id=__span-3-25><span class=w>    </span><span class=p>}</span>
</span><span id=__span-3-26><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-3-27><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年7月30日</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> 页面有帮助吗？ </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title=页面对我有帮助 data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title=页面没有帮助到我 data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> 谢谢你的反馈！ </div> <div data-md-value=0 hidden> 谢谢你的反馈！联系<a href=https://www.help-doc.top/author/contact/contact.html>作者</a>提供更详细的信息 </div> </div> </div> </fieldset> </form> <!-- Waline 评论系统 --> <div id=waline></div> <!-- 阅读进度条 - 直接在HTML中定义 --> <div class=reading-progress></div> <!-- 滚动指示器 - 直接在HTML中定义 --> <div class=scroll-indicator></div> <!-- 评论系统 --> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Footer --> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../javascripts/katex.min.js></script> <script src=../../javascripts/other.min.js></script> <script src=../../javascripts/copyright.min.js></script> <script src=../../javascripts/waline.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script src=../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>