const fontConfig={"dongguanti":{name:"上图东观体",id:"font-dongguanti"},"oppoti":{name:"OPPO Sans",id:"font-oppoti"},"jiangchengti":{name:"江城黑体",id:"font-jiangchengti"},"lxgw":{name:"霞鹜臻楷",id:"font-lxgw"}};const codeFontConfig={"google-sans-code":{name:"Google Sans Code",id:"code-font-google-sans-code"},"dejavu":{name:"DejaVu Sans Mono",id:"code-font-dejavu-sans-mono"},"zsft":{name:"JetBrains Mono",id:"code-font-zsft-hk"}};(function initFont(){const savedFont=localStorage.getItem("preferred-font")||"dongguanti";Object.values(fontConfig).forEach(font=>{const link=document.getElementById(font.id);if(link){link.setAttribute("disabled","true");}});const selectedFontLink=document.getElementById(fontConfig[savedFont].id);if(selectedFontLink){selectedFontLink.removeAttribute("disabled");}})();(function initCodeFont(){const savedCodeFont=localStorage.getItem("preferred-code-font")||"dejavu";Object.values(codeFontConfig).forEach(font=>{const link=document.getElementById(font.id);if(link){link.setAttribute("disabled","true");}});const selectedCodeFontLink=document.getElementById(codeFontConfig[savedCodeFont].id);if(selectedCodeFontLink){selectedCodeFontLink.removeAttribute("disabled");}})();document.addEventListener("DOMContentLoaded",()=>{const savedTheme=localStorage.getItem("preferred-theme")||"theme2";const savedFont=localStorage.getItem("preferred-font")||"dongguanti";const savedCodeFont=localStorage.getItem("preferred-code-font")||"dejavu";updateFontDropdownToolbar(savedFont);applyFont(savedFont);updateCodeFontDropdownToolbar(savedCodeFont);applyCodeFont(savedCodeFont);initToolbarState();initDesktopTheme();setTimeout(()=>{const hiddenElements=document.querySelectorAll('.md-content article>*[style*="opacity: 0"]');hiddenElements.forEach(el=>{el.style.opacity='1';el.style.transform='translateY(0)';});},2000);});function initDesktopTheme(){const savedTheme=localStorage.getItem("preferred-theme")||"theme2";const theme1Link=document.getElementById("theme1-desktop");const theme2Link=document.getElementById("theme2-desktop");if(theme1Link&&theme2Link){if(savedTheme==="theme1"){theme1Link.removeAttribute("disabled");theme2Link.removeAttribute("disabled");}else{theme1Link.setAttribute("disabled","true");theme2Link.removeAttribute("disabled");}}}
(function initTheme(){const savedTheme=localStorage.getItem("preferred-theme")||"theme2";const theme1Link=document.getElementById("theme1-desktop");const theme2Link=document.getElementById("theme2-desktop");if(theme1Link&&theme2Link){if(savedTheme==="theme1"){theme1Link.removeAttribute("disabled");theme2Link.removeAttribute("disabled");}else{theme1Link.setAttribute("disabled","true");theme2Link.removeAttribute("disabled");}}})();function toggleDropdown(targetSelector,otherSelector){const dropdown=document.querySelector(targetSelector);const otherDropdown=document.querySelector(otherSelector);const isActive=dropdown.classList.contains('active');if(isActive){dropdown.classList.remove('active');return;}
if(otherDropdown&&otherDropdown.classList.contains('active')){const handleTransitionEnd=(event)=>{if(event.target===otherDropdown&&(event.propertyName==='opacity'||event.propertyName==='transform')){otherDropdown.removeEventListener('transitionend',handleTransitionEnd);dropdown.classList.add('active');}};otherDropdown.addEventListener('transitionend',handleTransitionEnd);otherDropdown.classList.remove('active');setTimeout(()=>{otherDropdown.removeEventListener('transitionend',handleTransitionEnd);if(!dropdown.classList.contains('active')){dropdown.classList.add('active');}},350);}else{dropdown.classList.add('active');}}
function toggleFontDropdownToolbar(){toggleDropdown('.font-dropdown-toolbar','.code-font-dropdown-toolbar');}
function toggleCodeFontDropdownToolbar(){toggleDropdown('.code-font-dropdown-toolbar','.font-dropdown-toolbar');}
function applyFontStyle(config,fontKey,storageKey){Object.values(config).forEach(font=>{const link=document.getElementById(font.id);if(link)link.setAttribute("disabled","true");});const selectedLink=document.getElementById(config[fontKey].id);if(selectedLink)selectedLink.removeAttribute("disabled");localStorage.setItem(storageKey,fontKey);}
function updateDropdownDisplay(config,fontKey,nameSelector,optionSelector,dataAttr){const nameEl=document.querySelector(nameSelector);const options=document.querySelectorAll(optionSelector);if(nameEl)nameEl.textContent=config[fontKey].name;options.forEach(option=>{const key=option.getAttribute(dataAttr);option.classList.toggle('selected',key===fontKey);});}
function selectFontToolbar(fontKey){applyFontStyle(fontConfig,fontKey,"preferred-font");updateDropdownDisplay(fontConfig,fontKey,".current-font-name-toolbar",".font-option-toolbar","data-font");document.querySelector('.font-dropdown-toolbar').classList.remove('active');}
function selectCodeFontToolbar(codeFontKey){applyFontStyle(codeFontConfig,codeFontKey,"preferred-code-font");updateDropdownDisplay(codeFontConfig,codeFontKey,".current-code-font-name-toolbar",".code-font-option-toolbar","data-code-font");document.querySelector('.code-font-dropdown-toolbar').classList.remove('active');}
function applyFont(fontKey){applyFontStyle(fontConfig,fontKey,"preferred-font");}
function applyCodeFont(codeFontKey){applyFontStyle(codeFontConfig,codeFontKey,"preferred-code-font");}
function updateFontDropdownToolbar(currentFontKey){updateDropdownDisplay(fontConfig,currentFontKey,".current-font-name-toolbar",".font-option-toolbar","data-font");}
function updateCodeFontDropdownToolbar(currentCodeFontKey){updateDropdownDisplay(codeFontConfig,currentCodeFontKey,".current-code-font-name-toolbar",".code-font-option-toolbar","data-code-font");}
function scrollToTop(){window.scrollTo({top:0,});}
function toggleToolbar(){const toolbar=document.getElementById('floatingToolbar');const toggleBtn=document.getElementById('toolbarToggleBtn');if(!toolbar||!toggleBtn){console.error('无法找到功能条或切换按钮元素');return;}
const isHidden=toolbar.classList.contains('hidden');if(isHidden){toolbar.classList.remove('hidden');toggleBtn.classList.remove('toolbar-hidden');localStorage.setItem('toolbar-visible','true');}else{toolbar.classList.add('hidden');toggleBtn.classList.add('toolbar-hidden');localStorage.setItem('toolbar-visible','false');}}
function initToolbarState(){const toolbar=document.getElementById('floatingToolbar');const toggleBtn=document.getElementById('toolbarToggleBtn');const isVisible=localStorage.getItem('toolbar-visible');if(!toolbar||!toggleBtn){return;}
if(isVisible==='false'){toolbar.classList.add('hidden');toggleBtn.classList.add('toolbar-hidden');}else{toolbar.classList.remove('hidden');toggleBtn.classList.remove('toolbar-hidden');}}
function hideAllSubmenus(){const fontDropdown=document.querySelector('.font-dropdown-toolbar');if(fontDropdown){fontDropdown.classList.remove('active');}
const codeFontDropdown=document.querySelector('.code-font-dropdown-toolbar');if(codeFontDropdown){codeFontDropdown.classList.remove('active');}
}
document.addEventListener('click',function(event){const fontDropdown=document.querySelector('.font-dropdown-toolbar');const codeFontDropdown=document.querySelector('.code-font-dropdown-toolbar');const fontSwitcher=document.querySelector('.font-switcher');if(fontSwitcher&&fontDropdown&&!fontSwitcher.contains(event.target)){fontDropdown.classList.remove('active');}
const codeFontSwitcher=document.querySelector('.code-font-switcher');if(codeFontSwitcher&&codeFontDropdown&&!codeFontSwitcher.contains(event.target)){codeFontDropdown.classList.remove('active');}});document.addEventListener('DOMContentLoaded',function(){const toolbarItems=document.querySelectorAll('.toolbar-item:not(.font-switcher):not(.code-font-switcher)');toolbarItems.forEach(item=>{item.addEventListener('click',function(){hideAllSubmenus();});item.addEventListener('mouseenter',function(){hideAllSubmenus();});});let fontDropdownTimer=null;let codeFontDropdownTimer=null;const fontSwitcher=document.querySelector('.font-switcher');if(fontSwitcher){fontSwitcher.addEventListener('mouseleave',function(){if(fontDropdownTimer){clearTimeout(fontDropdownTimer);}
fontDropdownTimer=setTimeout(function(){const fontDropdown=document.querySelector('.font-dropdown-toolbar');if(fontDropdown){fontDropdown.classList.remove('active');}},50);});fontSwitcher.addEventListener('mouseenter',function(){if(fontDropdownTimer){clearTimeout(fontDropdownTimer);fontDropdownTimer=null;}});}
const codeFontSwitcher=document.querySelector('.code-font-switcher');if(codeFontSwitcher){codeFontSwitcher.addEventListener('mouseleave',function(){if(codeFontDropdownTimer){clearTimeout(codeFontDropdownTimer);}
codeFontDropdownTimer=setTimeout(function(){const codeFontDropdown=document.querySelector('.code-font-dropdown-toolbar');if(codeFontDropdown){codeFontDropdown.classList.remove('active');}},50);});codeFontSwitcher.addEventListener('mouseenter',function(){if(codeFontDropdownTimer){clearTimeout(codeFontDropdownTimer);codeFontDropdownTimer=null;}});}});function switchTheme(){const currentTheme=localStorage.getItem("preferred-theme")||"theme2";const newTheme=currentTheme==="theme1"?"theme2":"theme1";const targetThemeText=newTheme==="theme1"?"新版主题":"原生主题";const theme1Link=document.getElementById("theme1-desktop");const theme2Link=document.getElementById("theme2-desktop");if(!theme1Link||!theme2Link){console.error("无法找到桌面端主题样式链接");return;}
const overlay=document.createElement("div");overlay.className="theme-transition-overlay";overlay.innerHTML=`
        <div class="theme-transition-content">
            <div class="theme-transition-spinner"></div>
            <div class="theme-transition-text">正在切换到：${targetThemeText}</div>
        </div>
    `;document.body.appendChild(overlay);requestAnimationFrame(()=>{overlay.classList.add("active");setTimeout(()=>{if(newTheme==="theme1"){theme1Link.removeAttribute("disabled");theme2Link.removeAttribute("disabled");}else{theme1Link.setAttribute("disabled","true");theme2Link.removeAttribute("disabled");}
localStorage.setItem("preferred-theme",newTheme);setTimeout(()=>{fadeOutOverlay(overlay);},2500);},250);});}
function fadeOutOverlay(overlay){overlay.style.backgroundColor="rgba(255, 255, 255, 0.85)";setTimeout(()=>{overlay.classList.remove("active");setTimeout(()=>{document.body.removeChild(overlay);},300);},150);}