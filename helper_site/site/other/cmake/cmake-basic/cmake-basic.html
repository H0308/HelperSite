<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/other/cmake/cmake-basic/cmake-basic.html><link rel=prev href=../../muduo/muduo.html><link rel=next href=../../yaml/yaml.html><link rel=icon href=../../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.0"><title>CMake控制台命令核心操作 - 柯懒的知识库</title><link rel=stylesheet href=../../../assets/stylesheets/main.618322db.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=stylesheet href=../../../css/timeline.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link rel=preload href=../../../stylesheets/docsearch.min.css as=style><link rel=preload href=../../../stylesheets/colors.min.css as=style><link rel=preload href=../../../stylesheets/theme2.min.css as=style><link rel=preload href=https://help-site.oss-cn-hangzhou.aliyuncs.com/images/author/avatar.jpg as=image><link rel=preload href=https://help-site.oss-cn-hangzhou.aliyuncs.com/css/katex.min.css as=style><link rel=dns-prefetch href=//unpkg.com><link rel=dns-prefetch href=//cloud.umami.is><link rel=stylesheet href=../../../stylesheets/colors.min.css><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)"><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)"><link rel=stylesheet href=../../../stylesheets/print.min.css><link rel=stylesheet href=https://help-site.oss-cn-hangzhou.aliyuncs.com/css/katex.min.css><link rel=stylesheet href=https://help-site.oss-cn-hangzhou.aliyuncs.com/css/docsearch3.css><link rel=stylesheet href=../../../stylesheets/docsearch.min.css><script defer src=https://cloud.umami.is/script.js data-website-id=02f9b8b7-93d4-4026-bdd8-221f2fcea2cf></script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cmake class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> CMake控制台命令核心操作 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <div class=header-avatar> <img src=https://help-site.oss-cn-hangzhou.aliyuncs.com/images/author/avatar.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../../author/contact/contact.html class=avatar-dropdown-item>联系作者</a> <div class=avatar-dropdown-divider></div> <a href=../../../author/about/about.html class=avatar-dropdown-item>关于作者</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>Github仓库</a> </div> </div> <div id=docsearch></div> </nav> </header> <!-- <div class="back-to-top-btn" id="backToTopBtn"  onclick="window.scrollTo({top: 0})">
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"/>
    </svg>
</div> --> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../../languages/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../../data-structure-algo/index.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class=md-tabs__item> <a href=../../../Linux/index.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../front-end/index.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../../MySQL/index.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../../JavaEE/index.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../../software-test/index.html class=md-tabs__link> 软件测试 </a> </li> <li class=md-tabs__item> <a href=../../../docker/index.html class=md-tabs__link> 容器化 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../index.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../../tooltips/index.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../../projects/index.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../languages/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data-structure-algo/index.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../Linux/index.html class=md-nav__link> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../front-end/index.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../MySQL/index.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../JavaEE/index.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../software-test/index.html class=md-nav__link> <span class=md-ellipsis> 软件测试 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../docker/index.html class=md-nav__link> <span class=md-ellipsis> 容器化 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11 checked> <div class="md-nav__link md-nav__container"> <a href=../../index.html class="md-nav__link "> <span class=md-ellipsis> 扩展知识 </span> </a> <label class="md-nav__link " for=__nav_11 id=__nav_11_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_11_label aria-expanded=true> <label class=md-nav__title for=__nav_11> <span class="md-nav__icon md-icon"></span> 扩展知识 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shell/shell.html class=md-nav__link> <span class=md-ellipsis> 关于Shell </span> </a> </li> <li class=md-nav__item> <a href=../../func-stack-c/func-stack-c.html class=md-nav__link> <span class=md-ellipsis> 关于函数栈帧（C语言演示） </span> </a> </li> <li class=md-nav__item> <a href=../../xml/xml.html class=md-nav__link> <span class=md-ellipsis> 关于XML文件 </span> </a> </li> <li class=md-nav__item> <a href=../../jsoncpp/jsoncpp.html class=md-nav__link> <span class=md-ellipsis> 关于JSONCPP库 </span> </a> </li> <li class=md-nav__item> <a href=../../spdlog/spdlog.html class=md-nav__link> <span class=md-ellipsis> 关于C++日志库spdlog </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11_7> <label class=md-nav__link for=__nav_11_7 id=__nav_11_7_label tabindex> <span class=md-ellipsis> 关于Git </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_11_7_label aria-expanded=false> <label class=md-nav__title for=__nav_11_7> <span class="md-nav__icon md-icon"></span> 关于Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../git/git-basic/git-basic.html class=md-nav__link> <span class=md-ellipsis> Git基础操作 </span> </a> </li> <li class=md-nav__item> <a href=../../git/git-collaboration/git-collaboration.html class=md-nav__link> <span class=md-ellipsis> Git多人协作 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../muduo/muduo.html class=md-nav__link> <span class=md-ellipsis> 关于Muduo库 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_11_9 checked> <label class=md-nav__link for=__nav_11_9 id=__nav_11_9_label tabindex> <span class=md-ellipsis> 关于CMake </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_11_9_label aria-expanded=true> <label class=md-nav__title for=__nav_11_9> <span class="md-nav__icon md-icon"></span> 关于CMake </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> CMake控制台命令核心操作 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=cmake-basic.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> CMake控制台命令核心操作 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ubuntucmake class=md-nav__link> <span class=md-ellipsis> Ubuntu下安装CMake </span> </a> </li> <li class=md-nav__item> <a href=#cmake_1 class=md-nav__link> <span class=md-ellipsis> CMake介绍 </span> </a> </li> <li class=md-nav__item> <a href=#cmake_2 class=md-nav__link> <span class=md-ellipsis> CMake从构建到可执行程序 </span> </a> </li> <li class=md-nav__item> <a href=#cmake_3 class=md-nav__link> <span class=md-ellipsis> CMake从构建到打包基本流程 </span> </a> <nav class=md-nav aria-label=CMake从构建到打包基本流程> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 基本介绍与配置准备 </span> </a> </li> <li class=md-nav__item> <a href=#ctest class=md-nav__link> <span class=md-ellipsis> 使用CTest单元测试 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 使用安装命令进行程序安装 </span> </a> </li> <li class=md-nav__item> <a href=#cpack class=md-nav__link> <span class=md-ellipsis> 使用CPack进行打包 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 脚本模式 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 调用外部命令 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 配置命令详细介绍 </span> </a> <nav class=md-nav aria-label=配置命令详细介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 最低安装版本命令 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 项目命令 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 安装命令 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 包含命令 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 添加可执行程序命令 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../yaml/yaml.html class=md-nav__link> <span class=md-ellipsis> 关于YAML文件 </span> </a> </li> <li class=md-nav__item> <a href=../../json_schema/json_schema.html class=md-nav__link> <span class=md-ellipsis> 关于JSON Schema </span> </a> </li> <li class=md-nav__item> <a href=../../regex/regex.html class=md-nav__link> <span class=md-ellipsis> 关于正则表达式 </span> </a> </li> <li class=md-nav__item> <a href=../../easy-excel/easy-excel.html class=md-nav__link> <span class=md-ellipsis> 关于EasyExcel </span> </a> </li> <li class=md-nav__item> <a href=../../knife4j/knife4j.html class=md-nav__link> <span class=md-ellipsis> 关于Knife4j </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../tooltips/index.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../projects/index.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ubuntucmake class=md-nav__link> <span class=md-ellipsis> Ubuntu下安装CMake </span> </a> </li> <li class=md-nav__item> <a href=#cmake_1 class=md-nav__link> <span class=md-ellipsis> CMake介绍 </span> </a> </li> <li class=md-nav__item> <a href=#cmake_2 class=md-nav__link> <span class=md-ellipsis> CMake从构建到可执行程序 </span> </a> </li> <li class=md-nav__item> <a href=#cmake_3 class=md-nav__link> <span class=md-ellipsis> CMake从构建到打包基本流程 </span> </a> <nav class=md-nav aria-label=CMake从构建到打包基本流程> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 基本介绍与配置准备 </span> </a> </li> <li class=md-nav__item> <a href=#ctest class=md-nav__link> <span class=md-ellipsis> 使用CTest单元测试 </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 使用安装命令进行程序安装 </span> </a> </li> <li class=md-nav__item> <a href=#cpack class=md-nav__link> <span class=md-ellipsis> 使用CPack进行打包 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 脚本模式 </span> </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 调用外部命令 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 配置命令详细介绍 </span> </a> <nav class=md-nav aria-label=配置命令详细介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 最低安装版本命令 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 项目命令 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 安装命令 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 包含命令 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 添加可执行程序命令 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <!-- 添加mermaid支持 --> <script defer src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script defer src=/javascripts/waline.min.js></script> <p><link rel=stylesheet href=https://help-site.oss-cn-hangzhou.aliyuncs.com/css/waline.css> <link rel=stylesheet href=/stylesheets/waline.min.css></p> <h1 id=cmake>CMake控制台命令核心操作<a class=headerlink href=#cmake title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 4673 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M360.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m64.6 136.1c-12.5 12.5-12.5 32.8 0 45.3l73.4 73.4-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3l-96-96c-12.5-12.5-32.8-12.5-45.3 0zm-274.7 0c-12.5-12.5-32.8-12.5-45.3 0l-96 96c-12.5 12.5-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l73.3-73.4c12.5-12.5 12.5-32.8 0-45.3z"/></svg></span> 133 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 1 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 17 分钟</p> </div> <div class="admonition abstract"> <p class=admonition-title>Abstract</p> <p>本次演示均在Ubuntu系统环境下进行</p> </div> <h2 id=ubuntucmake>Ubuntu下安装CMake<a class=headerlink href=#ubuntucmake title="Permanent link">&para;</a></h2> <p>在Ubuntu中，输入以下命令安装CMake：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>cmake
</span></code></pre></div></td></tr></table></div> <p>安装完成后可以使用下面的命令验证CMake是否安装成功：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1>cmake<span class=w> </span>--version
</span></code></pre></div></td></tr></table></div> <p>如果安装成功，会提示类似下面的版本信息：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1>cmake version 3.28.3
</span><span id=__span-2-2>
</span><span id=__span-2-3>CMake suite maintained and supported by Kitware (kitware.com/cmake).
</span></code></pre></div></td></tr></table></div> <h2 id=cmake_1>CMake介绍<a class=headerlink href=#cmake_1 title="Permanent link">&para;</a></h2> <p>CMake（Cross-platform Make）是一个开源的构建系统，由Kitware公司开发和维护。它不直接构建程序，而是生成标准的构建文件（如Makefile、Visual Studio项目文件等），然后使用平台原生的构建工具进行实际的编译和链接</p> <h2 id=cmake_2>CMake从构建到可执行程序<a class=headerlink href=#cmake_2 title="Permanent link">&para;</a></h2> <p>创建一个<code>hello_world</code>目录，在该目录中编写<code>main.cpp</code>和<code>CMakeLists.txt</code>，目录结构如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1>.
</span><span id=__span-3-2>├── CMakeLists.txt
</span><span id=__span-3-3>└── main.cpp
</span></code></pre></div></td></tr></table></div> <p>在CMake中，<code>CMakeLists.txt</code>是一个项目中的配置文件，由程序员手动编写，是使用CMake进行构建时需要查找的文件，所以在使用构建命令时，命令执行的目录或者手动指定的目录中一定要有<code>CMakeLists.txt</code>文件</p> <p>在<code>main.cpp</code>中编写打印<code>hello world</code>的语句，在<code>CMakeLists.txt</code>中编写下面的内容：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=c># 设置最低要求版本</span>
</span><span id=__span-4-2><span class=nb>cmake_minimum_required</span><span class=p>(</span><span class=s>VERSION</span><span class=w> </span><span class=s>3.18</span><span class=p>)</span>
</span><span id=__span-4-3>
</span><span id=__span-4-4><span class=c># 设置项目名称</span>
</span><span id=__span-4-5><span class=nb>project</span><span class=p>(</span><span class=s>hello_world</span><span class=p>)</span>
</span><span id=__span-4-6>
</span><span id=__span-4-7><span class=c># 添加构建目标</span>
</span><span id=__span-4-8><span class=nb>add_executable</span><span class=p>(</span><span class=s>main</span><span class=w> </span><span class=s>main.cpp</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>基于<code>CMakeLists.txt</code>的内容，下面做简单的介绍：</p> <ol> <li>设置最低要求版本：这个版本的设置可以通过<code>cmake_minimum_required</code>进行，<code>VERSION</code>关键字不能遗漏，<code>3.18</code>表示版本号，本次项目中会使用3.18版本的部分新特性，所以使用该版本。之所以要设置最低版本，是因为CMake是一个不断迭代的工具（目前最新4.x，历史有3.x），不同版本可能会引入新的语法、命令、模块或行为变更。如果项目中使用了高版本CMake才支特的特性（例如特定的函数、生成器表达式、目标属性等），而用户本地安装的CMake版本低于项目要求的版本，就会出现报错并提示最低要求的CMake版本，否则正常执行后续流程</li> <li>设置项目名称：这个项目名称通过<code>project</code>进行，其中的<code>hello_world</code>就是项目名称，可以自行决定</li> <li>添加构建目标：在CMake中，“目标（Target）”代表了一个需要被生成的实体，如可执行文件、静态库/动态库等，和<code>Makefile</code>里的目标是一个意思，他是现在CMake里最核心的3个概念之一</li> </ol> <p>接着，在<code>hello_world</code>目录所在的路径下执行CMake的构建命令生成<code>Makefile</code>，这一步有两种构建方式：</p> <ol> <li>源文件所在目录原地构建（源内构建）：直接在源文件所在目录下执行CMake构建命令</li> <li>源文件所在目录外地构建（源外构建）：单独创建一个构建目录，在该构建目录中执行CMake构建命令</li> </ol> <p>CMake构建命令有三种写法，根据官方文档的提示如下：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1>cmake<span class=w> </span><span class=o>[</span>options<span class=o>]</span><span class=w> </span>&lt;path-to-source&gt;
</span><span id=__span-5-2>cmake<span class=w> </span><span class=o>[</span>options<span class=o>]</span><span class=w> </span>&lt;path-to-existing-build&gt;
</span><span id=__span-5-3>cmake<span class=w> </span><span class=o>[</span>options<span class=o>]</span><span class=w> </span>-S<span class=w> </span>&lt;path-to-source&gt;<span class=w> </span>-B<span class=w> </span>&lt;path-to-build&gt;
</span></code></pre></div></td></tr></table></div> <p>第一种方式和第二种方式都属于源内构建，二者不同的是，第一种方式是基于<code>CMakeLists.txt</code>文件进行构建，第二种方式是基于<code>CMakeCache.txt</code>文件进行构建</p> <p>第三种方式属于源外构建，其中<code>-S</code>后面指定<code>CMakeLists.txt</code>文件所在的目录，<code>-B</code>表示自动生成文件所在的目录</p> <details class=note> <summary>关于<code>CMakeCache.txt</code></summary> <p><code>CMakeCache.txt</code>是使用CMake构建命令生成的临时缓存配置文件，其中包含了一写配置结果和变量缓存，一般不会去手动修改，基于<code>CMakeCache.txt</code>进行构建就是利用缓存的配置结果，跳过重复检测</p> </details> <p>下面是两种构建方式演示：</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>源内构建</label><label for=__tabbed_1_2>源外构建</label></div> <div class=tabbed-content> <div class=tabbed-block> <p>执行命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=c1># 当前目录./中存在CMakeLists.txt文件</span>
</span><span id=__span-6-2>cmake<span class=w> </span>./
</span></code></pre></div></td></tr></table></div> <p>结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1>.
</span><span id=__span-7-2>├── CMakeCache.txt
</span><span id=__span-7-3>├── CMakeFiles/*
</span><span id=__span-7-4>├── cmake_install.cmake
</span><span id=__span-7-5>├── CMakeLists.txt
</span><span id=__span-7-6>├── main.cpp
</span><span id=__span-7-7>└── Makefile
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <p>在当前目录下创建一个<code>build</code>目录，当前目录结构如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1>.
</span><span id=__span-8-2>├── build
</span><span id=__span-8-3>├── CMakeLists.txt
</span><span id=__span-8-4>└── main.cpp
</span></code></pre></div></td></tr></table></div> <p>接着，执行下面的命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=c1># 当前目录下存在CMakeLists.txt，生成的文件放置在当前目录下的build目录</span>
</span><span id=__span-9-2>cmake<span class=w> </span>-S<span class=w> </span>./<span class=w> </span>-B<span class=w> </span>./build
</span></code></pre></div></td></tr></table></div> <p>结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1>.
</span><span id=__span-10-2>├── build/*
</span><span id=__span-10-3>├── CMakeLists.txt
</span><span id=__span-10-4>└── main.cpp
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>可以看到源外构建生成的目录不会影响到源文件所在的目录，这样可以保证源文件目录的整洁，所以官方<strong>推荐源外构建</strong></p> <p>不论是哪种构建方式，最后都会基于<code>CMakeLists.txt</code>生成一个<code>Makefile</code>文件，在<code>Makefile</code>文件所在目录下执行<code>make</code>命令即可获得编译后的可执行程序，接下来运行可执行程序即可看到执行结果。可以得出CMake从构建到获得执行程序的整个流程如下：</p> <p><a class=glightbox href=./cmake-basic.assets/download.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=./cmake-basic.assets/download.png style="width: 70%"></a></p> <p>在<code>CMakeCache.txt</code>所在的目录也可以使用下面的命令生成可执行程序：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1>cmake<span class=w> </span>--build<span class=w> </span>.
</span></code></pre></div></td></tr></table></div> <p>在<code>CMakeCache.txt</code>中存在一行：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1><span class=err>CMAKE_MAKE_PROGRAM:FILEPATH=/usr/bin/gmake</span>
</span></code></pre></div></td></tr></table></div> <p>这一行就是执行<code>cmake --build</code>命令实际执行的程序，而<code>/usr/bin/gmake</code>实际上是一个软链接，指向的正是<code>make</code>：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1>lrwxrwxrwx<span class=w> </span><span class=m>1</span><span class=w> </span>root<span class=w> </span>root<span class=w> </span><span class=m>4</span><span class=w>  </span>4月<span class=w>  </span><span class=m>9</span><span class=w>  </span><span class=m>2024</span><span class=w> </span>/usr/bin/gmake<span class=w> </span>-&gt;<span class=w> </span>make*
</span></code></pre></div></td></tr></table></div> <h2 id=cmake_3>CMake从构建到打包基本流程<a class=headerlink href=#cmake_3 title="Permanent link">&para;</a></h2> <h3 id=_1>基本介绍与配置准备<a class=headerlink href=#_1 title="Permanent link">&para;</a></h3> <p>使用CMake构建一个工程基本流程如下：</p> <pre class=mermaid><code>sequenceDiagram
    participant IDE as IDE
    participant Dev as 开发工程师
    participant CMake1 as CMake(配置)
    participant CMake2 as CMake(生成)
    participant Make as make
    participant CTest as CTest
    participant Install as Install
    participant CPack as CPack

    IDE-&gt;&gt;Dev: 编写工程代码
    Dev-&gt;&gt;CMake1: CMakeLists.txt + Code

    Note over CMake1: 配置阶段
    CMake1-&gt;&gt;CMake1: 配置检测
    CMake1-&gt;&gt;CMake1: 自动检测
    CMake1-&gt;&gt;CMake1: 查找依赖

    Note over CMake2: 生成阶段
    CMake1-&gt;&gt;CMake2: 配置完成
    CMake2-&gt;&gt;Make: Makefile

    Note over Make: 编译链接阶段
    Make-&gt;&gt;Make: 编译链接
    Make-&gt;&gt;CTest: exe so

    Note over CTest: 测试阶段
    CTest-&gt;&gt;CTest: 测试
    CTest-&gt;&gt;Install: 测试结果

    Note over Install: 安装阶段
    Install-&gt;&gt;Install: 安装软件
    Install-&gt;&gt;CPack: exe so

    Note over CPack: 打包阶段
    CPack-&gt;&gt;CPack: 打包
    CPack-&gt;&gt;CPack: 网络分发/startup</code></pre> <p>根据上面的过程，创建一个目录<code>cmake_tools</code>，在该目录下创建<code>main.cpp</code>和<code>CMakeLists.txt</code>文件，两个文件的内容分别如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=2:2><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><input id=__tabbed_2_2 name=__tabbed_2 type=radio><div class=tabbed-labels><label for=__tabbed_2_1><code>main.cpp</code></label><label for=__tabbed_2_2><code>CMakeLists.txt</code></label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-14-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cassert&gt;</span>
</span><span id=__span-14-3>
</span><span id=__span-14-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-14-5><span class=p>{</span>
</span><span id=__span-14-6><span class=w>    </span><span class=n>assert</span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>3</span><span class=p>);</span>
</span><span id=__span-14-7><span class=w>    </span><span class=c1>// assert(1 + 2 == 4);</span>
</span><span id=__span-14-8><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;测试通过&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-14-9>
</span><span id=__span-14-10><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-14-11><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=nb>cmake_minimum_required</span><span class=p>(</span><span class=s>VERSION</span><span class=w> </span><span class=s>3.18</span><span class=p>)</span>
</span><span id=__span-15-2><span class=nb>project</span><span class=p>(</span><span class=s>cmake_tools</span><span class=p>)</span>
</span><span id=__span-15-3><span class=nb>add_executable</span><span class=p>(</span><span class=s>main</span><span class=w> </span><span class=s>main.cpp</span><span class=p>)</span>
</span><span id=__span-15-4>
</span><span id=__span-15-5><span class=c># 集成单元测试</span>
</span><span id=__span-15-6><span class=nb>include</span><span class=p>(</span><span class=s>CTest</span><span class=p>)</span>
</span><span id=__span-15-7><span class=nb>add_test</span><span class=p>(</span><span class=s>NAME</span><span class=w> </span><span class=s>test_add</span><span class=w> </span><span class=s>COMMAND</span><span class=w> </span><span class=s>main</span><span class=p>)</span>
</span><span id=__span-15-8>
</span><span id=__span-15-9><span class=c># 本地安装</span>
</span><span id=__span-15-10><span class=nb>include</span><span class=p>(</span><span class=s>GNUInstallDirs</span><span class=p>)</span><span class=w> </span><span class=c># GNU标准安装路径</span>
</span><span id=__span-15-11><span class=nb>install</span><span class=p>(</span><span class=s>TARGETS</span><span class=w> </span><span class=s>main</span><span class=p>)</span><span class=w> </span><span class=c># 将main程序安装到GNU标准安装路径</span>
</span><span id=__span-15-12>
</span><span id=__span-15-13><span class=c># 打包</span>
</span><span id=__span-15-14><span class=nb>include</span><span class=p>(</span><span class=s>CPack</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>在<code>CMakeLists.txt</code>中，除了前一节提到的三个配置以外，新增了三个配置，分别表示：</p> <ol> <li>使用CMake官方提供的单元测试工具CTest，使用<code>include</code>引入CTest，使用<code>add_test</code>指定测试名称和测试的命令，本次将<code>main.cpp</code>作为测试程序，所以使用<code>main.cpp</code>生成的可执行程序作为测试程序</li> <li>将程序安装到指定目录，安装使用<code>install</code>，其中<code>main</code>表示待安装的程序，而为了统一安装路径，一般用CMake标准路径，即<code>GNUInstallDirs</code>，使用<code>include</code>引入该路径配置。在Linux下，该路径默认为<code>/usr/local/bin</code></li> <li>使用CMake官方提供的打包工具CPack，使用<code>include</code>引入CPack</li> </ol> <p>使用源外构建在当前目录中的<code>build</code>中生成文件</p> <h3 id=ctest>使用CTest单元测试<a class=headerlink href=#ctest title="Permanent link">&para;</a></h3> <p>在<code>build</code>目录所在的路径下执行下面的命令进行单元测试：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1>ctest
</span></code></pre></div></td></tr></table></div> <p>执行结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1>Test project /home/epsda/CmakeLearning_code/cmake_tools/build
</span><span id=__span-17-2>    Start 1: test_add
</span><span id=__span-17-3>1/1 Test #1: test_add .........................   Passed    0.00 sec
</span><span id=__span-17-4>
</span><span id=__span-17-5>100% tests passed, 0 tests failed out of 1
</span><span id=__span-17-6>
</span><span id=__span-17-7>Total Test time (real) =   0.01 sec
</span></code></pre></div></td></tr></table></div> <p>在输出结果中，<code>Start 1: test_add</code>和<code>Test #1: test_add</code>中的<code>test_add</code>都是在<code>CMakeLists.txt</code>文件中<code>add_test</code>的<code>NAME</code>值。同时，测试会在<code>build</code>目录中生成<code>Testing</code>目录，其中<code>LastTest.log</code>文件记录着最近的测试日志</p> <p>如果取消注释<code>assert(1 + 2 == 4);</code>并重新构建项目运行测试可以看到下面的结果：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1>Test project /home/epsda/CmakeLearning_code/cmake_tools/build
</span><span id=__span-18-2>    Start 1: test_add
</span><span id=__span-18-3>1/1 Test #1: test_add .........................Subprocess aborted***Exception:   1.15 sec
</span><span id=__span-18-4>
</span><span id=__span-18-5>0% tests passed, 1 tests failed out of 1
</span><span id=__span-18-6>
</span><span id=__span-18-7>Total Test time (real) =   1.15 sec
</span><span id=__span-18-8>
</span><span id=__span-18-9>The following tests FAILED:
</span><span id=__span-18-10>          1 - test_add (Subprocess aborted)
</span><span id=__span-18-11>Errors while running CTest
</span><span id=__span-18-12>Output from these tests are in: /home/epsda/CmakeLearning_code/cmake_tools/build/Testing/Temporary/LastTest.log
</span></code></pre></div></td></tr></table></div> <p>对应的可以在<code>LastTest.log</code>看到测试错误的日志，<strong>注意这个日志是覆盖写，即每一次执行测试都会清空上一次的日志</strong></p> <p>除了执行上面的命令可以进行单元测试以外，还可以使用下面的命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-19-1>make<span class=w> </span><span class=nb>test</span>
</span></code></pre></div></td></tr></table></div> <p>执行结果与直接执行<code>ctest</code>结果一样，实际上这一点是因为在<code>Makefile</code>中关于<code>test</code>的伪目标对应的依赖关系使用的就是<code>ctest</code>：</p> <div class="language-makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-20-1><span class=nf>test</span><span class=o>:</span>
</span><span id=__span-20-2><span class=w>    </span>@<span class=k>$(</span>CMAKE_COMMAND<span class=k>)</span><span class=w> </span>-E<span class=w> </span>cmake_echo_color<span class=w> </span><span class=s2>&quot;--switch=</span><span class=k>$(</span>COLOR<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span>--cyan<span class=w> </span><span class=s2>&quot;Running tests...&quot;</span>
</span><span id=__span-20-3><span class=w>    </span>/usr/bin/ctest<span class=w> </span>--force-new-ctest-process<span class=w> </span><span class=k>$(</span>ARGS<span class=k>)</span>
</span><span id=__span-20-4><span class=nf>.PHONY </span><span class=o>:</span><span class=w> </span><span class=n>test</span>
</span></code></pre></div></td></tr></table></div> <p>之所以可以通过<code>ctest</code>找到测试程序，原因就在于生成的<code>CTestTestfile.cmake</code>文件中的定义：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-21-1><span class=nb>add_test</span><span class=p>(</span><span class=s>test_add</span><span class=w> </span><span class=s2>&quot;/home/epsda/CmakeLearning_code/cmake_tools/build/main&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>一旦运行<code>ctest</code>，就会通过这一行去查找可执行程序并执行</p> <h3 id=_2>使用安装命令进行程序安装<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p>安装当前临时构建目录<code>build</code>中的可执行程序到指定的目录中，可以在<code>build</code>目录所在路径使用下面的命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-22-1>cmake<span class=w> </span>--install<span class=w> </span>.
</span><span id=__span-22-2><span class=c1># 也可以使用make install，效果一致</span>
</span></code></pre></div></td></tr></table></div> <p>但是，如果是普通用户直接执行该命令会出现权限不足的问题，这是因为<code>GNUInstallDirs</code>中对于Linux来说默认配置的路径是<code>/usr/local/bin</code>，这个目录只有<code>root</code>可以直接进入，所以普通用户需要加<code>sudo</code>：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-23-1>sudo<span class=w> </span>cmake<span class=w> </span>--install<span class=w> </span>.
</span><span id=__span-23-2><span class=c1># 也可以使用sudo make install，效果一致</span>
</span></code></pre></div></td></tr></table></div> <p>输出的结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-24-1>-- Install configuration: &quot;&quot;
</span><span id=__span-24-2>-- Installing: /usr/local/bin/main
</span></code></pre></div></td></tr></table></div> <p>那么为什么执行<code>sudo make install</code>会得到同样的效果呢？实际上也是因为<code>Makefile</code>中关于<code>install</code>伪目标的依赖关系：</p> <div class="language-makefile highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Makefile</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-25-1><span class=nf>install</span><span class=o>:</span><span class=w> </span><span class=n>preinstall</span>
</span><span id=__span-25-2><span class=w>    </span>@<span class=k>$(</span>CMAKE_COMMAND<span class=k>)</span><span class=w> </span>-E<span class=w> </span>cmake_echo_color<span class=w> </span><span class=s2>&quot;--switch=</span><span class=k>$(</span>COLOR<span class=k>)</span><span class=s2>&quot;</span><span class=w> </span>--cyan<span class=w> </span><span class=s2>&quot;Install the project...&quot;</span>
</span><span id=__span-25-3><span class=w>    </span>/usr/bin/cmake<span class=w> </span>-P<span class=w> </span>cmake_install.cmake
</span><span id=__span-25-4><span class=nf>.PHONY </span><span class=o>:</span><span class=w> </span><span class=n>install</span>
</span></code></pre></div></td></tr></table></div> <p>在CMake中，执行<code>cmake --install &lt;dir&gt;</code>命令时实际上执行的是脚本命令，而<code>-P</code>选项就表示执行指定的脚本，<code>cmake_install.cmake</code>就是安装时执行的脚本</p> <p>执行安装命令后可以看到当前项目会生成一个<code>install_manifest.txt</code>的文件，其中的内容就是安装的程序清单：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-26-1>/usr/local/bin/main
</span></code></pre></div></td></tr></table></div> <h3 id=cpack>使用CPack进行打包<a class=headerlink href=#cpack title="Permanent link">&para;</a></h3> <p>要进行安装可以在<code>build</code>目录中执行下面的命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-27-1>cpack
</span></code></pre></div></td></tr></table></div> <p>执行结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-28-1>CPack: Create package using STGZ
</span><span id=__span-28-2>CPack: Install projects
</span><span id=__span-28-3>CPack: - Run preinstall target for: cmake_tools
</span><span id=__span-28-4>CPack: - Install project: cmake_tools []
</span><span id=__span-28-5>CPack: Create package
</span><span id=__span-28-6>CPack: - package: /home/epsda/CmakeLearning_code/cmake_tools/build/cmake_tools-0.1.1-Linux.sh generated.
</span><span id=__span-28-7>CPack: Create package using TGZ
</span><span id=__span-28-8>CPack: Install projects
</span><span id=__span-28-9>CPack: - Run preinstall target for: cmake_tools
</span><span id=__span-28-10>CPack: - Install project: cmake_tools []
</span><span id=__span-28-11>CPack: Create package
</span><span id=__span-28-12>CPack: - package: /home/epsda/CmakeLearning_code/cmake_tools/build/cmake_tools-0.1.1-Linux.tar.gz generated.
</span><span id=__span-28-13>CPack: Create package using TZ
</span><span id=__span-28-14>CPack: Install projects
</span><span id=__span-28-15>CPack: - Run preinstall target for: cmake_tools
</span><span id=__span-28-16>CPack: - Install project: cmake_tools []
</span><span id=__span-28-17>CPack: Create package
</span><span id=__span-28-18>CPack: - package: /home/epsda/CmakeLearning_code/cmake_tools/build/cmake_tools-0.1.1-Linux.tar.Z generated.
</span></code></pre></div></td></tr></table></div> <p>在当前的构建目录下就会多出四个文件：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-29-1>cmake_tools-0.1.1-Linux.sh
</span><span id=__span-29-2>cmake_tools-0.1.1-Linux.tar.gz
</span><span id=__span-29-3>cmake_tools-0.1.1-Linux.tar.Z
</span><span id=__span-29-4>install_manifest.txt
</span></code></pre></div></td></tr></table></div> <p>同时还会多出一个临时安装目录：<code>_CPack_Packages</code></p> <p>其中，<code>.tar.gz</code>和<code>tar.z</code>文件就是两个用于分发的压缩包，而<code>install_manifest.txt</code>表示安装的程序</p> <p>而压缩包的命名和压缩包的格式在<code>CPackConfig.cmake</code>文件中可以看到定义：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-30-1><span class=c># 生成的压缩包后缀</span>
</span><span id=__span-30-2><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_GENERATOR</span><span class=w> </span><span class=s2>&quot;STGZ;TGZ;TZ&quot;</span><span class=p>)</span>
</span><span id=__span-30-3><span class=c># 压缩包文件名称</span>
</span><span id=__span-30-4><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_FILE_NAME</span><span class=w> </span><span class=s2>&quot;cmake_tools-0.1.1-Linux&quot;</span><span class=p>)</span>
</span><span id=__span-30-5>
</span><span id=__span-30-6><span class=c># 包文件名称</span>
</span><span id=__span-30-7><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_NAME</span><span class=w> </span><span class=s2>&quot;cmake_tools&quot;</span><span class=p>)</span>
</span><span id=__span-30-8><span class=c># 版本组合</span>
</span><span id=__span-30-9><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_VERSION</span><span class=w> </span><span class=s2>&quot;0.1.1&quot;</span><span class=p>)</span>
</span><span id=__span-30-10><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_VERSION_MAJOR</span><span class=w> </span><span class=s2>&quot;0&quot;</span><span class=p>)</span>
</span><span id=__span-30-11><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_VERSION_MINOR</span><span class=w> </span><span class=s2>&quot;1&quot;</span><span class=p>)</span>
</span><span id=__span-30-12><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_PACKAGE_VERSION_PATCH</span><span class=w> </span><span class=s2>&quot;1&quot;</span><span class=p>)</span>
</span><span id=__span-30-13><span class=c># 系统名称</span>
</span><span id=__span-30-14><span class=nb>set</span><span class=p>(</span><span class=s>CPACK_SYSTEM_NAME</span><span class=w> </span><span class=s2>&quot;Linux&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>需要注意的是，如果在<code>CMakeLists.txt</code>中正确配置了<code>install</code>指令，那么CPack可以独立工作，无需手动执行<code>cmake --install &lt;dir&gt;</code>命令。如果是先手动执行<code>cmake --install &lt;dir&gt;</code>命令，再执行<code>cpack</code>，此时会出现权限不足问题：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-31-1>CPack: Create package using STGZ
</span><span id=__span-31-2>CPack: Install projects
</span><span id=__span-31-3>CPack: - Run preinstall target for: cmake_tools
</span><span id=__span-31-4>CPack: - Install project: cmake_tools []
</span><span id=__span-31-5>CMake Error at /home/epsda/CmakeLearning_code/cmake_tools/build/cmake_install.cmake:69 (file):
</span><span id=__span-31-6>  file failed to open for writing (Permission denied):
</span><span id=__span-31-7>
</span><span id=__span-31-8>    /home/epsda/CmakeLearning_code/cmake_tools/build/install_manifest.txt
</span><span id=__span-31-9>
</span><span id=__span-31-10>
</span><span id=__span-31-11>CPack Error: Error when generating package: cmake_tools
</span></code></pre></div></td></tr></table></div> <p>因为执行安装命令时会生成<code>install_manifest.txt</code>文件，这个文件此时是由<code>root</code>生成的，所以只有<code>root</code>用户可以访问，而执行<code>cpack</code>时也需要打开并覆写<code>install_manifest.txt</code>文件，直接执行<code>cpack</code>时除非是<code>root</code>用户，否则就会报错。对于普通用户解决方案就是使用<code>sudo</code>执行<code>cpack</code></p> <h3 id=_3>脚本模式<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>使用下面的代码即可执行脚本：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-32-1>cmake<span class=w> </span>-P<span class=w> </span>脚本文件
</span></code></pre></div></td></tr></table></div> <p>CMake脚本模式，不会生成构建产物，也不会生成中间过程。适合处理各种与构建系统无关的自动化任务，通过编写简洁的脚本文件，你可以实现环境检查、文件处理、部署打包等功能</p> <p>例如前面提到的安装过程就使用到了脚本模式</p> <h3 id=_4>调用外部命令<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <p>使用下面的代码即可调用外部命令：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-33-1>cmake<span class=w> </span>-E<span class=w> </span>命令
</span></code></pre></div></td></tr></table></div> <details> <summary>可以调用的外部命令</summary> <table> <thead> <tr> <th>命令</th> <th>功能描述</th> </tr> </thead> <tbody> <tr> <td><code>capabilities</code></td> <td>以JSON格式报告CMake内置的功能</td> </tr> <tr> <td><code>cat [--] &lt;files&gt;...</code></td> <td>连接文件并将其打印到标准输出</td> </tr> <tr> <td><code>chdir dir cmd [args...]</code></td> <td>在指定目录中运行命令</td> </tr> <tr> <td><code>compare_files [--ignore-eol] file1 file2</code></td> <td>检查<code>file1</code>是否与<code>file2</code>相同</td> </tr> <tr> <td><code>copy &lt;file&gt;... destination</code></td> <td>将文件复制到目标位置(文件或目录)</td> </tr> <tr> <td><code>copy_directory &lt;dir&gt;... destination</code></td> <td>将目录内容复制到目标目录</td> </tr> <tr> <td><code>copy_directory_if_different &lt;dir&gt;... destination</code></td> <td>将已更改的目录内容复制到目标目录</td> </tr> <tr> <td><code>copy_if_different &lt;file&gt;... destination</code></td> <td>如果文件已更改则复制文件</td> </tr> <tr> <td><code>echo [&lt;string&gt;...]</code></td> <td>将参数显示为文本</td> </tr> <tr> <td><code>echo_append [&lt;string&gt;...]</code></td> <td>将参数显示为文本但不换行</td> </tr> <tr> <td><code>env [--unset=NAME ...] [NAME=VALUE ...] [--] &lt;command&gt; [&lt;arg&gt;...]</code></td> <td>在修改的环境中运行命令</td> </tr> <tr> <td><code>environment</code></td> <td>显示当前环境</td> </tr> <tr> <td><code>make_directory &lt;dir&gt;...</code></td> <td>创建父目录和指定目录</td> </tr> <tr> <td><code>md5sum &lt;file&gt;...</code></td> <td>创建文件的MD5校验和</td> </tr> <tr> <td><code>sha1sum &lt;file&gt;...</code></td> <td>创建文件的SHA1校验和</td> </tr> <tr> <td><code>sha224sum &lt;file&gt;...</code></td> <td>创建文件的SHA224校验和</td> </tr> <tr> <td><code>sha256sum &lt;file&gt;...</code></td> <td>创建文件的SHA256校验和</td> </tr> <tr> <td><code>sha384sum &lt;file&gt;...</code></td> <td>创建文件的SHA384校验和</td> </tr> <tr> <td><code>sha512sum &lt;file&gt;...</code></td> <td>创建文件的SHA512校验和</td> </tr> <tr> <td><code>remove [-f] &lt;file&gt;...</code></td> <td>删除文件，使用<code>-f</code>强制删除(已弃用：请使用<code>rm</code>)</td> </tr> <tr> <td><code>remove_directory &lt;dir&gt;...</code></td> <td>删除目录及其内容(已弃用：请使用<code>rm</code>)</td> </tr> <tr> <td><code>rename oldname newname</code></td> <td>重命名文件或目录(在同一卷上)</td> </tr> <tr> <td><code>rm [-rRf] [--] &lt;file/dir&gt;...</code></td> <td>删除文件或目录，使用<code>-f</code>强制删除，<code>r</code>或<code>R</code>递归删除目录及其内容</td> </tr> <tr> <td><code>sleep &lt;number&gt;...</code></td> <td>休眠指定秒数</td> </tr> <tr> <td><code>tar [cxt][vf][zjJ] file.tar [file/dir1 file/dir2 ...]</code></td> <td>创建或提取<code>tar</code>或<code>zip</code>归档文件</td> </tr> <tr> <td><code>time command [args...]</code></td> <td>运行命令并显示耗时</td> </tr> <tr> <td><code>touch &lt;file&gt;...</code></td> <td>创建或更新文件时间戳</td> </tr> <tr> <td><code>touch_nocreate &lt;file&gt;...</code></td> <td>更新文件时间戳但不创建文件</td> </tr> <tr> <td><code>create_symlink old new</code></td> <td>创建符号链接<code>new</code>-&gt;<code>old</code></td> </tr> <tr> <td><code>create_hardlink old new</code></td> <td>创建硬链接<code>new</code>-&gt;<code>old</code></td> </tr> <tr> <td><code>true</code></td> <td>什么都不做，退出代码为0</td> </tr> <tr> <td><code>false</code></td> <td>什么都不做，退出代码为1</td> </tr> </tbody> </table> </details> <h2 id=_5>配置命令详细介绍<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <h3 id=_6>最低安装版本命令<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <p>在前面已经提到可以使用<code>cmake_minimum_required</code>配置最低要求版本以及需要配置的原因，本次对该命令进行进一步的补充。除了可以指定最低版本以外，还可以指定版本范围，写法如下：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-34-1><span class=nb>cmake_minimum_required</span><span class=p>(</span><span class=s>VERSION</span><span class=w> </span><span class=s>3.18...4.0</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>需要注意的是，<code>cmake_minimum_required</code>的配置必须在顶级<code>CMakeLists.txt</code>中的最开始位置，甚至要在<code>project</code>配置之前调用</p> <details> <summary>何为顶级<code>CMakeLists.txt</code></summary> <p>在CMake中，允许一个项目中有多个<code>CMakeLists.txt</code>，但是分布在不同的目录中，项目根目录中的<code>CMakeLists.txt</code>一般为顶级<code>CMakeLists.txt</code>。顶级<code>CMakeLists.txt</code>是CMake构建系统的起始位置，定义了整个项目的构建规则和配置并且管理项目的目录结构和依赖关系</p> </details> <h3 id=_7>项目命令<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>项目命令即<code>project</code>命令，基本语法介绍如下：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-35-1><span class=nb>project</span><span class=p>(</span><span class=s>&lt;PROJECT-NAME&gt;</span><span class=w> </span><span class=s>[&lt;language-name&gt;...]</span><span class=p>)</span>
</span><span id=__span-35-2><span class=nb>project</span><span class=p>(</span><span class=s>&lt;PROJECT-NAME&gt;</span>
</span><span id=__span-35-3><span class=w>        </span><span class=s>[VERSION</span><span class=w> </span><span class=s>&lt;major&gt;[.&lt;minor&gt;[.&lt;patch&gt;[.&lt;tweak&gt;]]]]</span>
</span><span id=__span-35-4><span class=w>        </span><span class=s>[COMPAT_VERSION</span><span class=w> </span><span class=s>&lt;major&gt;[.&lt;minor&gt;[.&lt;patch&gt;[.&lt;tweak&gt;]]]]</span>
</span><span id=__span-35-5><span class=w>        </span><span class=s>[DESCRIPTION</span><span class=w> </span><span class=s>&lt;project-description-string&gt;]</span>
</span><span id=__span-35-6><span class=w>        </span><span class=s>[HOMEPAGE_URL</span><span class=w> </span><span class=s>&lt;url-string&gt;]</span>
</span><span id=__span-35-7><span class=w>        </span><span class=s>[LANGUAGES</span><span class=w> </span><span class=s>&lt;language-name&gt;...]</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>根据官方介绍，<code>project</code>命令可以有两种写法：</p> <ol> <li>第一种写法（简单写法），项目名称和语言名称，其中语言名称可选</li> <li>第二种写法（完整写法），项目名称、项目版本号、兼容版本号、项目描述、项目主页URL和语言名称，其中除了项目名称以外，其余全部可选</li> </ol> <p>在CMake中，如果执行了<code>project</code>命令，那么默认会设置下面的变量：</p> <table> <thead> <tr> <th>变量</th> <th>描述</th> </tr> </thead> <tbody> <tr> <td><code>PROJECT_NAME</code></td> <td>项目名称（如<code>MyProject</code>）</td> </tr> <tr> <td><code>CMAKE_PROJECT_NAME</code></td> <td>顶级项目名称（与<code>PROJECT_NAME</code>相同）</td> </tr> <tr> <td><code>PROJECT_VERSION</code></td> <td>完整版本号（如<code>1.2.3</code>）</td> </tr> <tr> <td><code>PROJECT_VERSION_MAJOR</code></td> <td>主版本号</td> </tr> <tr> <td><code>PROJECT_VERSION_MINOR</code></td> <td>次版本号</td> </tr> <tr> <td><code>PROJECT_VERSION_PATCH</code></td> <td>修订号</td> </tr> <tr> <td><code>PROJECT_SOURCE_DIR</code></td> <td>顶级<code>CMakeLists.txt</code>所在目录（即源文件树根目录）</td> </tr> <tr> <td><code>PROJECT_BINARY_DIR</code></td> <td>构建目录（如<code>build/</code>）</td> </tr> </tbody> </table> <p>这些变量在后续的其他命令中可以直接通过<code>${}</code>进行引用，例如<code>${PROJECT_NAME}</code></p> <p>需要注意的是语言名称的值，指定时可以指定一门语言，也可以指定多门语言。如果不指定语言，那么默认就是C和C++，如果值为<code>none</code>或者写了<code>LANGUAGES</code>但是没有给值，那么表示不启用任何语言</p> <p>根据官方文档的描述，<code>LANGUAGES</code>可以指定的语言有：C、CXX（即C++）、CSharp（即C#）、CUDA、OBJC（即Objective-C）、OBJCXX（即Objective-C++）、Fortran、HIP、ISPC、Swift、ASM、ASM_NASM、ASM_MARMASM、ASM_MASM和ASM-ATT</p> <p>对于<code>LANGUAGES</code>，推荐的使用方法就是<strong>显式指定项目中所有使用到的语言</strong>，确保CMake可以正确查找编译器</p> <h3 id=_8>安装命令<a class=headerlink href=#_8 title="Permanent link">&para;</a></h3> <p>安装命令的作用可以理解为拷贝，基本用法此处不再赘述。根据官方文档的描述，<code>install</code>命令有如下几种写法：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-36-1><span class=nb>install</span><span class=p>(</span><span class=s>TARGETS</span><span class=w> </span><span class=s>&lt;targets&gt;...</span><span class=w> </span><span class=s>[EXPORT</span><span class=w> </span><span class=s>&lt;export-name&gt;]</span>
</span><span id=__span-36-2><span class=w>        </span><span class=s>[RUNTIME</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;]</span>
</span><span id=__span-36-3><span class=w>        </span><span class=s>[LIBRARY</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;]</span>
</span><span id=__span-36-4><span class=w>        </span><span class=s>[ARCHIVE</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;]</span>
</span><span id=__span-36-5><span class=w>        </span><span class=s>[INCLUDES</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;]</span>
</span><span id=__span-36-6><span class=w>        </span><span class=s>[...]</span><span class=p>)</span>
</span><span id=__span-36-7>
</span><span id=__span-36-8><span class=nb>install</span><span class=p>(</span><span class=s>FILES</span><span class=w> </span><span class=s>&lt;files&gt;...</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;</span>
</span><span id=__span-36-9><span class=w>        </span><span class=s>[PERMISSIONS</span><span class=w> </span><span class=s>&lt;permissions&gt;...]</span>
</span><span id=__span-36-10><span class=w>        </span><span class=s>[CONFIGURATIONS</span><span class=w> </span><span class=s>&lt;configs&gt;...]</span>
</span><span id=__span-36-11><span class=w>        </span><span class=s>[COMPONENT</span><span class=w> </span><span class=s>&lt;component&gt;]</span>
</span><span id=__span-36-12><span class=w>        </span><span class=s>[...]</span><span class=p>)</span>
</span><span id=__span-36-13>
</span><span id=__span-36-14><span class=nb>install</span><span class=p>(</span><span class=s>DIRECTORY</span><span class=w> </span><span class=s>&lt;dirs&gt;...</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;</span>
</span><span id=__span-36-15><span class=w>        </span><span class=s>[FILE_PERMISSIONS</span><span class=w> </span><span class=s>&lt;permissions&gt;...]</span>
</span><span id=__span-36-16><span class=w>        </span><span class=s>[DIRECTORY_PERMISSIONS</span><span class=w> </span><span class=s>&lt;permissions&gt;...]</span>
</span><span id=__span-36-17><span class=w>        </span><span class=s>[...]</span><span class=p>)</span>
</span><span id=__span-36-18>
</span><span id=__span-36-19><span class=nb>install</span><span class=p>(</span><span class=s>EXPORT</span><span class=w> </span><span class=s>&lt;export-name&gt;</span><span class=w> </span><span class=s>DESTINATION</span><span class=w> </span><span class=s>&lt;dir&gt;</span>
</span><span id=__span-36-20><span class=w>        </span><span class=s>[NAMESPACE</span><span class=w> </span><span class=s>&lt;namespace&gt;::]</span>
</span><span id=__span-36-21><span class=w>        </span><span class=s>[FILE</span><span class=w> </span><span class=s>&lt;filename&gt;]</span>
</span><span id=__span-36-22><span class=w>        </span><span class=s>[...]</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>其中的关键参数解释如下表所示：</p> <table> <thead> <tr> <th>参数</th> <th>含义</th> </tr> </thead> <tbody> <tr> <td><code>TARGETS</code></td> <td>安装使用<code>add_executable</code>和<code>add_library</code>构建的目标文件</td> </tr> <tr> <td><code>FILES</code></td> <td>安装文件</td> </tr> <tr> <td><code>DIRECTORY</code></td> <td>安装整个目录</td> </tr> <tr> <td><code>EXPORT</code></td> <td>安装导出目录，用于发布自己的程序，供别人使用</td> </tr> <tr> <td><code>DESTINATION</code></td> <td>指定安装路径，路径可以是绝对路径，也可以是相对路径（相对于<code>CMAKE_INSTALL_PREFIX</code>）</td> </tr> </tbody> </table> <p>在Linux中，<code>CMAKE_INSTALL_PREFIX</code>表示的就是<code>/usr/local</code>，在部分脚本中可以见到该路径，例如在<code>cmake_install.cmake</code>中可以看到该变量的设置：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-37-1><span class=nb>if</span><span class=p>(</span><span class=s>NOT</span><span class=w> </span><span class=s>DEFINED</span><span class=w> </span><span class=s>CMAKE_INSTALL_PREFIX</span><span class=p>)</span>
</span><span id=__span-37-2><span class=w>  </span><span class=nb>set</span><span class=p>(</span><span class=s>CMAKE_INSTALL_PREFIX</span><span class=w> </span><span class=s2>&quot;/usr/local&quot;</span><span class=p>)</span>
</span><span id=__span-37-3><span class=nb>endif</span><span class=p>()</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_9>包含命令<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>包含命令即<code>include</code>，其作用是加载指定的脚本文件或者模块到当前<code>CMakeLists.txt</code>执行上下文中并运行。在官方文档的描述中，该命令的使用如下：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-38-1><span class=nb>include</span><span class=p>(</span><span class=s>&lt;file|module&gt;</span><span class=w> </span><span class=s>[OPTIONAL]</span><span class=w> </span><span class=s>[RESULT_VARIABLE</span><span class=w> </span><span class=s>&lt;var&gt;]</span><span class=w> </span><span class=s>[NO_POLICY_SCOPE]</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>其中<code>&lt;file|module&gt;</code>表示的就是要运行的文件（一般会包含路径）或者模块名称。对于要查找的路径，如果是要运行的文件，<code>include</code>命令查找原则如下：</p> <ol> <li>如果是相对路径，那么相对于当前<code>include</code>命令所在的<code>CMakeLists.txt</code>文件开始查找</li> <li>如果是绝对路径，直接从根路径开始查找</li> </ol> <p>如果是模块，那么查找原则为：首先在当前目录中查找，如果没有再到<code>CMAKE_MODULE_PATH</code>变量指定的目录中查找</p> <p>对于包含到当前<code>CMakeLists.txt</code>的文件来说，会先执行<code>include</code>之前的代码，再在当前<code>CMakeLists.txt</code>中展开指定的文件并执行其中的内容。以下面的目录结构为例：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-39-1>.
</span><span id=__span-39-2>├── build
</span><span id=__span-39-3>├── CMakeLists.txt
</span><span id=__span-39-4>└── sub
</span><span id=__span-39-5>    └── sub.cmake
</span></code></pre></div></td></tr></table></div> <p>其中<code>CMakeLists.txt</code>和<code>sub.cmake</code>脚本的内容分别如下：</p> <div class="tabbed-set tabbed-alternate" data-tabs=3:2><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><input id=__tabbed_3_2 name=__tabbed_3 type=radio><div class=tabbed-labels><label for=__tabbed_3_1><code>CMakeLists.txt</code></label><label for=__tabbed_3_2><code>sub.cmake</code></label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-40-1><span class=nb>cmake_minimum_required</span><span class=p>(</span><span class=s>VERSION</span><span class=w> </span><span class=s>3.18</span><span class=p>)</span>
</span><span id=__span-40-2>
</span><span id=__span-40-3><span class=nb>project</span><span class=p>(</span><span class=s>test_include</span><span class=p>)</span>
</span><span id=__span-40-4>
</span><span id=__span-40-5><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;main cmake&quot;</span><span class=p>)</span>
</span><span id=__span-40-6><span class=c># 打印当前正在执行的源代码目录</span>
</span><span id=__span-40-7><span class=nb>message</span><span class=p>(</span><span class=s>STATUS,</span><span class=w> </span><span class=s2>&quot;当前源代码目录：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_SOURCE_DIR</span><span class=o>}</span><span class=p>)</span>
</span><span id=__span-40-8><span class=c># 打印正在执行的cmake脚本</span>
</span><span id=__span-40-9><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;正在执行的cmake脚本：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_LIST_FILE</span><span class=o>}</span><span class=p>)</span>
</span><span id=__span-40-10><span class=c># 打印正在执行的cmake脚本的全目录</span>
</span><span id=__span-40-11><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;正在执行的cmake脚本的全目录：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_LIST_DIR</span><span class=o>}</span><span class=p>)</span>
</span><span id=__span-40-12>
</span><span id=__span-40-13><span class=c># 包含子目录cmake脚本</span>
</span><span id=__span-40-14><span class=nb>include</span><span class=p>(</span><span class=s>./sub/sub.cmake</span><span class=p>)</span><span class=w> </span>
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-41-1><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;sub cmake&quot;</span><span class=p>)</span>
</span><span id=__span-41-2><span class=c># 打印当前正在执行的源代码目录</span>
</span><span id=__span-41-3><span class=nb>message</span><span class=p>(</span><span class=s>STATUS,</span><span class=w> </span><span class=s2>&quot;当前源代码目录：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_SOURCE_DIR</span><span class=o>}</span><span class=p>)</span>
</span><span id=__span-41-4><span class=c># 打印正在执行的cmake脚本</span>
</span><span id=__span-41-5><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;正在执行的cmake脚本：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_LIST_FILE</span><span class=o>}</span><span class=p>)</span>
</span><span id=__span-41-6><span class=c># 打印正在执行的cmake脚本的全目录</span>
</span><span id=__span-41-7><span class=nb>message</span><span class=p>(</span><span class=s>STATUS</span><span class=w> </span><span class=s2>&quot;正在执行的cmake脚本的全目录：&quot;</span><span class=w> </span><span class=o>${</span><span class=nv>CMAKE_CURRENT_LIST_DIR</span><span class=o>}</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <div class="admonition info"> <p class=admonition-title>Info</p> <p>关于<code>message</code>函数的介绍和使用会在<a href=#>CMake常见语法</a>中介绍</p> </div> <p>在<code>build</code>目录中运行构建命令，可以看到结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-42-1>-- The C compiler identification is GNU 13.3.0
</span><span id=__span-42-2>-- The CXX compiler identification is GNU 13.3.0
</span><span id=__span-42-3>-- Detecting C compiler ABI info
</span><span id=__span-42-4>-- Detecting C compiler ABI info - done
</span><span id=__span-42-5>-- Check for working C compiler: /usr/bin/cc - skipped
</span><span id=__span-42-6>-- Detecting C compile features
</span><span id=__span-42-7>-- Detecting C compile features - done
</span><span id=__span-42-8>-- Detecting CXX compiler ABI info
</span><span id=__span-42-9>-- Detecting CXX compiler ABI info - done
</span><span id=__span-42-10>-- Check for working CXX compiler: /usr/bin/c++ - skipped
</span><span id=__span-42-11>-- Detecting CXX compile features
</span><span id=__span-42-12>-- Detecting CXX compile features - done
</span><span id=__span-42-13>-- main cmake
</span><span id=__span-42-14>STATUS,当前源代码目录：/home/epsda/CmakeLearning_code/test_include
</span><span id=__span-42-15>-- 正在执行的cmake脚本：/home/epsda/CmakeLearning_code/test_include/CMakeLists.txt
</span><span id=__span-42-16>-- 正在执行的cmake脚本的全目录：/home/epsda/CmakeLearning_code/test_include
</span><span id=__span-42-17>-- sub cmake
</span><span id=__span-42-18>STATUS,当前源代码目录：/home/epsda/CmakeLearning_code/test_include
</span><span id=__span-42-19>-- 正在执行的cmake脚本：/home/epsda/CmakeLearning_code/test_include/sub/sub.cmake
</span><span id=__span-42-20>-- 正在执行的cmake脚本的全目录：/home/epsda/CmakeLearning_code/test_include/sub
</span><span id=__span-42-21>-- Configuring done (0.3s)
</span><span id=__span-42-22>-- Generating done (0.0s)
</span><span id=__span-42-23>-- Build files have been written to: /home/epsda/CmakeLearning_code/test_include/build
</span></code></pre></div></td></tr></table></div> <p>可以看到先执行了<code>CMakeLists.txt</code>文件中的打印，再执行<code>sub.cmake</code>中的打印，并且因为<code>sub.cmake</code>中的命令在<code>CMakeLists.txt</code>中展开，所以不论是<code>CMakeLists.txt</code>还是<code>sub.cmake</code>文件中的源代码目录打印均相同且均为<code>test_include</code>项目目录</p> <h3 id=_10>添加可执行程序命令<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>根据官方文档的描述，<code>add_executable</code>命令使用方式如下：</p> <div class="language-cmake highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>CMake</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-43-1><span class=nb>add_executable</span><span class=p>(</span><span class=s>&lt;name&gt;</span><span class=w> </span><span class=s>&lt;options&gt;...</span><span class=w> </span><span class=s>&lt;sources&gt;...</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> <p>其中，<code>name</code>表示生成的目标名称，<code>&lt;sources&gt;</code>表示目标的来源文件。根据官方文档对目标生成的路径描述：<a href=javascript:; class=custom-tooltip data-title="By default the executable file will be created in the build tree directory corresponding to the source tree directory in which the command was invoked">默认情况下，可执行文件会生成在构建目录里，位置和源代码目录的结构是对应的</a></p> <p>例如，假设当前项目根目录为<code>project</code>，项目源代码目录为<code>src</code>，项目构建目录为<code>build</code>，那么根据上面的描述，应该为：编译出来的程序会放在<code>build</code>文件夹里，而且<code>build</code>文件夹中的结构和源代码的文件夹结构是一样的，即：</p> <ul> <li>源文件目录：<code>project/src/</code></li> <li>构建程序目录：<code>project/build/src/</code></li> </ul> <p>简单理解就是<strong>源代码的目录会被拷贝到构建目录中用于存放生成的目标文件</strong></p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2026年1月22日</span> </span> </aside> <!-- Waline 评论系统 --> <div id=waline></div> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2026 柯懒不是柯南 </div> </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M434.1 420.4c-11.5 1.4-44.9-52.7-44.9-52.7 0 31.3-16.1 72.2-51 101.8 16.8 5.2 54.8 19.2 45.8 34.4-7.3 12.3-125.5 7.9-159.6 4-34.1 3.8-152.3 8.3-159.6-4-9-15.2 28.9-29.2 45.8-34.4-34.9-29.5-51.1-70.4-51.1-101.8 0 0-33.3 54.1-44.9 52.7-5.4-.6-12.4-29.6 9.3-99.7 10.3-33 22-60.5 40.1-105.8C60.9 98 109.2-.1 224.3-.1 338-.1 387.5 96 384.6 214.9c18.1 45.2 29.9 72.9 40.1 105.8 21.8 70.1 14.7 99.1 9.3 99.7z"/></svg> </a> <a href=mailto:watneymark82@gmail.com target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M536.4-26.3c9.8-3.5 20.6-1 28 6.3s9.8 18.2 6.3 28l-178 496.9c-5 13.9-18.1 23.1-32.8 23.1-14.2 0-27-8.6-32.3-21.7l-64.2-158c-4.5-11-2.5-23.6 5.2-32.6l94.5-112.4c5.1-6.1 4.7-15-.9-20.6s-14.6-6-20.6-.9l-112.4 94.3c-9.1 7.6-21.6 9.6-32.6 5.2L38.1 216.8c-13.1-5.3-21.7-18.1-21.7-32.3 0-14.7 9.2-27.8 23.1-32.8z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "navigation.sections", "toc.follow", "content.code.copy", "navigation.top"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.e71a0d61.min.js></script> <script src=../../../javascripts/other.min.js></script> <script src=../../../javascripts/copyright.min.js></script> <script src=../../../javascripts/docsearch.min.js></script> <script src=../../../javascripts/navigation-overlay.min.js></script> <script src=https://help-site.oss-cn-hangzhou.aliyuncs.com/js/docsearch3.js></script> <script src=../../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>