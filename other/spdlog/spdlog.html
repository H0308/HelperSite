<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/other/spdlog/spdlog.html><link rel=prev href=../jsoncpp/jsoncpp.html><link rel=next href=../git/git-basic/git-basic.html><link rel=icon href=../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>关于C++日志库spdlog - 柯懒的知识库</title><link rel=stylesheet href=../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../css/timeline.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link rel=preload href=../../assets/stylesheets/main.2afb09e1.min.css as=style><link rel=preload href=../../assets/stylesheets/palette.06af60db.min.css as=style><link rel=preload href=../../stylesheets/docsearch.min.css as=style><link rel=preload href=../../stylesheets/colors.min.css as=style><link rel=preload href=../../stylesheets/theme2.min.css as=style><link rel=preload href=../../author/作者.assets/20250206-200653.jpg as=image><link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css as=style><link rel=dns-prefetch href=//unpkg.com><link rel=dns-prefetch href=//cloud.umami.is><link rel=stylesheet href=../../stylesheets/colors.min.css><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)"><link rel=stylesheet href=../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)"><link rel=stylesheet href=../../stylesheets/print.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3><link rel=stylesheet href=../../stylesheets/docsearch.min.css><script defer src=https://cloud.umami.is/script.js data-website-id=02f9b8b7-93d4-4026-bdd8-221f2fcea2cf></script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cspdlog class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 关于C++日志库spdlog </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <div class=header-avatar> <img src=../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../author/contact/contact.html class=avatar-dropdown-item>联系作者</a> <div class=avatar-dropdown-divider></div> <a href=../../author/about/about.html class=avatar-dropdown-item>关于作者</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>Github仓库</a> </div> </div> <div id=docsearch></div> </nav> </header> <!-- <div class="back-to-top-btn" id="backToTopBtn"  onclick="window.scrollTo({top: 0})">
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"/>
    </svg>
</div> --> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../languages/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../data-structure-algo/index.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class=md-tabs__item> <a href=../../Linux/index.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../front-end/index.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../MySQL/index.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../JavaEE/index.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../software-test/index.html class=md-tabs__link> 软件测试 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../index.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../tooltips/index.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class=md-tabs__item> <a href=../../projects/index.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../languages/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../data-structure-algo/index.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../Linux/index.html class=md-nav__link> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../front-end/index.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../MySQL/index.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../JavaEE/index.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../software-test/index.html class=md-nav__link> <span class=md-ellipsis> 软件测试 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> 扩展知识 </span> </a> <label class="md-nav__link " for=__nav_10 id=__nav_10_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_10_label aria-expanded=true> <label class=md-nav__title for=__nav_10> <span class="md-nav__icon md-icon"></span> 扩展知识 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../shell/shell.html class=md-nav__link> <span class=md-ellipsis> 关于Shell </span> </a> </li> <li class=md-nav__item> <a href=../func-stack-c/func-stack-c.html class=md-nav__link> <span class=md-ellipsis> 关于函数栈帧（C语言演示） </span> </a> </li> <li class=md-nav__item> <a href=../xml/xml.html class=md-nav__link> <span class=md-ellipsis> 关于XML文件 </span> </a> </li> <li class=md-nav__item> <a href=../jsoncpp/jsoncpp.html class=md-nav__link> <span class=md-ellipsis> 关于JSONCPP库 </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 关于C++日志库spdlog </span> <span class="md-nav__icon md-icon"></span> </label> <a href=spdlog.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 关于C++日志库spdlog </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ubuntuspdlog class=md-nav__link> <span class=md-ellipsis> 在Ubuntu下安装和配置spdlog库 </span> </a> </li> <li class=md-nav__item> <a href=#sink class=md-nav__link> <span class=md-ellipsis> 何为sink </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 基本用法 </span> </a> <nav class=md-nav aria-label=基本用法> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 包含头文件 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 创建日志记录器 </span> </a> <nav class=md-nav aria-label=创建日志记录器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 控制台日志 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 文件日志 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 混合日志（控制台 + 文件） </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 日志级别 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 格式化日志 </span> </a> <nav class=md-nav aria-label=格式化日志> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 自定义日志格式 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 详细的日志格式说明 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 基础格式占位符 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 高级格式占位符 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 注意事项 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 异步日志 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 高级特性 </span> </a> <nav class=md-nav aria-label=高级特性> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 日志轮转 </span> </a> <nav class=md-nav aria-label=日志轮转> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 基于文件大小的轮转 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 基于时间的轮转 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sink_1 class=md-nav__link> <span class=md-ellipsis> 自定义Sink </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 日志宏函数 </span> </a> <nav class=md-nav aria-label=日志宏函数> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 基础日志宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 自定义宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 异步日志的宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 其他相关宏 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_7> <label class=md-nav__link for=__nav_10_7 id=__nav_10_7_label tabindex> <span class=md-ellipsis> 关于Git </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_10_7_label aria-expanded=false> <label class=md-nav__title for=__nav_10_7> <span class="md-nav__icon md-icon"></span> 关于Git </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../git/git-basic/git-basic.html class=md-nav__link> <span class=md-ellipsis> Git基础操作 </span> </a> </li> <li class=md-nav__item> <a href=../git/git-collaboration/git-collaboration.html class=md-nav__link> <span class=md-ellipsis> Git多人协作 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../muduo/muduo.html class=md-nav__link> <span class=md-ellipsis> 关于Muduo库 </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_10_9> <label class=md-nav__link for=__nav_10_9 id=__nav_10_9_label tabindex> <span class=md-ellipsis> 关于CMake </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_10_9_label aria-expanded=false> <label class=md-nav__title for=__nav_10_9> <span class="md-nav__icon md-icon"></span> 关于CMake </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../cmake/cmake-basic/cmake-basic.html class=md-nav__link> <span class=md-ellipsis> CMake控制台命令核心操作 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../yaml/yaml.html class=md-nav__link> <span class=md-ellipsis> 关于YAML文件 </span> </a> </li> <li class=md-nav__item> <a href=../json_schema/json_schema.html class=md-nav__link> <span class=md-ellipsis> 关于JSON Schema </span> </a> </li> <li class=md-nav__item> <a href=../regex/regex.html class=md-nav__link> <span class=md-ellipsis> 关于正则表达式 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../tooltips/index.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../projects/index.html class=md-nav__link> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ubuntuspdlog class=md-nav__link> <span class=md-ellipsis> 在Ubuntu下安装和配置spdlog库 </span> </a> </li> <li class=md-nav__item> <a href=#sink class=md-nav__link> <span class=md-ellipsis> 何为sink </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 基本用法 </span> </a> <nav class=md-nav aria-label=基本用法> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 包含头文件 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 创建日志记录器 </span> </a> <nav class=md-nav aria-label=创建日志记录器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 控制台日志 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 文件日志 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 混合日志（控制台 + 文件） </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 日志级别 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 格式化日志 </span> </a> <nav class=md-nav aria-label=格式化日志> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 自定义日志格式 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 详细的日志格式说明 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 基础格式占位符 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 高级格式占位符 </span> </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 注意事项 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 异步日志 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 高级特性 </span> </a> <nav class=md-nav aria-label=高级特性> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 日志轮转 </span> </a> <nav class=md-nav aria-label=日志轮转> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 基于文件大小的轮转 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 基于时间的轮转 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sink_1 class=md-nav__link> <span class=md-ellipsis> 自定义Sink </span> </a> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> <span class=md-ellipsis> 日志宏函数 </span> </a> <nav class=md-nav aria-label=日志宏函数> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_20 class=md-nav__link> <span class=md-ellipsis> 基础日志宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> <span class=md-ellipsis> 自定义宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_22 class=md-nav__link> <span class=md-ellipsis> 异步日志的宏函数 </span> </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> <span class=md-ellipsis> 其他相关宏 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <script defer src=/javascripts/waline.min.js></script> <p><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css> <link rel=stylesheet href=/stylesheets/waline.min.css></p> <h1 id=cspdlog>关于C++日志库spdlog<a class=headerlink href=#cspdlog title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 2965 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 332 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 1 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 14 分钟</p> </div> <p><a href=https://github.com/gabime/spdlog>spdlog</a>是一个高性能、易于使用的C++日志库，广泛应用于现代C++项目中。它支持多线程、异步日志记录、多种日志格式、以及灵活的输出方式（如控制台、文件、甚至自定义输出）。下面将就常用功能方面介绍spdlog的安装、配置和使用方法</p> <h2 id=ubuntuspdlog>在Ubuntu下安装和配置spdlog库<a class=headerlink href=#ubuntuspdlog title="Permanent link">&para;</a></h2> <p>安装spdlog库方式如下：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1>sudo<span class=w> </span>apt<span class=w> </span>install<span class=w> </span>libspdlog-dev
</span></code></pre></div></td></tr></table></div> <p>安装完成后，还不可以直接使用，如果使用的是g++编译器，那么编译时需要写为如下例子：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1>g++<span class=w> </span>-std<span class=o>=</span>c++11<span class=w> </span>-o<span class=w> </span><span class=nb>test</span><span class=w> </span>test.cpp<span class=w> </span>-lspdlog<span class=w> </span>-lfmt<span class=w> </span>-lpthread
</span></code></pre></div></td></tr></table></div> <p>其中<code>fmt</code>是一个格式化库，spdlog使用<code>fmt</code>库来格式化日志消息，如果没有按照会出现链接时报错，Ubuntu下按照方式如下：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>libfmt-dev
</span></code></pre></div></td></tr></table></div> <p>有的Ubuntu系统已经安装了<code>fmt</code>库，使用下面的指令可以查看：</p> <div class="language-bash highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Bash</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1>fmt<span class=w> </span>--version
</span></code></pre></div></td></tr></table></div> <h2 id=sink>何为sink<a class=headerlink href=#sink title="Permanent link">&para;</a></h2> <p>为了后面的理解顺利，首先了解何为sink。在spdlog中，<strong>sink（接收器）</strong> 是一个核心概念，它决定了日志消息最终输出到哪里，每个日志对象可以关联一个或多个sink，其决定了日志的物理存储位置或显示方式</p> <p>常见sink类型有如下几种：</p> <ul> <li>控制台输出：<code>stdout_color_sink_mt</code>（彩色）、<code>stdout_sink_mt</code></li> <li>文件输出：<code>basic_file_sink_mt</code>、<code>rotating_file_sink_mt</code></li> <li>系统日志：<code>syslog_sink_mt</code>（Linux）、<code>win_eventlog_sink_mt</code>（Windows）</li> <li>其他：UDP网络、数据库等（需自定义）</li> </ul> <div class="admonition note"> <p class=admonition-title>Note</p> <p>在spdlog中，命名后缀含义如下：</p> <ul> <li><code>_mt</code>：多线程安全版本（mutex protected）</li> <li><code>_st</code>：单线程版本（无锁，性能更高）</li> </ul> </div> <p>例如下面的代码：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=c1>// 创建控制台彩色sink（多线程安全）</span>
</span><span id=__span-4-2><span class=k>auto</span><span class=w> </span><span class=n>console_sink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks</span><span class=o>::</span><span class=n>stdout_color_sink_mt</span><span class=o>&gt;</span><span class=p>();</span>
</span><span id=__span-4-3>
</span><span id=__span-4-4><span class=c1>// 创建文件sink（自动创建文件）</span>
</span><span id=__span-4-5><span class=k>auto</span><span class=w> </span><span class=n>file_sink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks</span><span class=o>::</span><span class=n>basic_file_sink_mt</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;logs/app.log&quot;</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>spdlog中的sink工作原理如下：</p> <ul> <li>当调用<code>logger-&gt;info()</code>时，消息会传递给所有关联的sink</li> <li>每个sink独立处理消息（格式化、过滤、输出）</li> <li>sink之间互不影响</li> </ul> <p>在实际应用中，sink的组合使用可以实现多种复杂的日志输出需求，例如：</p> <ul> <li>同时输出到控制台和文件</li> <li>不同级别日志输出到不同文件</li> <li>关键错误同时发送到邮件/短信</li> </ul> <h2 id=_1>基本用法<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <h3 id=_2>包含头文件<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p>在代码中引入spdlog头文件：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-5-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span><span class=c1> // 文件日志</span>
</span><span id=__span-5-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span><span class=c1> // 控制台彩色日志</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_3>创建日志记录器<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>spdlog提供了多种日志记录器（logger），可以根据需求选择不同的类型：</p> <ol> <li>控制台日志</li> <li>文件日志</li> <li>混合日志（控制台 + 文件）</li> </ol> <h4 id=_4>控制台日志<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-6-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-6-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-6-3>
</span><span id=__span-6-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-6-5><span class=p>{</span>
</span><span id=__span-6-6><span class=w>    </span><span class=c1>// 创建一个控制台日志记录器</span>
</span><span id=__span-6-7><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>console</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;console&quot;</span><span class=p>);</span>
</span><span id=__span-6-8>
</span><span id=__span-6-9><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-6-10><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Welcome to spdlog!&quot;</span><span class=p>);</span>
</span><span id=__span-6-11><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;This is an error message.&quot;</span><span class=p>);</span>
</span><span id=__span-6-12><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>warn</span><span class=p>(</span><span class=s>&quot;This is a warning message.&quot;</span><span class=p>);</span>
</span><span id=__span-6-13>
</span><span id=__span-6-14><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-6-15><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>输出结果：</p> <p><a class=glightbox href=关于C++日志库spdlog.assets/image-20250409162202926.png data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src=关于C++日志库spdlog.assets/image-20250409162202926.png></a></p> <p>在上面的代码中，<code>stdout_color_mt</code>函数的参数表示日志记录器的名称标识符，这是一个字符串标识符，用于唯一标识这个特定的日志记录器实例</p> <p>如果想取出这个实例，可以通过下面的方式：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-7-1><span class=k>auto</span><span class=w> </span><span class=n>console</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=s>&quot;console&quot;</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>例如：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-8-1><span class=c1>// 通过名称获取已注册的记录器</span>
</span><span id=__span-8-2><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>get</span><span class=p>(</span><span class=s>&quot;console&quot;</span><span class=p>);</span>
</span><span id=__span-8-3><span class=k>if</span><span class=p>(</span><span class=n>logger</span><span class=p>)</span><span class=w> </span>
</span><span id=__span-8-4><span class=w>    </span><span class=n>logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Got existing logger&quot;</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> <p>默认情况下，spdlog使用的是第三方库fmt进行字符串格式化，如果要使用C++20的std::format，关于二者的介绍可以看[C++中的格式化字符串]，需要使用<code>SPDLOG_USE_STD_FORMAT</code>宏定义指定：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span>
<span class=normal>9</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-9-1><span class=c1>// 必须在包含任何spdlog头文件之前定义这个宏</span>
</span><span id=__span-9-2><span class=cp>#define SPDLOG_USE_STD_FORMAT</span>
</span><span id=__span-9-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;spdlog/spdlog.h&gt;</span>
</span><span id=__span-9-4>
</span><span id=__span-9-5><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-9-6><span class=p>{</span>
</span><span id=__span-9-7><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;使用 std::format: {}&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>42</span><span class=p>);</span>
</span><span id=__span-9-8><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-9-9><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_5>文件日志<a class=headerlink href=#_5 title="Permanent link">&para;</a></h4> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-10-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-10-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-10-3>
</span><span id=__span-10-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-10-5><span class=p>{</span>
</span><span id=__span-10-6><span class=w>    </span><span class=c1>// 创建一个文件日志记录器</span>
</span><span id=__span-10-7><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>file_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=p>(</span><span class=s>&quot;file_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/basic-log.txt&quot;</span><span class=p>);</span>
</span><span id=__span-10-8>
</span><span id=__span-10-9><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-10-10><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Log message to file.&quot;</span><span class=p>);</span>
</span><span id=__span-10-11><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;Error message to file.&quot;</span><span class=p>);</span>
</span><span id=__span-10-12>
</span><span id=__span-10-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-10-14><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>当前目录结构：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-11-1>.
</span><span id=__span-11-2>├── test.cc
</span><span id=__span-11-3>├── logs
</span><span id=__span-11-4>    └── basic-log.txt
</span></code></pre></div></td></tr></table></div> <p>文件内容如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-12-1>[2025-04-09 15:28:07.245] [file_logger] [info] Log message to file.
</span><span id=__span-12-2>[2025-04-09 15:28:07.245] [file_logger] [error] Error message to file.
</span></code></pre></div></td></tr></table></div> <p>在<code>basic_logger_mt</code>中还可以设置第三个参数，表示是否启用截断模式，即不论是否文件中存在内容都会清除该文件内容再继续写入，即：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-13-1><span class=k>auto</span><span class=w> </span><span class=n>file_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=p>(</span><span class=s>&quot;file_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/basic-log.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=nb>true</span><span class=p>);</span><span class=w> </span><span class=c1>// true 表示截断文件</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_6>混合日志（控制台 + 文件）<a class=headerlink href=#_6 title="Permanent link">&para;</a></h4> <p>可以同时向多个目标输出日志：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-14-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-14-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-14-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-14-4>
</span><span id=__span-14-5><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-14-6><span class=p>{</span>
</span><span id=__span-14-7><span class=w>    </span><span class=c1>// 创建控制台和文件日志记录器</span>
</span><span id=__span-14-8><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>console_sink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks</span><span class=o>::</span><span class=n>stdout_color_sink_mt</span><span class=o>&gt;</span><span class=p>();</span>
</span><span id=__span-14-9><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>file_sink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks</span><span class=o>::</span><span class=n>basic_file_sink_mt</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;logs/mixed-log.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=nb>true</span><span class=p>);</span>
</span><span id=__span-14-10>
</span><span id=__span-14-11><span class=w>    </span><span class=c1>// 组合多个 sink</span>
</span><span id=__span-14-12><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks_init_list</span><span class=w> </span><span class=n>sink_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span><span class=n>console_sink</span><span class=p>,</span><span class=w> </span><span class=n>file_sink</span><span class=p>};</span>
</span><span id=__span-14-13><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>combined_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>logger</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;multi_sink&quot;</span><span class=p>,</span><span class=w> </span><span class=n>sink_list</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>sink_list</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-14-14>
</span><span id=__span-14-15><span class=w>    </span><span class=c1>// 注册日志记录器</span>
</span><span id=__span-14-16><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>register_logger</span><span class=p>(</span><span class=n>combined_logger</span><span class=p>);</span>
</span><span id=__span-14-17>
</span><span id=__span-14-18><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-14-19><span class=w>    </span><span class=n>combined_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;This message will appear in both console and file.&quot;</span><span class=p>);</span>
</span><span id=__span-14-20><span class=w>    </span><span class=n>combined_logger</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;Error message to both outputs.&quot;</span><span class=p>);</span>
</span><span id=__span-14-21>
</span><span id=__span-14-22><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-14-23><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在上面代码中，<code>sinks_init_list</code>是spdlog定义的一个类型别名，本质上是<code>std::initializer_list</code>的封装，专门用于传递多个sink的初始化列表</p> <p>实际上在spdlog内部定义为： <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-15-1><span class=k>using</span><span class=w> </span><span class=n>sinks_init_list</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>initializer_list</span><span class=o>&lt;</span><span class=n>sink_ptr</span><span class=o>&gt;</span><span class=p>;</span>
</span></code></pre></div></td></tr></table></div></p> <p>主要用于需要将日志同时输出到多个目标的情况，比如： - 同时输出到控制台和文件 - 同时输出到本地文件和网络 - 不同日志级别输出到不同目标</p> <h3 id=_7>日志级别<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>spdlog支持以下几种日志级别，等级程度从低到高（从详细到不启动日志，处于上面的日志会包含其下的所有日志等级）：</p> <ul> <li><code>trace</code>: 最详细的调试信息</li> <li><code>debug</code>: 调试信息</li> <li><code>info</code>: 一般信息</li> <li><code>warn</code>: 警告信息</li> <li><code>error</code>: 错误信息</li> <li><code>critical</code>: 致命错误信息</li> <li><code>off</code>: 关闭日志</li> </ul> <p>可以通过以下方式设置全局日志级别：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-16-1><span class=n>spdlog</span><span class=o>::</span><span class=n>set_level</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>debug</span><span class=p>);</span><span class=w> </span><span class=c1>// 设置为 debug 级别</span>
</span></code></pre></div></td></tr></table></div> <p>此时文件和控制台就会输出同样等级的日志信息，例如下面的示例：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-17-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-17-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-17-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-17-4><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-17-5>
</span><span id=__span-17-6><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-17-7><span class=p>{</span>
</span><span id=__span-17-8><span class=w>    </span><span class=c1>// 创建控制台和文件日志记录器</span>
</span><span id=__span-17-9><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>console</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;console&quot;</span><span class=p>);</span>
</span><span id=__span-17-10><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>file_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=p>(</span><span class=s>&quot;file_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/level-demo.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=nb>true</span><span class=p>);</span>
</span><span id=__span-17-11>
</span><span id=__span-17-12><span class=w>    </span><span class=c1>// 设置不同日志级别</span>
</span><span id=__span-17-13><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>set_level</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>debug</span><span class=p>);</span><span class=w>    </span><span class=c1>// 控制台显示debug及以上级别</span>
</span><span id=__span-17-14><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>set_level</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>warn</span><span class=p>);</span><span class=w> </span><span class=c1>// 文件只记录warn及以上级别</span>
</span><span id=__span-17-15>
</span><span id=__span-17-16><span class=w>    </span><span class=c1>// 测试不同级别的日志</span>
</span><span id=__span-17-17><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>trace</span><span class=p>(</span><span class=s>&quot;控制台trace消息 - 不会显示&quot;</span><span class=p>);</span>
</span><span id=__span-17-18><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>debug</span><span class=p>(</span><span class=s>&quot;控制台debug消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-19><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;控制台info消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-20><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>warn</span><span class=p>(</span><span class=s>&quot;控制台warn消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-21><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;控制台error消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-22>
</span><span id=__span-17-23><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>trace</span><span class=p>(</span><span class=s>&quot;文件trace消息 - 不会记录&quot;</span><span class=p>);</span>
</span><span id=__span-17-24><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>debug</span><span class=p>(</span><span class=s>&quot;文件debug消息 - 不会记录&quot;</span><span class=p>);</span>
</span><span id=__span-17-25><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;文件info消息 - 不会记录&quot;</span><span class=p>);</span>
</span><span id=__span-17-26><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>warn</span><span class=p>(</span><span class=s>&quot;文件warn消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-27><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;文件error消息&quot;</span><span class=p>);</span>
</span><span id=__span-17-28>
</span><span id=__span-17-29><span class=w>    </span><span class=c1>// 动态修改日志级别</span>
</span><span id=__span-17-30><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;准备修改日志级别...&quot;</span><span class=p>);</span>
</span><span id=__span-17-31><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>set_level</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>info</span><span class=p>);</span><span class=w> </span><span class=c1>// 提高控制台日志级别</span>
</span><span id=__span-17-32>
</span><span id=__span-17-33><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>debug</span><span class=p>(</span><span class=s>&quot;修改后的debug消息 - 现在不会显示了&quot;</span><span class=p>);</span>
</span><span id=__span-17-34><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;修改后的info消息 - 仍然显示&quot;</span><span class=p>);</span>
</span><span id=__span-17-35>
</span><span id=__span-17-36><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-17-37><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><input id=__tabbed_1_2 name=__tabbed_1 type=radio><div class=tabbed-labels><label for=__tabbed_1_1>控制台输出</label><label for=__tabbed_1_2>文件内容</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-18-1>[2025-04-09 17:13:32.158] [console] [debug] 控制台debug消息
</span><span id=__span-18-2>[2025-04-09 17:13:32.158] [console] [info] 控制台info消息
</span><span id=__span-18-3>[2025-04-09 17:13:32.158] [console] [warning] 控制台warn消息
</span><span id=__span-18-4>[2025-04-09 17:13:32.158] [console] [error] 控制台error消息
</span><span id=__span-18-5>[2025-04-09 17:13:32.158] [console] [info] 准备修改日志级别...
</span><span id=__span-18-6>[2025-04-09 17:13:32.158] [console] [info] 修改后的info消息 - 仍然显示
</span></code></pre></div></td></tr></table></div> </div> <div class=tabbed-block> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-19-1>[2025-04-09 17:13:32.158] [file_logger] [warning] 文件warn消息
</span><span id=__span-19-2>[2025-04-09 17:13:32.158] [file_logger] [error] 文件error消息
</span></code></pre></div></td></tr></table></div> </div> </div> </div> <p>也可以为每个日志记录器单独设置日志级别，例如下面的代码只会记录<code>warn</code>及之后所有的信息：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-20-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-20-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-20-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-20-4>
</span><span id=__span-20-5><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span>
</span><span id=__span-20-6><span class=p>{</span>
</span><span id=__span-20-7><span class=w>    </span><span class=c1>// 首先删除旧的日志文件，确保结果准确</span>
</span><span id=__span-20-8><span class=w>    </span><span class=c1>// 创建一个文件日志记录器</span>
</span><span id=__span-20-9><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>file_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=p>(</span><span class=s>&quot;file_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/basic-log.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=nb>true</span><span class=p>);</span><span class=w> </span><span class=c1>// true 表示截断文件</span>
</span><span id=__span-20-10>
</span><span id=__span-20-11><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>set_level</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>warn</span><span class=p>);</span>
</span><span id=__span-20-12>
</span><span id=__span-20-13><span class=w>    </span><span class=c1>// 尝试记录不同级别的消息</span>
</span><span id=__span-20-14><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>trace</span><span class=p>(</span><span class=s>&quot;这是 trace 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-15><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>debug</span><span class=p>(</span><span class=s>&quot;这是 debug 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-16><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;这是 info 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-17><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>warn</span><span class=p>(</span><span class=s>&quot;这是 warn 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-18><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;这是 error 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-19><span class=w>    </span><span class=n>file_logger</span><span class=o>-&gt;</span><span class=n>critical</span><span class=p>(</span><span class=s>&quot;这是 critical 消息&quot;</span><span class=p>);</span>
</span><span id=__span-20-20>
</span><span id=__span-20-21><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-20-22><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>文件中的内容如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-21-1>[2025-04-09 17:11:03.019] [file_logger] [warning] 这是 warn 消息
</span><span id=__span-21-2>[2025-04-09 17:11:03.019] [file_logger] [error] 这是 error 消息
</span><span id=__span-21-3>[2025-04-09 17:11:03.019] [file_logger] [critical] 这是 critical 消息
</span></code></pre></div></td></tr></table></div> <h2 id=_8>格式化日志<a class=headerlink href=#_8 title="Permanent link">&para;</a></h2> <p>默认情况下，spdlog有自己的格式风格，spdlog支持丰富的日志格式化功能，也可以通过 <code>set_pattern</code> 方法自定义日志格式</p> <h3 id=_9>自定义日志格式<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-22-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-22-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-22-3>
</span><span id=__span-22-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-22-5><span class=p>{</span>
</span><span id=__span-22-6><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>console</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;console&quot;</span><span class=p>);</span>
</span><span id=__span-22-7>
</span><span id=__span-22-8><span class=w>    </span><span class=c1>// 自定义日志格式</span>
</span><span id=__span-22-9><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>set_pattern</span><span class=p>(</span><span class=s>&quot;[%Y-%m-%d %H:%M:%S.%e] [%^%l%$] %v&quot;</span><span class=p>);</span>
</span><span id=__span-22-10>
</span><span id=__span-22-11><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-22-12><span class=w>    </span><span class=n>console</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Custom format log message.&quot;</span><span class=p>);</span>
</span><span id=__span-22-13>
</span><span id=__span-22-14><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-22-15><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>对于上面的代码，格式说明如下：</p> <ul> <li><code>%Y-%m-%d %H:%M:%S.%e</code>: 时间戳（年-月-日 时:分:秒.毫秒）</li> <li><code>%^%l%$</code>: 日志级别（带颜色）</li> <li><code>%v</code>: 日志消息内容</li> </ul> <h3 id=_10>详细的日志格式说明<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>spdlog提供了丰富的格式占位符，可以自定义日志输出的格式。以下是常用的格式占位符及其说明：</p> <h3 id=_11>基础格式占位符<a class=headerlink href=#_11 title="Permanent link">&para;</a></h3> <ol> <li> <p><strong>时间相关</strong>：</p> <ul> <li><code>%Y</code>：4位年份（如2025）</li> <li><code>%m</code>：2位月份（01-12）</li> <li><code>%d</code>：2位日期（01-31）</li> <li><code>%H</code>：24小时制小时（00-23）</li> <li><code>%M</code>：分钟（00-59）</li> <li><code>%S</code>：秒（00-59）</li> <li><code>%e</code>：毫秒（000-999）</li> <li><code>%f</code>：微秒（000000-999999）</li> <li><code>%z</code>：时区偏移（如+0800）</li> </ul> </li> <li> <p><strong>日志内容</strong>：</p> <ul> <li><code>%v</code>：实际日志消息内容</li> <li><code>%n</code>：日志记录器名称</li> <li><code>%l</code>：日志级别（小写：trace/debug/info等）</li> <li><code>%L</code>：日志级别（大写：TRACE/DEBUG/INFO等）</li> <li><code>%t</code>：线程ID</li> </ul> </li> <li> <p><strong>颜色控制</strong>：</p> <ul> <li><code>%^</code>：开始颜色范围</li> <li><code>%$</code>：结束颜色范围</li> <li>示例：<code>%^%l%$</code>会给日志级别着色</li> </ul> </li> </ol> <h3 id=_12>高级格式占位符<a class=headerlink href=#_12 title="Permanent link">&para;</a></h3> <p>显示进程信息：</p> <ul> <li><code>%P</code>：进程ID</li> <li><code>%u</code>：线程名称（如果设置了）</li> </ul> <p>例如：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-23-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-23-2>
</span><span id=__span-23-3><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-23-4><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;logger&quot;</span><span class=p>);</span>
</span><span id=__span-23-5>
</span><span id=__span-23-6><span class=w>    </span><span class=c1>// 自定义格式：时间+级别（彩色）+线程ID+消息</span>
</span><span id=__span-23-7><span class=w>    </span><span class=n>logger</span><span class=o>-&gt;</span><span class=n>set_pattern</span><span class=p>(</span><span class=s>&quot;[%Y-%m-%d %H:%M:%S.%e] [%^%l%$] [thread:%t] %v&quot;</span><span class=p>);</span>
</span><span id=__span-23-8><span class=w>    </span><span class=n>logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;这是一条测试消息&quot;</span><span class=p>);</span>
</span><span id=__span-23-9>
</span><span id=__span-23-10><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-23-11><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>输出结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-24-1>[2025-04-09 15:30:45.678] [info] [thread:1234] 这是一条测试消息
</span></code></pre></div></td></tr></table></div> <h3 id=_13>注意事项<a class=headerlink href=#_13 title="Permanent link">&para;</a></h3> <ol> <li> <p>要使用显示文件名和行号的日志，需要使用相关的宏函数，例如<code>SPDLOG_INFO("信息")</code>，具体使用见下面的日志宏函数部分</p> </li> <li> <p>颜色控制占位符<code>%^</code>和<code>%$</code>必须成对使用，通常用于日志级别显示</p> </li> <li> <p>性能考虑：越详细的格式（特别是源码位置）对性能影响越大，建议生产环境使用简单格式</p> </li> </ol> <h2 id=_14>异步日志<a class=headerlink href=#_14 title="Permanent link">&para;</a></h2> <div class="admonition abstract"> <p class=admonition-title>Abstract</p> <p>本部分后续会进一步补充，此处给出一个简单的示例，后续会详细介绍异步日志的使用</p> </div> <p>spdlog支持异步日志记录，可以显著提高性能。需要在初始化时启用异步模式</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-25-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/async.h&quot;</span>
</span><span id=__span-25-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-25-3>
</span><span id=__span-25-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-25-5><span class=p>{</span>
</span><span id=__span-25-6><span class=w>    </span><span class=c1>// 初始化异步日志队列（建议大小为 8192）</span>
</span><span id=__span-25-7><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>init_thread_pool</span><span class=p>(</span><span class=mi>8192</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-25-8>
</span><span id=__span-25-9><span class=w>    </span><span class=c1>// 创建异步文件日志记录器</span>
</span><span id=__span-25-10><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>async_file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>async_factory</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;async_file_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/async-log.txt&quot;</span><span class=p>);</span>
</span><span id=__span-25-11>
</span><span id=__span-25-12><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-25-13><span class=w>    </span><span class=n>async_file</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Asynchronous log message.&quot;</span><span class=p>);</span>
</span><span id=__span-25-14><span class=w>    </span><span class=n>async_file</span><span class=o>-&gt;</span><span class=n>error</span><span class=p>(</span><span class=s>&quot;Asynchronous error message.&quot;</span><span class=p>);</span>
</span><span id=__span-25-15>
</span><span id=__span-25-16><span class=w>    </span><span class=c1>// 刷新日志队列</span>
</span><span id=__span-25-17><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>flush_on</span><span class=p>(</span><span class=n>spdlog</span><span class=o>::</span><span class=n>level</span><span class=o>::</span><span class=n>info</span><span class=p>);</span>
</span><span id=__span-25-18>
</span><span id=__span-25-19><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-25-20><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h2 id=_15>高级特性<a class=headerlink href=#_15 title="Permanent link">&para;</a></h2> <h3 id=_16>日志轮转<a class=headerlink href=#_16 title="Permanent link">&para;</a></h3> <p>日志轮转（Log Rotation）是一种日志管理技术，主要用于解决日志文件不断增长导致的问题，当日志文件达到特定条件（如大小限制或时间间隔）时，自动创建新的日志文件，同时归档或删除旧的日志文件。需要日志轮转的原因：</p> <ol> <li>防止单个日志文件过大</li> <li>自动归档历史日志</li> <li>节省磁盘空间</li> <li>便于日志管理和分析</li> </ol> <p>常见轮转策略有下面两种：</p> <ol> <li><strong>基于大小的轮转</strong>：当日志文件达到指定大小时创建新文件</li> <li><strong>基于时间的轮转</strong>：按固定时间间隔(如每天)创建新文件</li> </ol> <p>日志轮转过程模拟，假设配置为保留3个文件，文件名为<code>mylog.txt</code>： - 初始：<code>mylog.txt</code>（当前日志） - 第一次轮转： - <code>mylog.txt.1</code>（最新备份，包含的是最初的<code>mylog.txt</code>中的内容） - 新建空<code>mylog.txt</code> - 第二次轮转： - <code>mylog.txt.2</code>（最新备份，最开始的<code>mylog.txt</code>中的内容） - <code>mylog.txt.1</code>（上一次<code>mylog.txt</code>中的内容） - <code>mylog.txt</code> - 第三次轮转： - 删除<code>mylog.txt.3</code>（最新备份，包含的是最初的<code>mylog.txt</code>中的内容 ） - <code>mylog.txt.2</code>（包含的是第二次<code>mylog.txt.1</code>中的内容） - <code>mylog.txt.1</code>（包含的是第二次的<code>mylog.txt</code>中的内容） - <code>mylog.txt</code></p> <p>日志轮转的实际应用场景一般有：</p> <ul> <li>长期运行的服务程序</li> <li>高频率日志记录的应用</li> <li>磁盘空间有限的系统</li> <li>需要长期保存历史日志的场景</li> </ul> <p>在spdlog中，轮转是自动完成的，开发者只需配置轮转策略即可。spdlog支持基于文件大小或时间的日志轮转功能</p> <details class=info> <summary>日志轮转和日志回滚</summary> <p>需要注意，<strong>spdlog本身并不支持日志回滚（Log Rollback），但是支持日志轮转（Log Rotation）</strong>。如果想通过spdlog实现日志回滚可以结合C++ 17的filesystem库，关于filesystem具体在<a href=https://www.help-doc.top/cpp/new-in-cpp17/new-in-cpp17.html#filesystem>C++ 17相关新特性</a>有所介绍，例如：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-26-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-26-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-26-3><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;filesystem&gt;</span>
</span><span id=__span-26-4>
</span><span id=__span-26-5><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-26-6><span class=w>    </span><span class=c1>// 定义日志文件路径</span>
</span><span id=__span-26-7><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>log_file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;logs/mylog.txt&quot;</span><span class=p>;</span>
</span><span id=__span-26-8><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=w> </span><span class=n>backup_file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;logs/mylog_backup.txt&quot;</span><span class=p>;</span>
</span><span id=__span-26-9>
</span><span id=__span-26-10><span class=w>    </span><span class=c1>// 如果需要回滚，从备份文件恢复</span>
</span><span id=__span-26-11><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>std</span><span class=o>::</span><span class=n>filesystem</span><span class=o>::</span><span class=n>exists</span><span class=p>(</span><span class=n>backup_file</span><span class=p>))</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-26-12><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>filesystem</span><span class=o>::</span><span class=n>copy</span><span class=p>(</span><span class=n>backup_file</span><span class=p>,</span><span class=w> </span><span class=n>log_file</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>filesystem</span><span class=o>::</span><span class=n>copy_options</span><span class=o>::</span><span class=n>overwrite_existing</span><span class=p>);</span>
</span><span id=__span-26-13><span class=w>    </span><span class=p>}</span>
</span><span id=__span-26-14>
</span><span id=__span-26-15><span class=w>    </span><span class=c1>// 创建日志器</span>
</span><span id=__span-26-16><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=p>(</span><span class=s>&quot;logger_name&quot;</span><span class=p>,</span><span class=w> </span><span class=n>log_file</span><span class=p>);</span>
</span><span id=__span-26-17>
</span><span id=__span-26-18><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-26-19><span class=w>    </span><span class=n>logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;This is a test log message.&quot;</span><span class=p>);</span>
</span><span id=__span-26-20>
</span><span id=__span-26-21><span class=w>    </span><span class=c1>// 备份当前日志文件</span>
</span><span id=__span-26-22><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>filesystem</span><span class=o>::</span><span class=n>copy</span><span class=p>(</span><span class=n>log_file</span><span class=p>,</span><span class=w> </span><span class=n>backup_file</span><span class=p>,</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>filesystem</span><span class=o>::</span><span class=n>copy_options</span><span class=o>::</span><span class=n>overwrite_existing</span><span class=p>);</span>
</span><span id=__span-26-23>
</span><span id=__span-26-24><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-26-25><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> </details> <h4 id=_17>基于文件大小的轮转<a class=headerlink href=#_17 title="Permanent link">&para;</a></h4> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-27-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/rotating_file_sink.h&quot;</span>
</span><span id=__span-27-2>
</span><span id=__span-27-3><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-27-4><span class=p>{</span>
</span><span id=__span-27-5><span class=w>    </span><span class=c1>// 创建一个轮转文件日志记录器（最大5MB，保留3个文件）</span>
</span><span id=__span-27-6><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>rotating_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>rotating_logger_mt</span><span class=p>(</span><span class=s>&quot;rotating_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/rotate-log.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>1024</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1024</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>5</span><span class=p>,</span><span class=w> </span><span class=mi>3</span><span class=p>);</span>
</span><span id=__span-27-7>
</span><span id=__span-27-8><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-27-9><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w> </span><span class=o>++</span><span class=n>i</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-27-10><span class=w>        </span><span class=n>rotating_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Log message {}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=p>);</span>
</span><span id=__span-27-11><span class=w>    </span><span class=p>}</span>
</span><span id=__span-27-12>
</span><span id=__span-27-13><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-27-14><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_18>基于时间的轮转<a class=headerlink href=#_18 title="Permanent link">&para;</a></h4> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-28-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/daily_file_sink.h&quot;</span>
</span><span id=__span-28-2>
</span><span id=__span-28-3><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-28-4><span class=p>{</span>
</span><span id=__span-28-5><span class=w>    </span><span class=c1>// 创建一个每日轮转日志记录器（每天凌晨 0 点轮转）</span>
</span><span id=__span-28-6><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>daily_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>daily_logger_mt</span><span class=p>(</span><span class=s>&quot;daily_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/daily-log.txt&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-28-7>
</span><span id=__span-28-8><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-28-9><span class=w>    </span><span class=n>daily_logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Daily log message.&quot;</span><span class=p>);</span>
</span><span id=__span-28-10>
</span><span id=__span-28-11><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-28-12><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=sink_1>自定义Sink<a class=headerlink href=#sink_1 title="Permanent link">&para;</a></h3> <p>如果需要将日志输出到其他目标（如网络、数据库等），可以实现自定义Sink，例如下面的示例：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-29-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/base_sink.h&quot;</span>
</span><span id=__span-29-2>
</span><span id=__span-29-3><span class=c1>// 自定义 Sink 类</span>
</span><span id=__span-29-4><span class=k>template</span><span class=o>&lt;</span><span class=k>typename</span><span class=w> </span><span class=nc>Mutex</span><span class=o>&gt;</span>
</span><span id=__span-29-5><span class=k>class</span><span class=w> </span><span class=nc>MySink</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>sinks</span><span class=o>::</span><span class=n>base_sink</span><span class=o>&lt;</span><span class=n>Mutex</span><span class=o>&gt;</span><span class=w> </span>
</span><span id=__span-29-6><span class=p>{</span>
</span><span id=__span-29-7><span class=k>protected</span><span class=o>:</span>
</span><span id=__span-29-8><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=n>sink_it_</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>details</span><span class=o>::</span><span class=n>log_msg</span><span class=o>&amp;</span><span class=w> </span><span class=n>msg</span><span class=p>)</span><span class=w> </span><span class=k>override</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-29-9><span class=w>        </span><span class=c1>// 将日志消息转换为字符串</span>
</span><span id=__span-29-10><span class=w>        </span><span class=n>spdlog</span><span class=o>::</span><span class=n>memory_buf_t</span><span class=w> </span><span class=n>formatted</span><span class=p>;</span>
</span><span id=__span-29-11><span class=w>        </span><span class=k>this</span><span class=o>-&gt;</span><span class=n>formatter_</span><span class=o>-&gt;</span><span class=n>format</span><span class=p>(</span><span class=n>msg</span><span class=p>,</span><span class=w> </span><span class=n>formatted</span><span class=p>);</span>
</span><span id=__span-29-12>
</span><span id=__span-29-13><span class=w>        </span><span class=c1>// 输出到自定义目标（例如网络）</span>
</span><span id=__span-29-14><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>fmt</span><span class=o>::</span><span class=n>to_string</span><span class=p>(</span><span class=n>formatted</span><span class=p>);</span>
</span><span id=__span-29-15><span class=w>    </span><span class=p>}</span>
</span><span id=__span-29-16>
</span><span id=__span-29-17><span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=n>flush_</span><span class=p>()</span><span class=w> </span><span class=k>override</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-29-18><span class=w>        </span><span class=c1>// 刷新操作</span>
</span><span id=__span-29-19><span class=w>    </span><span class=p>}</span>
</span><span id=__span-29-20><span class=p>};</span>
</span><span id=__span-29-21>
</span><span id=__span-29-22><span class=k>using</span><span class=w> </span><span class=n>MySinkMT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>MySink</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>mutex</span><span class=o>&gt;</span><span class=p>;</span>
</span><span id=__span-29-23>
</span><span id=__span-29-24><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span>
</span><span id=__span-29-25><span class=p>{</span>
</span><span id=__span-29-26><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>my_sink</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>MySinkMT</span><span class=o>&gt;</span><span class=p>();</span>
</span><span id=__span-29-27><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>make_shared</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>logger</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;custom_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=n>my_sink</span><span class=p>);</span>
</span><span id=__span-29-28>
</span><span id=__span-29-29><span class=w>    </span><span class=c1>// 记录日志</span>
</span><span id=__span-29-30><span class=w>    </span><span class=n>logger</span><span class=o>-&gt;</span><span class=n>info</span><span class=p>(</span><span class=s>&quot;Custom sink log message.&quot;</span><span class=p>);</span>
</span><span id=__span-29-31>
</span><span id=__span-29-32><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-29-33><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_19>日志宏函数<a class=headerlink href=#_19 title="Permanent link">&para;</a></h3> <p>spdlog提供了一组宏函数，用于简化日志记录操作，同时支持自动捕获源码位置（文件名、行号和函数名）。这些宏函数是spdlog的核心特性之一，尤其在调试和开发过程中非常有用</p> <p>以下是spdlog中常见的宏函数及其用途的详细说明：</p> <h4 id=_20>基础日志宏函数<a class=headerlink href=#_20 title="Permanent link">&para;</a></h4> <p>这些宏函数对应于不同的日志级别，自动捕获源码位置信息并记录日志，常见的有如下：</p> <table> <thead> <tr> <th>宏函数</th> <th>对应的日志级别</th> <th>用途</th> </tr> </thead> <tbody> <tr> <td><code>SPDLOG_TRACE</code></td> <td><code>trace</code></td> <td>记录最详细的调试信息，通常仅在开发或调试阶段使用。</td> </tr> <tr> <td><code>SPDLOG_DEBUG</code></td> <td><code>debug</code></td> <td>记录调试信息，适合开发阶段使用。</td> </tr> <tr> <td><code>SPDLOG_INFO</code></td> <td><code>info</code></td> <td>记录一般信息，适合生产环境中的常规日志记录。</td> </tr> <tr> <td><code>SPDLOG_WARN</code></td> <td><code>warn</code></td> <td>记录警告信息，提示潜在问题但不影响程序运行。</td> </tr> <tr> <td><code>SPDLOG_ERROR</code></td> <td><code>error</code></td> <td>记录错误信息，表示程序运行中发生了错误但未导致崩溃。</td> </tr> <tr> <td><code>SPDLOG_CRITICAL</code></td> <td><code>critical</code></td> <td>记录严重错误信息，通常表示程序即将崩溃或无法继续运行。</td> </tr> </tbody> </table> <p>例如下面的代码：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-30-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-30-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-30-3>
</span><span id=__span-30-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-30-5><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;logger&quot;</span><span class=p>);</span>
</span><span id=__span-30-6>
</span><span id=__span-30-7><span class=w>    </span><span class=c1>// 设置日志格式：显示文件名、行号和消息</span>
</span><span id=__span-30-8><span class=w>    </span><span class=n>SPDLOG_TRACE</span><span class=p>(</span><span class=s>&quot;Trace message&quot;</span><span class=p>);</span>
</span><span id=__span-30-9><span class=w>    </span><span class=n>SPDLOG_DEBUG</span><span class=p>(</span><span class=s>&quot;Debug message&quot;</span><span class=p>);</span>
</span><span id=__span-30-10><span class=w>    </span><span class=n>SPDLOG_INFO</span><span class=p>(</span><span class=s>&quot;Info message&quot;</span><span class=p>);</span>
</span><span id=__span-30-11><span class=w>    </span><span class=n>SPDLOG_WARN</span><span class=p>(</span><span class=s>&quot;Warning message&quot;</span><span class=p>);</span>
</span><span id=__span-30-12><span class=w>    </span><span class=n>SPDLOG_ERROR</span><span class=p>(</span><span class=s>&quot;Error message&quot;</span><span class=p>);</span>
</span><span id=__span-30-13><span class=w>    </span><span class=n>SPDLOG_CRITICAL</span><span class=p>(</span><span class=s>&quot;Critical message&quot;</span><span class=p>);</span>
</span><span id=__span-30-14>
</span><span id=__span-30-15><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-30-16><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>输出结果如下：</p> <div class="language-text highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>Text Only</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-31-1>[2025-04-09 17:55:01.327] [info] [test.cc:151] Info message
</span><span id=__span-31-2>[2025-04-09 17:55:01.327] [warning] [test.cc:152] Warning message
</span><span id=__span-31-3>[2025-04-09 17:55:01.327] [error] [test.cc:153] Error message
</span><span id=__span-31-4>[2025-04-09 17:55:01.327] [critical] [test.cc:154] Critical message
</span></code></pre></div></td></tr></table></div> <h4 id=_21>自定义宏函数<a class=headerlink href=#_21 title="Permanent link">&para;</a></h4> <p>除了上述预定义的宏函数，spdlog还允许用户定义自己的宏函数。这在需要扩展功能或适配特定需求时非常有用，例如下面的代码：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-32-1><span class=cp>#define MY_LOG_INFO(logger, ...) SPDLOG_INFO(__VA_ARGS__)</span>
</span><span id=__span-32-2><span class=cp>#define MY_LOG_ERROR(logger, ...) SPDLOG_ERROR(__VA_ARGS__)</span>
</span><span id=__span-32-3>
</span><span id=__span-32-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-32-5><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;logger&quot;</span><span class=p>);</span>
</span><span id=__span-32-6>
</span><span id=__span-32-7><span class=w>    </span><span class=c1>// 使用自定义宏函数</span>
</span><span id=__span-32-8><span class=w>    </span><span class=n>MY_LOG_INFO</span><span class=p>(</span><span class=n>logger</span><span class=p>,</span><span class=w> </span><span class=s>&quot;This is a custom info message.&quot;</span><span class=p>);</span>
</span><span id=__span-32-9><span class=w>    </span><span class=n>MY_LOG_ERROR</span><span class=p>(</span><span class=n>logger</span><span class=p>,</span><span class=w> </span><span class=s>&quot;This is a custom error message.&quot;</span><span class=p>);</span>
</span><span id=__span-32-10>
</span><span id=__span-32-11><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-32-12><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>在上面的代码中，在C/C++宏定义中，<code>...</code>和<code>__VA_ARGS__</code>是可变参数宏（Variadic Macros）的语法，用于处理不定数量的参数。具体解释如下：</p> <ol> <li><code>...</code>（省略号）：在宏定义中表示该宏接受可变数量的参数，必须出现在宏参数列表的最后。</li> <li><code>__VA_ARGS__</code>：是一个预定义的宏，表示"variable arguments"（可变参数），用于展开宏定义中<code>...</code>部分传入的所有参数</li> </ol> <p>例如，上面的宏还可以像下面这样使用：</p> <p><div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-33-1><span class=n>MY_LOG_INFO</span><span class=p>(</span><span class=n>my_logger</span><span class=p>,</span><span class=w> </span><span class=s>&quot;用户{}登录成功，IP地址：{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>ip_address</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div> 会被展开为： <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-34-1><span class=n>SPDLOG_INFO</span><span class=p>(</span><span class=s>&quot;用户{}登录成功，IP地址：{}&quot;</span><span class=p>,</span><span class=w> </span><span class=n>user_id</span><span class=p>,</span><span class=w> </span><span class=n>ip_address</span><span class=p>);</span>
</span></code></pre></div></td></tr></table></div></p> <h4 id=_22>异步日志的宏函数<a class=headerlink href=#_22 title="Permanent link">&para;</a></h4> <p>如果启用了异步日志记录功能（通过 <code>spdlog::init_thread_pool</code> 初始化线程池），所有宏函数仍然可以正常工作。异步日志记录不会影响宏函数的行为</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-35-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/async.h&quot;</span>
</span><span id=__span-35-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/basic_file_sink.h&quot;</span>
</span><span id=__span-35-3>
</span><span id=__span-35-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-35-5><span class=w>    </span><span class=c1>// 初始化异步日志队列</span>
</span><span id=__span-35-6><span class=w>    </span><span class=n>spdlog</span><span class=o>::</span><span class=n>init_thread_pool</span><span class=p>(</span><span class=mi>8192</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-35-7>
</span><span id=__span-35-8><span class=w>    </span><span class=c1>// 创建异步文件日志记录器</span>
</span><span id=__span-35-9><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>async_logger</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>basic_logger_mt</span><span class=o>&lt;</span><span class=n>spdlog</span><span class=o>::</span><span class=n>async_factory</span><span class=o>&gt;</span><span class=p>(</span><span class=s>&quot;async_logger&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;logs/async-log.txt&quot;</span><span class=p>);</span>
</span><span id=__span-35-10>
</span><span id=__span-35-11><span class=w>    </span><span class=c1>// 设置日志格式</span>
</span><span id=__span-35-12><span class=w>    </span><span class=n>async_logger</span><span class=o>-&gt;</span><span class=n>set_pattern</span><span class=p>(</span><span class=s>&quot;[%s:%#] [%^%l%$] %v&quot;</span><span class=p>);</span>
</span><span id=__span-35-13>
</span><span id=__span-35-14><span class=w>    </span><span class=c1>// 使用宏函数记录日志</span>
</span><span id=__span-35-15><span class=w>    </span><span class=n>SPDLOG_INFO</span><span class=p>(</span><span class=s>&quot;Asynchronous info message&quot;</span><span class=p>);</span>
</span><span id=__span-35-16><span class=w>    </span><span class=n>SPDLOG_ERROR</span><span class=p>(</span><span class=s>&quot;Asynchronous error message&quot;</span><span class=p>);</span>
</span><span id=__span-35-17>
</span><span id=__span-35-18><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-35-19><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h4 id=_23>其他相关宏<a class=headerlink href=#_23 title="Permanent link">&para;</a></h4> <p>除了日志级别的宏函数外，spdlog还提供了一些辅助宏，用于增强日志功能：</p> <table> <thead> <tr> <th>宏名称</th> <th>含义</th> </tr> </thead> <tbody> <tr> <td><code>SPDLOG_LOGGER_CALL</code></td> <td>通用日志记录宏，允许指定日志级别、日志记录器和消息</td> </tr> <tr> <td><code>SPDLOG_LOGGER_INFO</code></td> <td>类似于<code>SPDLOG_INFO</code>，但允许指定特定的日志记录器</td> </tr> <tr> <td><code>SPDLOG_LOGGER_ERROR</code></td> <td>类似于<code>SPDLOG_ERROR</code>，但允许指定特定的日志记录器</td> </tr> <tr> <td><code>SPDLOG_LOGGER_TRACE</code></td> <td>类似于<code>SPDLOG_TRACE</code>，但允许指定特定的日志记录器</td> </tr> </tbody> </table> <p>例如下面的代码：</p> <div class="language-cpp highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>C++</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-36-1><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/spdlog.h&quot;</span>
</span><span id=__span-36-2><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;spdlog/sinks/stdout_color_sinks.h&quot;</span>
</span><span id=__span-36-3>
</span><span id=__span-36-4><span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-36-5><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;logger1&quot;</span><span class=p>);</span>
</span><span id=__span-36-6><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>logger2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>spdlog</span><span class=o>::</span><span class=n>stdout_color_mt</span><span class=p>(</span><span class=s>&quot;logger2&quot;</span><span class=p>);</span>
</span><span id=__span-36-7>
</span><span id=__span-36-8><span class=w>    </span><span class=c1>// 使用SPDLOG_LOGGER_INFO指定日志记录器</span>
</span><span id=__span-36-9><span class=w>    </span><span class=n>SPDLOG_LOGGER_INFO</span><span class=p>(</span><span class=n>logger1</span><span class=p>,</span><span class=w> </span><span class=s>&quot;This is a message from logger1.&quot;</span><span class=p>);</span>
</span><span id=__span-36-10><span class=w>    </span><span class=n>SPDLOG_LOGGER_INFO</span><span class=p>(</span><span class=n>logger2</span><span class=p>,</span><span class=w> </span><span class=s>&quot;This is a message from logger2.&quot;</span><span class=p>);</span>
</span><span id=__span-36-11>
</span><span id=__span-36-12><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-36-13><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年9月1日</span> </span> </aside> <!-- Waline 评论系统 --> <div id=waline></div> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> 回到页面顶部 </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "navigation.sections", "toc.follow", "content.code.copy", "navigation.top"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../javascripts/other.min.js></script> <script src=../../javascripts/copyright.min.js></script> <script src=../../javascripts/docsearch.min.js></script> <script src=../../javascripts/navigation-overlay.min.js></script> <script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script> <script src=../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>