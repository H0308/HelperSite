<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=canonical href=https://www.help-doc.top/projects/json-rpc/intro/intro.html><link rel=prev href=../../reactor-server/server-module-design/server-module-design.html><link rel=next href=../basic-module-design/basic-module-design.html><link rel=icon href=../../../images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.12"><title>项目介绍与准备 - 柯懒的知识库</title><link rel=stylesheet href=../../../assets/stylesheets/main.2afb09e1.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.06af60db.min.css><link rel=stylesheet href=../../../css/timeline.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-9XWRGNRRSY"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-9XWRGNRRSY",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-9XWRGNRRSY",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script><link rel=stylesheet href=../../../stylesheets/colors.min.css><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (max-width: 1199px)"><link rel=stylesheet href=../../../stylesheets/theme2.min.css media="screen and (min-width: 1200px)" id=theme2-desktop><link rel=stylesheet href=../../../stylesheets/theme1.min.css media="screen and (min-width: 1200px)" id=theme1-desktop><link rel=stylesheet href=../../../stylesheets/print.min.css><link rel=stylesheet href=../../../stylesheets/font-dongguanti.min.css id=font-dongguanti><link rel=stylesheet href=../../../stylesheets/font-oppoti.min.css id=font-oppoti disabled><link rel=stylesheet href=../../../stylesheets/font-jiangchengti.min.css id=font-jiangchengti disabled><link rel=stylesheet href=../../../stylesheets/font-lxgw.min.css id=font-lxgw disabled><link rel=stylesheet href=../../../stylesheets/code-font-dejavu-sans-mono.min.css id=code-font-dejavu-sans-mono><link rel=stylesheet href=../../../stylesheets/code-font-zsft-hk.min.css id=code-font-zsft-hk disabled><link rel=stylesheet href=https://unpkg.com/@waline/client@v3/dist/waline.css><link rel=stylesheet href=../../../stylesheets/waline.min.css><script src=../../../javascripts/start.min.js></script> <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=../../../index.html title=柯懒的知识库 class="md-header__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 柯懒的知识库 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 项目介绍与准备 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=cyan aria-label type=radio name=__palette id=__palette_1> </form> <!-- 头像元素 - 直接在HTML中定义 --> <div class=header-avatar> <img src=../../../author/作者.assets/20250206-200653.jpg alt=头像> <div class=avatar-dropdown> <p><strong>柯懒不是柯南</strong></p> <a href=../../../author/contact/contact.html class=avatar-dropdown-item>吵醒柯懒</a> <div class=avatar-dropdown-divider></div> <a href=../../../author/about/about.html class=avatar-dropdown-item>柯懒自传</a> <div class=avatar-dropdown-divider></div> <a href=https://github.com/H0308 class=avatar-dropdown-item>柯懒的零食库</a> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <!-- 独立的切换按钮 --> <div class=toolbar-toggle-btn id=toolbarToggleBtn onclick=toggleToolbar()> <div class=toggle-icon> <svg class=toggle-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=16 height=16> <path d="M346.538667 1024L170.666667 853.333333l341.333333-341.333333-341.333333-341.333333 175.872-170.666667L853.333333 512z" fill=currentColor></path> </svg> </div> </div> <!-- 右侧固定功能条 - 独立于内容区 --> <div class=floating-toolbar id=floatingToolbar> <!-- 字体切换功能 --> <div class="toolbar-item font-switcher"> <div class=toolbar-icon> <svg class=font-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M913.408 1024l-66.56 0q-29.696 0-51.2-5.12t-36.864-15.872-26.112-27.136-19.968-37.888q-15.36-38.912-28.16-70.656t-22.016-55.296q-11.264-26.624-20.48-49.152l-254.976 0q-7.168 23.552-17.408 51.2-8.192 23.552-21.504 56.832t-30.72 72.192q-20.48 46.08-47.104 63.488t-60.416 17.408l-70.656 0q-45.056 0-60.928-19.968t2.56-68.096q18.432-46.08 43.008-108.544t52.224-132.608 57.344-143.872 57.344-144.384q65.536-164.864 137.216-343.04 7.168-17.408 18.432-31.744 10.24-11.264 27.136-21.504t42.496-10.24q26.624 0 43.52 10.752t28.16 24.064q12.288 15.36 19.456 33.792 72.704 180.224 138.24 345.088 27.648 70.656 57.344 143.872t56.832 142.336 51.2 129.536 41.472 104.448q14.336 34.816 4.096 62.464t-43.008 27.648zM616.448 634.88l-97.28-347.136-1.024 0-108.544 347.136 206.848 0z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>内容字体</div> <div class=font-dropdown-toolbar> <div class=font-current-toolbar onclick=toggleFontDropdownToolbar()> <span class=current-font-name-toolbar>东观体</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=font-options-toolbar> <div class=font-option-toolbar data-font=dongguanti onclick="selectFontToolbar('dongguanti')">上图东观体 </div> <div class=font-option-toolbar data-font=oppoti onclick="selectFontToolbar('oppoti')">OPPO Sans </div> <div class=font-option-toolbar data-font=jiangchengti onclick="selectFontToolbar('jiangchengti')"> 江城黑体</div> <div class=font-option-toolbar data-font=lxgw onclick="selectFontToolbar('lxgw')">霞鹜臻楷</div> </div> </div> </div> <!-- 代码字体切换功能 --> <div class="toolbar-item code-font-switcher"> <div class=toolbar-icon> <svg t=1753672111433 class="icon code-font-icon" viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg p-id=5148 width=20 height=20> <path d="M941.709938 0H82.290062A82.290062 82.290062 0 0 0 0 82.290062v859.419876A82.290062 82.290062 0 0 0 82.290062 1022.53923h859.419876A82.290062 82.290062 0 0 0 1022.53923 941.709938V82.290062A82.290062 82.290062 0 0 0 941.709938 0zM188.439372 553.631954a40.901569 40.901569 0 0 1-29.215406-70.116975L292.154066 351.558726 159.223966 218.628626a40.901569 40.901569 0 0 1 58.430813-57.94389l160.197813 162.145507a40.901569 40.901569 0 0 1 0 57.943889l-160.197813 160.684736a40.901569 40.901569 0 0 1-29.215407 12.173086z m443.587257 0H405.120304a40.901569 40.901569 0 0 1 0-82.290061H633.000476a40.901569 40.901569 0 0 1 0 82.290061z" fill=currentColor p-id=5149></path> </svg> </div> <div class=toolbar-label>代码字体</div> <div class=code-font-dropdown-toolbar> <div class=code-font-current-toolbar onclick=toggleCodeFontDropdownToolbar()> <span class=current-code-font-name-toolbar>DejaVu Sans Mono</span> <svg class=dropdown-arrow-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=12 height=12> <path d="M878.592 250.88q29.696 0 48.128 11.264t24.576 29.696 0 41.472-26.624 45.568q-82.944 92.16-159.744 180.224t-148.48 164.864q-19.456 20.48-45.568 31.744t-53.76 11.776-53.248-8.704-43.008-28.672q-39.936-44.032-82.944-90.112l-88.064-92.16q-43.008-46.08-85.504-90.624t-79.36-86.528q-17.408-19.456-22.528-40.448t1.024-38.4 23.552-28.672 45.056-11.264q35.84 0 98.816-0.512t137.728-0.512l153.6 0 150.528 0 125.952 0 79.872 0z" fill=currentColor></path> </svg> </div> <div class=code-font-options-toolbar> <div class=code-font-option-toolbar data-code-font=dejavu onclick="selectCodeFontToolbar('dejavu')"> DejaVu Sans Mono</div> <div class=code-font-option-toolbar data-code-font=zsft onclick="selectCodeFontToolbar('zsft')"> JetBrains Mono</div> </div> </div> </div> <!-- 主题切换功能 --> <div class="toolbar-item theme-switcher" onclick=switchTheme()> <div class=toolbar-icon> <svg class=theme-icon viewbox="0 0 1024 1024" version=1.1 xmlns=http://www.w3.org/2000/svg width=20 height=20> <path d="M876.572788 522.301623c-1.886977 12.375865-9.657964 30.331819-35.880185 45.48903-56.489572 32.697703-150.21828 83.990926-174.010149 96.958262-13.143345 24.431435-66.067718 122.221646-98.141204 178.503487-16.117073 28.124548-36.055171 34.041304-50.030463 34.041304-0.031722 0-0.031722 0-0.031722 0-14.613836 0-29.1806-6.460132-43.234687-19.218714-47.183626-42.643216-125.994576-117.105115-146.013515-136.083351-27.757181-4.732791-138.338718-23.743774-200.584388-35.752272-17.924231-3.533476-32.649608-14.07046-40.372499-29.084409-5.78782-11.256368-10.281157-30.05962 1.471514-55.658647 26.989701-59.047838 74.126254-157.557432 85.957721-182.196599-3.437286-27.117614-16.996093-135.060045-23.760147-198.905142-1.886977-17.460674 3.901867-35.096333 15.829524-48.351218 12.791327-14.278191 30.667463-21.48943 49.854455-19.426445 63.669088 6.332219 173.259042 19.426445 200.584388 22.705118 24.335245-11.879562 121.085776-58.936297 180.133613-86.34146 9.91379-4.573155 19.85828-6.92369 29.596062-6.92369 28.748764 0 52.172243 20.642133 58.328453 51.421136 12.599969 62.997799 30.93864 166.70272 35.639708 193.484689 18.851347 19.682271 91.953272 96.031147 135.060045 143.07151C872.72004 487.125473 879.307062 504.71406 876.572788 522.301623L876.572788 522.301623zM825.375755 499.085876C776.017604 445.314205 687.245791 352.977193 686.365748 352.017332c-2.942005-3.069919-4.956895-6.971785-5.676279-11.208273-0.207731-1.215688-22.193465-127.001509-36.551474-198.936865-0.799202-3.917216-4.285606-16.836457-16.196891-16.836457-3.453658 0-7.30743 1.006933-11.464099 2.942005-67.282383 31.179117-183.955662 88.180342-185.170327 88.771813-3.693112 1.790786-7.850805 2.558265-11.975752 2.01489-1.295506-0.224104-133.63765-16.165168-205.988468-23.424502-0.079818 0-0.207731 0-0.287549 0-7.30743 0-11.128455 2.89391-13.319353 5.40408-3.677762 4.124947-5.644557 9.91379-5.068436 15.110139 7.674796 72.623018 24.255427 202.934922 24.463158 204.325595 0.511653 4.109598-0.159636 8.266267-1.966795 11.960403-0.591471 1.215688-57.657164 120.04712-88.339977 187.201589-3.565199 7.754614-4.41352 14.214746-2.350534 18.131963 1.935072 3.725858 6.588045 5.820566 10.360975 6.53995 70.719668 13.718443 204.644867 36.519752 206.036563 36.727483 4.189416 0.671289 8.058536 2.686179 11.112082 5.580089 1.006933 0.87902 96.414887 91.281983 150.090367 139.889027 8.314363 7.563256 13.143345 8.106632 14.437827 8.106632 3.485381 0 8.314363-4.621251 12.727882-12.391215 36.343743-63.828724 100.011808-181.988868 100.636025-183.155437 1.983167-3.64604 5.004991-6.667863 8.650007-8.650007 1.134847-0.671289 114.418936-62.373583 178.6314-99.516528 8.698103-5.036713 14.278191-10.568706 14.94948-14.854313C834.681702 511.845481 831.49922 505.800811 825.375755 499.085876L825.375755 499.085876zM935.333076 935.670256c-4.157693 4.157693-9.689686 6.299473-15.141862 6.299473-5.548366 0-11.048637-2.142803-15.238053-6.299473l-171.915441-171.915441c-8.362458-8.394181-8.362458-21.98471 0-30.426987 8.394181-8.394181 21.98471-8.394181 30.379914 0l171.915441 171.915441C943.727257 913.684522 943.727257 927.275052 935.333076 935.670256L935.333076 935.670256z" fill=currentColor></path> </svg> </div> <div class=toolbar-label>主题切换</div> </div> <!-- 返回顶部功能 --> <div class="toolbar-item back-to-top" onclick=scrollToTop()> <div class=toolbar-icon> <svg class=back-to-top-icon viewbox="0 0 1024 1024" xmlns=http://www.w3.org/2000/svg> <path d="M882.688 624.128l-336.896-583.68c-15.872-27.136-54.784-27.136-70.656 0L138.24 624.128c-15.872 27.136 4.096 61.44 35.328 61.44H317.44c22.528 0 40.96 18.432 40.96 40.96v239.616c0 22.528 18.432 40.96 40.96 40.96h223.232c22.528 0 40.96-18.432 40.96-40.96v-239.616c0-22.528 18.432-40.96 40.96-40.96h143.872c30.208 0 50.176-34.304 34.304-61.44z"> </path> </svg> </div> <div class=toolbar-label>返回顶部</div> </div> </div> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=标签 data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../index.html class=md-tabs__link> 主页 </a> </li> <li class=md-tabs__item> <a href=../../../intro/intro.html class=md-tabs__link> 网站介绍 </a> </li> <li class=md-tabs__item> <a href=../../../timeline/timeline.html class=md-tabs__link> 网站时间线 </a> </li> <li class=md-tabs__item> <a href=../../../c-lang/index.html class=md-tabs__link> 编程语言 </a> </li> <li class=md-tabs__item> <a href=../../../data-structure/time-space-complexity/time-space-complexity.html class=md-tabs__link> 数据结构与算法 </a> </li> <li class=md-tabs__item> <a href=../../../Linux/options-commands/options-commands.html class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../html-css/html/html.html class=md-tabs__link> 前端 </a> </li> <li class=md-tabs__item> <a href=../../../MySQL/JDBC/JDBC-basic/JDBC-basic.html class=md-tabs__link> MySQL </a> </li> <li class=md-tabs__item> <a href=../../../JavaEE/Spring/springmvc-basic/springmvc-basic.html class=md-tabs__link> JavaEE应用开发 </a> </li> <li class=md-tabs__item> <a href=../../../other/shell/shell.html class=md-tabs__link> 扩展知识 </a> </li> <li class=md-tabs__item> <a href=../../../tooltips/vscode-snippets/vscode-snippets.html class=md-tabs__link> 工具帮助 </a> </li> <li class=md-tabs__item> <a href=../../../test-encrypt/test-encrypt.html class=md-tabs__link> 测试加密功能 </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../boost-searching-engine/boost-searching-engine.html class=md-tabs__link> 项目 </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../index.html title=柯懒的知识库 class="md-nav__button md-logo" aria-label=柯懒的知识库 data-md-component=logo> <img src=../../../assets/logo.png alt=logo> </a> 柯懒的知识库 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../index.html class=md-nav__link> <span class=md-ellipsis> 主页 </span> </a> </li> <li class=md-nav__item> <a href=../../../intro/intro.html class=md-nav__link> <span class=md-ellipsis> 网站介绍 </span> </a> </li> <li class=md-nav__item> <a href=../../../timeline/timeline.html class=md-nav__link> <span class=md-ellipsis> 网站时间线 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../c-lang/index.html class=md-nav__link> <span class=md-ellipsis> 编程语言 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../data-structure/time-space-complexity/time-space-complexity.html class=md-nav__link> <span class=md-ellipsis> 数据结构与算法 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../Linux/options-commands/options-commands.html class=md-nav__link> <span class=md-ellipsis> Linux </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../html-css/html/html.html class=md-nav__link> <span class=md-ellipsis> 前端 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../MySQL/JDBC/JDBC-basic/JDBC-basic.html class=md-nav__link> <span class=md-ellipsis> MySQL </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../JavaEE/Spring/springmvc-basic/springmvc-basic.html class=md-nav__link> <span class=md-ellipsis> JavaEE应用开发 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../other/shell/shell.html class=md-nav__link> <span class=md-ellipsis> 扩展知识 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../tooltips/vscode-snippets/vscode-snippets.html class=md-nav__link> <span class=md-ellipsis> 工具帮助 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../../test-encrypt/test-encrypt.html class=md-nav__link> <span class=md-ellipsis> 测试加密功能 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_13 checked> <label class=md-nav__link for=__nav_13 id=__nav_13_label tabindex> <span class=md-ellipsis> 项目 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_13_label aria-expanded=true> <label class=md-nav__title for=__nav_13> <span class="md-nav__icon md-icon"></span> 项目 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../boost-searching-engine/boost-searching-engine.html class=md-nav__link> <span class=md-ellipsis> Boost库搜索引擎 </span> </a> </li> <li class="md-nav__item md-nav__item--pruned md-nav__item--nested"> <a href=../../reactor-server/intro/intro.html class=md-nav__link> <span class=md-ellipsis> 仿Muduo库的高并发服务器 </span> <span class="md-nav__icon md-icon"></span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_13_3 checked> <label class=md-nav__link for=__nav_13_3 id=__nav_13_3_label tabindex=0> <span class=md-ellipsis> 基于JSON的RPC框架 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_13_3_label aria-expanded=true> <label class=md-nav__title for=__nav_13_3> <span class="md-nav__icon md-icon"></span> 基于JSON的RPC框架 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 项目介绍与准备 </span> <span class="md-nav__icon md-icon"></span> </label> <a href=intro.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 项目介绍与准备 </span> </a> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#rpc class=md-nav__link> <span class=md-ellipsis> 何为RPC </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 功能介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 基础模块 </span> </a> <nav class=md-nav aria-label=基础模块> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 网络服务模块 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 应用层协议模块 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 消息分发模块 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 服务端模块介绍 </span> </a> <nav class=md-nav aria-label=服务端模块介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#rpc_1 class=md-nav__link> <span class=md-ellipsis> RPC功能模块 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 服务注册模块 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 主题操作模块 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 服务器模块 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 客户端模块介绍 </span> </a> <nav class=md-nav aria-label=客户端模块介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 请求管理模块 </span> </a> </li> <li class=md-nav__item> <a href=#rpc_2 class=md-nav__link> <span class=md-ellipsis> RPC功能模块 </span> </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 服务注册模块 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 主题操作模块 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 客户端模块 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../basic-module-design/basic-module-design.html class=md-nav__link> <span class=md-ellipsis> 基础模块设计 </span> </a> </li> <li class=md-nav__item> <a href=../function-module-design-1/function-module-design-1.html class=md-nav__link> <span class=md-ellipsis> 功能模块设计（RPC、注册） </span> </a> </li> <li class=md-nav__item> <a href=../function-module-design-2/function-module-design-2.html class=md-nav__link> <span class=md-ellipsis> 功能模块设计（主题、客户端封装、服务端封装） </span> </a> </li> <li class=md-nav__item> <a href=../function-test/function-test.html class=md-nav__link> <span class=md-ellipsis> 功能测试 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=本节目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 本节目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#rpc class=md-nav__link> <span class=md-ellipsis> 何为RPC </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 功能介绍 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 基础模块 </span> </a> <nav class=md-nav aria-label=基础模块> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 网络服务模块 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 应用层协议模块 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 消息分发模块 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 服务端模块介绍 </span> </a> <nav class=md-nav aria-label=服务端模块介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#rpc_1 class=md-nav__link> <span class=md-ellipsis> RPC功能模块 </span> </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> <span class=md-ellipsis> 服务注册模块 </span> </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> <span class=md-ellipsis> 主题操作模块 </span> </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> <span class=md-ellipsis> 服务器模块 </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> <span class=md-ellipsis> 客户端模块介绍 </span> </a> <nav class=md-nav aria-label=客户端模块介绍> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_14 class=md-nav__link> <span class=md-ellipsis> 模块总览 </span> </a> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> <span class=md-ellipsis> 请求管理模块 </span> </a> </li> <li class=md-nav__item> <a href=#rpc_2 class=md-nav__link> <span class=md-ellipsis> RPC功能模块 </span> </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> <span class=md-ellipsis> 服务注册模块 </span> </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> <span class=md-ellipsis> 主题操作模块 </span> </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> <span class=md-ellipsis> 客户端模块 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=_1>项目介绍与准备<a class=headerlink href=#_1 title="Permanent link">&para;</a></h1> <div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;"> <p><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"/></svg></span> 约 4391 个字 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 640 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg></span> 117 行代码 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 17H7V3h14m0-2H7a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2M3 5H1v16a2 2 0 0 0 2 2h16v-2H3m12.96-10.71-2.75 3.54-1.96-2.36L8.5 15h11z"/></svg></span> 6 张图片 <span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"/></svg></span> 预计阅读时间 16 分钟</p> </div> <h2 id=rpc>何为RPC<a class=headerlink href=#rpc title="Permanent link">&para;</a></h2> <p>RPC（Remote Procedure Call）远程过程调用，是一种通过网络从远程计算机上请求服务，而不需要了解底层网络通信细节。RPC可以使用多种网络协议进行通信，如HTTP、TCP、UDP等，并且在TCP/IP网络四层模型中跨越了传输层和应用层，如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\download.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\download.png"></a></p> <h2 id=_2>功能介绍<a class=headerlink href=#_2 title="Permanent link">&para;</a></h2> <p>在本次实现的项目中，首先就是要保证RPC本身的功能：本地调用远程方法。换句话说，客户端并不需要自己去实现某一个具体方法，而是通过调用服务端的方法来得到需要的结果，这个过程中也可以涉及到参数的传递，如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\download1.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\download1.png"></a></p> <p>虽然上面的过程已经基本实现了RPC的功能，但是还需要考虑一些其他的问题，例如：</p> <ol> <li>客户端如何确定有哪些服务器可以提供当前需要的服务</li> <li>客户端已经知道有一些服务器可以提供当前需要的服务，但是这些服务器可能已经下线了，此时客户端如何确定哪些服务器已经下线，哪些服务器还可以提供当前需要的服务</li> </ol> <p>针对上面的两个问题，在本次项目中会考虑下面的解决方案：</p> <ol> <li>针对第一个问题：提供一个服务发现客户端和服务注册中心，当客户端连接到服务注册中心时，需要向服务注册中心发送针对指定服务的服务发现请求，服务注册中心会返回当前有哪些服务器可以提供当前客户端需要的服务</li> <li>针对第二个问题：提供一个注册中心，当有一个服务器<strong>第一次上线</strong>时需要向注册中心发起注册请求，而在整个服务过程中，有可能存在某一个可以提供客户端需要的服务的服务端上线了，对于这个过程来说，只有注册功能还不足，还需要提供一个服务上线通知的功能，一旦某一个需要的服务对应的服务端上线，就可以通知发现过对应服务的发现者，同样如果是下线，也是同样的步骤</li> </ol> <p>这样就实现了一个<a href=javascript:; class=custom-tooltip data-title=简单理解就是由多个节点组成的⼀个系统，这些节点通常指的是服务器，将不同的业务或者同⼀个业务拆分分布在不同的节点上，通过协同⼯作解决⾼并发的问题，提高系统扩展性和可用性>分布式架构的RPC</a>。另外，基于这个服务器也可以实现负载均衡的功能，例如当一台服务器压力过大时可以将请求转发给其他拥有相同服务的服务器来处理，如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\Snipaste_2025-04-24_14-52-07.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\Snipaste_2025-04-24_14-52-07.png"></a></p> <p>在上图中可以看到，当客户端需要请求某一个服务时，首先需要先请求服务注册中心，而不是直接请求提供服务的服务，接着服务注册中心会告诉客户端有哪些服务器可以提供客户端需要的服务，客户端收到可以提供服务的服务器IP地址和端口号之后就可以请求对应的服务器来处理请求</p> <p>除了上面的RPC功能外，本次项目中还考虑实现一个发布订阅的功能，简单来说就是允许客户端向服务端发送一个内容，服务端再将内容发布给其他客户端。从这个功能可以看出，客户端发送给服务端的内容需要被服务端保存，如果直接将客户端的内容存储到服务端，那么就会存在一台服务器上有各种各样的内容，查找起来也会非常麻烦，所以可以考虑设计一个主题（topic）功能，在这个功能中客户端并不被允许直接发送消息，而必须是<strong>先创建一个主题，再向该主题发送消息</strong>，而为了实现服务端将内容发布给客户端，本次还提供了主题订阅功能，只有订阅了同一个服务的客户端才能收到对应发布的消息。整体功能如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\Snipaste_2025-04-24_15-10-46.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\Snipaste_2025-04-24_15-10-46.png"></a></p> <p>基于上面的功能，现在将上面的功能进行合并，如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\Snipaste_2025-04-24_15-12-33.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\Snipaste_2025-04-24_15-12-33.png"></a></p> <p>综上所述，本次项目需要实现的功能如下：</p> <ol> <li>基本RPC功能</li> <li>服务的注册与发现以及服务的下线/上线通知</li> <li>主题功能（包括创建、删除、订阅、取消订阅和主题消息发布）</li> </ol> <h2 id=_3>基础模块<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <h3 id=_4>模块总览<a class=headerlink href=#_4 title="Permanent link">&para;</a></h3> <ol> <li>网络服务模块（Network）：基于Muduo库实现底层网络服务器来处理客户端的请求</li> <li>应用层协议模块（Protocol）：因为TCP传输是面向字节流的，所以在大量的网络通信时必然会存在粘包问题，但是TCP本身无法解决这个问题，因为尽管是粘包，它也是一个数据，在TCP看来都属于有效载荷，但是这个数据是否是否是有效数据需要应用层来进行判断，所以就需要这个协议模块来处理这个问题。这一点在<a href=https://www.help-doc.top/Linux/serialization-net-cal/serialization-net-cal.html#_5>序列化和反序列化与网络计算器</a>部分也有所提及</li> <li>消息分发模块（Dispatcher）：这个模块是用来针对不同的请求/响应类型调用不同的模块来处理任务</li> <li>日志模块（Log）：用于整个项目中的日志记录</li> </ol> <h3 id=_5>网络服务模块<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <p>基于Muduo库设计，，对于Muduo库的介绍和使用可以参考<a href=https://www.help-doc.top/other/muduo/muduo.html#muduo>关于Muduo库</a>，关于Muduo库具体的设计原理，可以参考<a href=https://www.help-doc.top/reactor-server/intro/intro.html>仿Muduo库高并发服务器</a></p> <h3 id=_6>应用层协议模块<a class=headerlink href=#_6 title="Permanent link">&para;</a></h3> <p>在协议设计中，常见有三种协议设计方案：</p> <ol> <li>通过特殊字符分割不同的数据：这个方案最大的缺点就在于特殊字符可能存在于消息中，这就需要对数据中的特殊字符进行转义，这个过程相对复杂，本次不考虑</li> <li>通过固定长度限制每一条消息的最大大小：这个方案最大的缺点就在于消息的长度是固定的，这就导致如果消息比较短的话就会浪费空间，本次不考虑</li> <li>采用<code>Length-Value</code>协议：通过长度字段来标记每一条消息的长度，这个方案的优点就在于可以灵活的控制消息的长度，本次采用这个方案</li> </ol> <p>根据<code>Length-Value</code>协议的设计思想，本次设计的协议如下：</p> <ol> <li>有效数据的总长度（TotalLength）：大小为4字节，用于表示包括后续内容的长度，根据这个长度可以做到多个不同请求之间的拆分</li> <li>请求类型（RequestType）：大小为4字节，用于表示当前请求的类型，例如：RPC请求、服务注册请求、发布订阅请求</li> <li>请求/响应ID长度（IDLength）：大小为4字节，用于表示消息ID的长度</li> <li>请求/响应ID（ReqRespID）：大小为IDLength字节，用于表示消息的ID，这个ID用于标记一类请求和应答，因为客户端不会在收到上一条请求的应答之后才发送下一次请求，而是可能多次发送多个请求，而对于服务器来说，当其处理完毕返回给客户端应答时，客户端就需要知道这个应答是属于哪一个请求的。根据这个需求，这个ID必须是唯一的，所以本次采用<code>UUID</code>来作为消息ID，而<code>UUID</code>一般是一个字符串。即使是字符串，哪怕是固定的，为了保证之后的扩展性，依旧将其设计为可变长度，描述长度的字段就是IDLength</li> <li>有效数据（Body）：大小为总长度减去其他字段的长度，用于表示具体的请求或者响应内容</li> </ol> <p>整个协议的设计如下图所示：</p> <p><a class=glightbox href="1. 项目介绍与准备.assets\Snipaste_2025-04-24_16-35-01.png" data-type=image data-width=100% data-height=auto data-desc-position=bottom><img src="1. 项目介绍与准备.assets\Snipaste_2025-04-24_16-35-01.png"></a></p> <h3 id=_7>消息分发模块<a class=headerlink href=#_7 title="Permanent link">&para;</a></h3> <p>在本次项目中，消息分发模块基本设计思路为：根据消息类型注册对应的回调函数，当接收到客户端或者服务端发送的数据时，根据消息类型调用对应的回调函数来处理请求。所以在这个模块中需要有一个哈希表来建立不同的消息类型和不同的回调函数之间的映射关系，而对应的还需要两个函数表示注册和调用回调函数，既<code>registerService</code>和<code>executeService</code></p> <h2 id=_8>服务端模块介绍<a class=headerlink href=#_8 title="Permanent link">&para;</a></h2> <h3 id=_9>模块总览<a class=headerlink href=#_9 title="Permanent link">&para;</a></h3> <p>本次实现的项目中服务端主要分为下面几个模块：</p> <ol> <li>RPC功能模块（RpcRouter）：这个模块用来实现RPC的基本功能</li> <li>服务注册模块（RpcRegistry）：这个模块用来实现服务注册与发布、上线与下线通知的功能</li> <li>主题操作模块（RpcTopic）：这个模块用来实现主题操作功能的，其中主题操作包括：创建主题、删除主题、取消主题、跟随主题和主题消息发布的功能</li> <li>服务器模块（MainServer）：这个模块用来封装上面提到的所有功能模块对应的服务器，简化上层创建服务器的过程</li> </ol> <h3 id=rpc_1>RPC功能模块<a class=headerlink href=#rpc_1 title="Permanent link">&para;</a></h3> <p>在RPC模块中，主要就是针对客户端发送的RPC服务请求做出RPC服务的响应，但是这个过程中涉及一些问题</p> <p>首先是客户端和服务端都必须确保可以识别到彼此发送的信息，这就涉及到协议的定制，在上面的应用层协议模块中已经设计好了通用格式，但是对于RPC功能来说，还需要额外的字段来描述具体的服务，即在应用层协议的正文字段中还需要进行协议设计。设计思路如下：</p> <ol> <li>客户端发送的请求：包含服务名称和服务参数</li> <li>服务端返回的响应：包含服务执行结果（只在执行结果状态码为正常时存在）和执行结果的状态码</li> </ol> <p>根据上面的设计，用JSON字符串表示如下：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1><span class=c1>// RPC-request</span>
</span><span id=__span-0-2><span class=p>{</span>
</span><span id=__span-0-3><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Add&quot;</span><span class=p>,</span>
</span><span id=__span-0-4><span class=w>    </span><span class=nt>&quot;parameters&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span>
</span><span id=__span-0-5><span class=w>    </span><span class=p>{</span><span class=w> </span>
</span><span id=__span-0-6><span class=w>        </span><span class=nt>&quot;num1&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>11</span><span class=p>,</span><span class=w> </span>
</span><span id=__span-0-7><span class=w>        </span><span class=nt>&quot;num2&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>22</span><span class=w> </span>
</span><span id=__span-0-8><span class=w>    </span><span class=p>}</span>
</span><span id=__span-0-9><span class=p>}</span>
</span><span id=__span-0-10>
</span><span id=__span-0-11><span class=c1>// RPC-response</span>
</span><span id=__span-0-12><span class=p>{</span>
</span><span id=__span-0-13><span class=w>    </span><span class=nt>&quot;rcode&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>OK</span><span class=p>,</span>
</span><span id=__span-0-14><span class=w>    </span><span class=nt>&quot;result&quot;</span><span class=p>:</span><span class=w> </span><span class=mi>33</span>
</span><span id=__span-0-15><span class=p>}</span>
</span><span id=__span-0-16><span class=p>{</span>
</span><span id=__span-0-17><span class=w>    </span><span class=nt>&quot;rcode&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=err>ERROR_INVALID_PARAMETERS</span>
</span><span id=__span-0-18><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>有了协议的设计之后，服务端就需要考虑对客户端发送的请求进行解析和判断，确保客户端发送的请求体是合法的，一旦判断客户端请求的服务是合法的，就可以调用上层设置的处理回调函数进行请求处理并根据处理结果返回给客户端响应</p> <h3 id=_10>服务注册模块<a class=headerlink href=#_10 title="Permanent link">&para;</a></h3> <p>首先需要明白，当前是服务端模块，所以当前的服务模块就是设计注册中心，根据前面对注册中心的描述，注册中心需要提供下面的功能：</p> <ol> <li>服务注册：当一个服务启动时，需要向当前注册中心注册，确保该服务提供者可以被记录</li> <li>服务发现：在服务注册完毕后，需要告诉客户端当前有哪些服务可以提供，即通知服务发现者</li> <li>服务上线：当有一个新的服务端上线时，一旦注册到注册中心，就需要通知已经发现过当前服务器可以提供的服务对应的客户端</li> <li>服务下线：当一个服务端下线时，注册中心需要通知已经发现过当前服务器可以提供的服务对应的客户端</li> </ol> <p>根据上面的功能描述，下面就需要考虑如何设计客户端的请求协议格式和服务端的响应协议格式：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-1-1><span class=c1>// 服务提供者注册请求</span>
</span><span id=__span-1-2><span class=p>{</span>
</span><span id=__span-1-3><span class=w>    </span><span class=c1>// 服务类型</span>
</span><span id=__span-1-4><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_register&quot;</span><span class=p>,</span>
</span><span id=__span-1-5><span class=w>    </span><span class=c1>// 服务名称</span>
</span><span id=__span-1-6><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;add&quot;</span><span class=p>,</span>
</span><span id=__span-1-7><span class=w>    </span><span class=c1>// 服务提供者信息</span>
</span><span id=__span-1-8><span class=w>    </span><span class=nt>&quot;provider_info&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-9><span class=w>        </span><span class=c1>// 服务器IP地址</span>
</span><span id=__span-1-10><span class=w>        </span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-1-11><span class=w>        </span><span class=c1>// 服务器端口号</span>
</span><span id=__span-1-12><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>8000</span><span class=p>,</span>
</span><span id=__span-1-13><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-14><span class=p>}</span>
</span><span id=__span-1-15><span class=c1>// 服务提供者注册响应</span>
</span><span id=__span-1-16><span class=p>{</span>
</span><span id=__span-1-17><span class=w>    </span><span class=nt>&quot;rcode&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;RCode_fine&quot;</span>
</span><span id=__span-1-18><span class=p>}</span>
</span><span id=__span-1-19><span class=c1>// 发现者客户端发起服务发现请求</span>
</span><span id=__span-1-20><span class=p>{</span>
</span><span id=__span-1-21><span class=w>    </span><span class=c1>// 服务类型</span>
</span><span id=__span-1-22><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_discover&quot;</span><span class=p>,</span>
</span><span id=__span-1-23><span class=w>    </span><span class=c1>// 服务名称</span>
</span><span id=__span-1-24><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;add&quot;</span><span class=p>,</span>
</span><span id=__span-1-25><span class=p>}</span>
</span><span id=__span-1-26><span class=c1>// 注册中心返回服务发现响应</span>
</span><span id=__span-1-27><span class=p>{</span>
</span><span id=__span-1-28><span class=w>    </span><span class=c1>// 服务类型</span>
</span><span id=__span-1-29><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_discover&quot;</span><span class=p>,</span>
</span><span id=__span-1-30><span class=w>    </span><span class=c1>// 服务名称</span>
</span><span id=__span-1-31><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;add&quot;</span><span class=p>,</span>
</span><span id=__span-1-32><span class=w>    </span><span class=c1>// 服务提供者信息</span>
</span><span id=__span-1-33><span class=w>    </span><span class=nt>&quot;provider_info&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-1-34><span class=w>        </span><span class=p>{</span>
</span><span id=__span-1-35><span class=w>            </span><span class=c1>// 服务器IP地址</span>
</span><span id=__span-1-36><span class=w>            </span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-1-37><span class=w>            </span><span class=c1>// 服务器端口号</span>
</span><span id=__span-1-38><span class=w>            </span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>8000</span><span class=p>,</span>
</span><span id=__span-1-39><span class=w>        </span><span class=p>},</span>
</span><span id=__span-1-40><span class=w>        </span><span class=p>{</span>
</span><span id=__span-1-41><span class=w>            </span><span class=c1>// 服务器IP地址</span>
</span><span id=__span-1-42><span class=w>            </span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-1-43><span class=w>            </span><span class=c1>// 服务器端口号</span>
</span><span id=__span-1-44><span class=w>            </span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>7000</span><span class=p>,</span>
</span><span id=__span-1-45><span class=w>        </span><span class=p>}</span>
</span><span id=__span-1-46><span class=w>    </span><span class=p>]</span>
</span><span id=__span-1-47><span class=p>}</span>
</span><span id=__span-1-48><span class=c1>// 服务上线请求</span>
</span><span id=__span-1-49><span class=p>{</span>
</span><span id=__span-1-50><span class=w>    </span><span class=c1>// 服务类型</span>
</span><span id=__span-1-51><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_online&quot;</span><span class=p>,</span>
</span><span id=__span-1-52><span class=w>    </span><span class=c1>// 服务名称</span>
</span><span id=__span-1-53><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;add&quot;</span><span class=p>,</span>
</span><span id=__span-1-54><span class=w>    </span><span class=c1>// 服务提供者信息</span>
</span><span id=__span-1-55><span class=w>    </span><span class=nt>&quot;provider_info&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-56><span class=w>        </span><span class=c1>// 服务器IP地址</span>
</span><span id=__span-1-57><span class=w>        </span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-1-58><span class=w>        </span><span class=c1>// 服务器端口号</span>
</span><span id=__span-1-59><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>8000</span><span class=p>,</span>
</span><span id=__span-1-60><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-61><span class=p>}</span>
</span><span id=__span-1-62><span class=c1>// 服务下线请求</span>
</span><span id=__span-1-63><span class=p>{</span>
</span><span id=__span-1-64><span class=w>    </span><span class=c1>// 服务类型</span>
</span><span id=__span-1-65><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_offline&quot;</span><span class=p>,</span>
</span><span id=__span-1-66><span class=w>    </span><span class=c1>// 服务名称</span>
</span><span id=__span-1-67><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;add&quot;</span><span class=p>,</span>
</span><span id=__span-1-68><span class=w>    </span><span class=c1>// 服务提供者信息</span>
</span><span id=__span-1-69><span class=w>    </span><span class=nt>&quot;provider_info&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-1-70><span class=w>        </span><span class=c1>// 服务器IP地址</span>
</span><span id=__span-1-71><span class=w>        </span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span>
</span><span id=__span-1-72><span class=w>        </span><span class=c1>// 服务器端口号</span>
</span><span id=__span-1-73><span class=w>        </span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>8000</span><span class=p>,</span>
</span><span id=__span-1-74><span class=w>    </span><span class=p>}</span>
</span><span id=__span-1-75><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>当一个服务器向注册中心注册时，此时就相当于服务提供者向注册中心发送数据，所以可以看做是一个请求，而对应的字段<code>sevice_type</code>就填写<code>Service_register</code>。除了有请求以外，还存在对应的响应，这个响应相对比较简单，只需要表示当前的操作是否成功，即：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-2-1><span class=p>{</span>
</span><span id=__span-2-2><span class=w>    </span><span class=nt>&quot;rcode&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;OK&quot;</span>
</span><span id=__span-2-3><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>而对于服务发现，客户端给注册中心发送服务发现请求，对应地注册中心返回给客户端针对指定的服务返回可以提供该服务的所有服务提供者主机信息，在该响应中，需要描述的内容就是服务和所有可以提供该服务的服务提供者信息，即：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-3-1><span class=p>{</span>
</span><span id=__span-3-2><span class=w>    </span><span class=nt>&quot;sevice_type&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Service_discover&quot;</span><span class=p>,</span>
</span><span id=__span-3-3><span class=w>    </span><span class=nt>&quot;method&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Add&quot;</span><span class=p>,</span>
</span><span id=__span-3-4><span class=w>    </span><span class=nt>&quot;providers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
</span><span id=__span-3-5><span class=w>        </span><span class=p>{</span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.1&quot;</span><span class=p>,</span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>9090</span><span class=p>},</span>
</span><span id=__span-3-6><span class=w>        </span><span class=p>{</span><span class=nt>&quot;ip&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;127.0.0.2&quot;</span><span class=p>,</span><span class=nt>&quot;port&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=mi>8080</span><span class=p>}</span>
</span><span id=__span-3-7><span class=w>    </span><span class=p>]</span>
</span><span id=__span-3-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>对于服务的上线和下线，请求和响应的设计与服务注册类似，只不过请求和响应的<code>sevice_type</code>字段分别为<code>Service_online</code>和<code>Service_offline</code>，而服务的上线和下线本质也是服务提供者客户端向注册中心发送数据，所以可以看做是一个请求</p> <p>总结来说，服务处理模块实际上就是一个处理服务操作请求的一个模块</p> <h3 id=_11>主题操作模块<a class=headerlink href=#_11 title="Permanent link">&para;</a></h3> <p>根据前面对主题操作的介绍，一共涉及到5个操作，针对这5个操作给出相应的描述字段：</p> <ol> <li>创建主题：<code>Topic_create</code></li> <li>删除主题：<code>Topic_remove</code></li> <li>取消主题：<code>Topic_subscribe</code></li> <li>跟随主题：<code>Topic_cancel</code></li> <li>主题消息发布：<code>Topic_publish</code></li> </ol> <p>而客户端发送的请求和服务器返回的响应都需要包含主题名称，所以可以将主题名称作为消息的一部分，这样就可以在消息的分发过程中根据消息的类型来判断当前的消息是属于哪一种类型，然后调用对应的函数来处理</p> <p>对于前四种，执行逻辑是类似的，而第五个操作需要将消息分发给所有订阅了指定主题的客户端，所以还需要考虑转发的功能。在四种之中，因为都需要指定主题，所以客户端除了指定哪一种操作类型外，还需要指定操作的主题，这里就需要两个字段描述：<code>topic</code>和<code>topic_op</code>，而如果<code>topic_op</code>为<code>TopicPublish</code>，那么还需要指定消息的内容，所以客户端发送的请求和服务器返回的响应都需要包含这三个字段，具体的请求和响应如下：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span>
<span class=normal>8</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-4-1><span class=c1>// 客户端发送的请求</span>
</span><span id=__span-4-2><span class=c1>// TopicRequest</span>
</span><span id=__span-4-3><span class=p>{</span>
</span><span id=__span-4-4><span class=w>    </span><span class=nt>&quot;topic&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;test&quot;</span><span class=p>,</span>
</span><span id=__span-4-5><span class=w>    </span><span class=nt>&quot;topic_op&quot;</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=s2>&quot;Topic_create&quot;</span><span class=err>/</span><span class=s2>&quot;Topic_remove&quot;</span><span class=err>/</span><span class=s2>&quot;Topic_cancel&quot;</span><span class=err>/</span><span class=s2>&quot;Topic_subscribe&quot;</span><span class=err>/</span><span class=s2>&quot;Topic_publish&quot;</span><span class=p>,</span>
</span><span id=__span-4-6><span class=w>    </span><span class=c1>// 下面的内容只有当topic_op为TopicPublish时才需要</span>
</span><span id=__span-4-7><span class=w>    </span><span class=nt>&quot;message&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;hello world&quot;</span>
</span><span id=__span-4-8><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <p>而主题操作部分不需要给客户端返回具体的执行结果，所以服务端只需要返回对应的执行状态即可，所以主题操作部分的响应如下：</p> <div class="language-json highlight"><table class=highlighttable><tr><th colspan=2 class=filename><span class=filename>JSON</span></th></tr><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-5-1><span class=c1>// 服务器返回的响应</span>
</span><span id=__span-5-2><span class=c1>// TopicResponse</span>
</span><span id=__span-5-3><span class=p>{</span>
</span><span id=__span-5-4><span class=w>    </span><span class=nt>&quot;rcode&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;OK&quot;</span>
</span><span id=__span-5-5><span class=p>}</span>
</span></code></pre></div></td></tr></table></div> <h3 id=_12>服务器模块<a class=headerlink href=#_12 title="Permanent link">&para;</a></h3> <p>根据每个功能模块，进行服务器封装</p> <h2 id=_13>客户端模块介绍<a class=headerlink href=#_13 title="Permanent link">&para;</a></h2> <h3 id=_14>模块总览<a class=headerlink href=#_14 title="Permanent link">&para;</a></h3> <p>客户端主要就是处理服务端发送给客户端的请求，根据上面服务端可以提供的功能，客户端可以分为下面几个模块：</p> <ol> <li>请求管理模块（Requestor）：这个模块用来封装请求接口，并正确处理收到的响应</li> <li>RPC功能模块（RpcCaller）：向服务端提供发起RPC请求</li> <li>服务注册模块（RpcRegistry）：向服务端发起服务注册和服务发现请求</li> <li>主题操作模块（RpcTopic）：向服务端发送主题操作请求并判断响应结果</li> <li>客户端模块（MainClient）：根据上面的功能模块进行客户端封装</li> </ol> <h3 id=_15>请求管理模块<a class=headerlink href=#_15 title="Permanent link">&para;</a></h3> <p>在前面应用层协议模块中提到一个字段：请求/响应ID，这个ID的作用是区分不同的请求，确保客户端可以正确地知道哪一个响应对应着哪一个请求，而为了处理这个问题，就存在Requestor模块，这个模块的作用就是封装请求发送接口，并且收到响应时判断响应ID是否匹配于某一个请求ID，如果存在说明存在对应的请求，接着调用需要的处理函数处理响应</p> <h3 id=rpc_2>RPC功能模块<a class=headerlink href=#rpc_2 title="Permanent link">&para;</a></h3> <p>实现发起RPC请求的接口</p> <h3 id=_16>服务注册模块<a class=headerlink href=#_16 title="Permanent link">&para;</a></h3> <p>这个模块不仅仅包含服务发现者客户端，还包含服务提供者客户端。实际上服务提供者既存在一个服务端，还存在一个客户端，这个客户端就是服务提供者客户端，该客户端会向注册中心发送服务注册请求并获取到对应的响应判断注册结果是否正常，对应地，服务发现客户端就需要发起服务发现请求，并处理服务发现响应，即保存所有可以提供需要的服务的主机信息</p> <h3 id=_17>主题操作模块<a class=headerlink href=#_17 title="Permanent link">&para;</a></h3> <p>客户端部分的主题操作模块主要的工作就是向上层提供主题操作的接口，包括：</p> <ol> <li>创建主题</li> <li>删除主题</li> <li>取消主题</li> <li>跟随主题</li> <li>主题消息发布</li> </ol> <p>但是，除了提供主题操作的接口以外，还需要考虑主题消息发布的另外一个功能：处理收到的消息。因为创建、删除、取消、跟随都是客户端主动向服务端发送的请求，但是主题消息发布中收到主题是被动收到请求，所以客户端需要处理服务端发送给自己的消息，这就需要客户端调用指定的回调函数来处理</p> <h3 id=_18>客户端模块<a class=headerlink href=#_18 title="Permanent link">&para;</a></h3> <p>根据上面的功能模块，进行客户端封装</p> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title=最后更新> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">2025年7月30日</span> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> 页面有帮助吗？ </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title=页面对我有帮助 data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title=页面没有帮助到我 data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> 谢谢你的反馈！ </div> <div data-md-value=0 hidden> 谢谢你的反馈！联系<a href=https://www.help-doc.top/author/contact/contact.html>作者</a>提供更详细的信息 </div> </div> </div> </fieldset> </form> <!-- Waline 评论系统 --> <div id=waline></div> <!-- 阅读进度条 - 直接在HTML中定义 --> <div class=reading-progress></div> <!-- 滚动指示器 - 直接在HTML中定义 --> <div class=scroll-indicator></div> <!-- 评论系统 --> <!-- Waline 评论系统 --> <div id=waline></div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
--> <!-- Footer --> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2024-2025 柯懒不是柯南 </div> </div> <div class="md-footer-love md-typeset"> 一闪一闪亮晶晶，不及<span class=love-highlight>小亮</span><span class=love-heart>♥</span>照我心。To Li Liang </div> <div class=md-social> <a href=https://github.com/H0308 target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://www.help-doc.top/author/contact/contact.html target=_blank rel=noopener title=www.help-doc.top class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.indexes", "navigation.prune", "navigation.tabs", "search.highlight", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.c8b220af.min.js></script> <script src=../../../javascripts/katex.min.js></script> <script src=../../../javascripts/other.min.js></script> <script src=../../../javascripts/copyright.min.js></script> <script src=../../../javascripts/waline.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js></script> <script src=https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js></script> <script src=https://cdn.jsdelivr.net/npm/mermaid@11.5.0/dist/mermaid.min.js></script> <script src=../../../assets/javascripts/toggle-sidebar.js async></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>